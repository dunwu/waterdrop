---
icon: logos:mysql
title: MySQL é¢è¯•ä¹‹ç´¢å¼•ç¯‡
cover: https://raw.githubusercontent.com/dunwu/images/master/snap/202503110803916.jpg
date: 2025-03-24 22:42:57
categories:
  - æ•°æ®åº“
  - å…³ç³»å‹æ•°æ®åº“
  - MySQL
tags:
  - æ•°æ®åº“
  - å…³ç³»å‹æ•°æ®åº“
  - MySQL
  - é¢è¯•
permalink: /pages/c3b86217/
---

# MySQL é¢è¯•ä¹‹ç´¢å¼•ç¯‡

## ç»¼åˆ

### ã€ç®€å•ã€‘ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Ÿä¸ºä»€ä¹ˆè¦ä½¿ç”¨ç´¢å¼•ï¼Ÿ

**â€œç´¢å¼•â€æ˜¯æ•°æ®åº“ä¸ºäº†æé«˜æŸ¥æ‰¾æ•ˆç‡çš„ä¸€ç§æ•°æ®ç»“æ„**ã€‚

æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ£€ç´¢ç›®å½•ï¼Œæ¥å¿«é€Ÿå®šä½ä¹¦æœ¬ä¸­çš„å†…å®¹ã€‚ç´¢å¼•å’Œæ•°æ®è¡¨ï¼Œå°±å¥½æ¯”ç›®å½•å’Œä¹¦ï¼Œæƒ³è¦é«˜æ•ˆæŸ¥è¯¢æ•°æ®è¡¨ï¼Œç´¢å¼•è‡³å…³é‡è¦ã€‚åœ¨æ•°æ®é‡å°ä¸”è´Ÿè½½è¾ƒä½æ—¶ï¼Œä¸æ°å½“çš„ç´¢å¼•å¯¹äºæ€§èƒ½çš„å½±å“å¯èƒ½è¿˜ä¸æ˜æ˜¾ï¼›ä½†éšç€æ•°æ®é‡é€æ¸å¢å¤§ï¼Œæ€§èƒ½åˆ™ä¼šæ€¥å‰§ä¸‹é™ã€‚å› æ­¤ï¼Œ**è®¾ç½®åˆç†çš„ç´¢å¼•æ˜¯æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–çš„æœ€æœ‰æ•ˆæ‰‹æ®µ**ã€‚

### ã€ç®€å•ã€‘ç´¢å¼•çš„ä¼˜ç‚¹å’Œç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ

âœ…ï¸ï¸ï¸ï¸ï¸ï¸ï¸ ç´¢å¼•çš„ä¼˜ç‚¹ï¼š

- **ç´¢å¼•å¤§å¤§å‡å°‘äº†æœåŠ¡å™¨éœ€è¦æ‰«æçš„æ•°æ®é‡**ï¼Œä»è€ŒåŠ å¿«æ£€ç´¢é€Ÿåº¦ã€‚
- **ç´¢å¼•å¯ä»¥å¸®åŠ©æœåŠ¡å™¨é¿å…æ’åºå’Œä¸´æ—¶è¡¨**ã€‚
- **ç´¢å¼•å¯ä»¥å°†éšæœº I/O å˜ä¸ºé¡ºåº I/O**ã€‚
- æ”¯æŒè¡Œçº§é”çš„æ•°æ®åº“ï¼Œå¦‚ InnoDB ä¼šåœ¨è®¿é—®è¡Œçš„æ—¶å€™åŠ é”ã€‚**ä½¿ç”¨ç´¢å¼•å¯ä»¥å‡å°‘è®¿é—®çš„è¡Œæ•°ï¼Œä»è€Œå‡å°‘é”çš„ç«äº‰ï¼Œæé«˜å¹¶å‘**ã€‚
- å”¯ä¸€ç´¢å¼•å¯ä»¥ç¡®ä¿æ¯ä¸€è¡Œæ•°æ®çš„å”¯ä¸€æ€§ï¼Œé€šè¿‡ä½¿ç”¨ç´¢å¼•ï¼Œå¯ä»¥åœ¨æŸ¥è¯¢çš„è¿‡ç¨‹ä¸­ä½¿ç”¨ä¼˜åŒ–éšè—å™¨ï¼Œæé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚

âŒ ç´¢å¼•çš„ç¼ºç‚¹ï¼š

- **åˆ›å»ºå’Œç»´æŠ¤ç´¢å¼•è¦è€—è´¹æ—¶é—´**ï¼Œè¿™ä¼šéšç€æ•°æ®é‡çš„å¢åŠ è€Œå¢åŠ ã€‚
- **ç´¢å¼•éœ€è¦å ç”¨é¢å¤–çš„ç‰©ç†ç©ºé—´**ï¼Œé™¤äº†æ•°æ®è¡¨å æ•°æ®ç©ºé—´ä¹‹å¤–ï¼Œæ¯ä¸€ä¸ªç´¢å¼•è¿˜è¦å ä¸€å®šçš„ç‰©ç†ç©ºé—´ï¼Œå¦‚æœè¦å»ºç«‹è”åˆç´¢å¼•é‚£ä¹ˆéœ€è¦çš„ç©ºé—´å°±ä¼šæ›´å¤§ã€‚
- **å†™æ“ä½œï¼ˆ`INSERT`/`UPDATE`/`DELETE`ï¼‰æ—¶å¾ˆå¯èƒ½éœ€è¦æ›´æ–°ç´¢å¼•ï¼Œå¯¼è‡´æ•°æ®åº“çš„å†™æ“ä½œæ€§èƒ½é™ä½**ã€‚

### ã€ä¸­ç­‰ã€‘ä½•æ—¶é€‚ç”¨ç´¢å¼•ï¼Ÿä½•æ—¶ä¸é€‚ç”¨ç´¢å¼•ï¼ŸğŸŒŸ

- **ç´¢å¼•ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œä¸è¦ä¸ºæ‰€æœ‰åˆ—éƒ½åˆ›å»ºç´¢å¼•**ã€‚è¦è€ƒè™‘åˆ°ç´¢å¼•çš„ç»´æŠ¤ä»£ä»·ã€ç©ºé—´å ç”¨å’ŒæŸ¥è¯¢æ—¶å›è¡¨çš„ä»£ä»·ã€‚ç´¢å¼•ä¸€å®šæ˜¯æŒ‰éœ€åˆ›å»ºçš„ï¼Œå¹¶ä¸”è¦å°½å¯èƒ½ç¡®ä¿è¶³å¤Ÿè½»é‡ã€‚ä¸€æ—¦åˆ›å»ºäº†å¤šå­—æ®µçš„è”åˆç´¢å¼•ï¼Œæˆ‘ä»¬è¦è€ƒè™‘å°½å¯èƒ½åˆ©ç”¨ç´¢å¼•æœ¬èº«å®Œæˆæ•°æ®æŸ¥è¯¢ï¼Œå‡å°‘å›è¡¨çš„æˆæœ¬ã€‚
- è¦**è€ƒè™‘åˆ é™¤æœªä½¿ç”¨çš„ç´¢å¼•**ã€‚
- **å°½é‡çš„æ‰©å±•ç´¢å¼•ï¼Œä¸è¦æ–°å»ºç´¢å¼•**ã€‚ç´¢å¼•éœ€è¦å ç”¨é¢å¤–çš„å­˜å‚¨ç©ºé—´ï¼›æ­¤å¤–ï¼Œè¡¨æ›´æ–°æ—¶ï¼Œéœ€è¦åŒæ­¥ç»´æŠ¤ç´¢å¼•ã€‚ç´¢å¼•è¶Šå¤šï¼Œæ„å‘³ç€ç»´æŠ¤æ‰€ä»˜å‡ºçš„æˆæœ¬è¶Šé«˜ï¼Œå› æ­¤ï¼Œåº”å°½é‡æ‰©å±•å·²æœ‰ç´¢å¼•ï¼Œè€Œä¸æ˜¯ä¸å‡æ€ç´¢çš„æ–°å»ºç´¢å¼•ã€‚

> âœ…ï¸ï¸ï¸ï¸ ä»€ä¹ˆæƒ…å†µ**é€‚ç”¨**ç´¢å¼•ï¼Ÿ

- **é«˜é¢‘æŸ¥è¯¢çš„å­—æ®µ**ï¼šé¢‘ç¹ä½œä¸º `WHERE` æ¡ä»¶æˆ– `JOIN` æ¡ä»¶çš„å­—æ®µï¼Œåº”è€ƒè™‘è®¾ä¸ºç´¢å¼•ã€‚
- **é¢‘ç¹ç”¨äº `ORDER BY`ã€`GROUP BY`ã€`DISTINCT` çš„åˆ—**ã€‚å°†è¯¥åˆ—ä½œä¸ºç´¢å¼•ï¼Œå¯ä»¥å¸®åŠ©åŠ å¿«è¿™äº›æ“ä½œã€‚

> âŒ ä»€ä¹ˆæƒ…å†µ**ä¸é€‚ç”¨**ç´¢å¼•ï¼Ÿ

- **éå¸¸å°çš„è¡¨**ï¼šå¯¹äºéå¸¸å°çš„è¡¨ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹ç®€å•çš„å…¨è¡¨æ‰«ææ›´é«˜æ•ˆã€‚
- **ç‰¹å¤§å‹çš„è¡¨**ï¼šå»ºç«‹å’Œä½¿ç”¨ç´¢å¼•çš„ä»£ä»·å°†éšä¹‹å¢é•¿ã€‚å¯ä»¥è€ƒè™‘ä½¿ç”¨åˆ†åŒºæŠ€æœ¯æˆ– Nosqlã€‚
- **é«˜é¢‘æ›´æ–°çš„è¡¨**ï¼šè¡¨æ›´æ–°æ—¶ï¼Œéœ€è¦åŒæ­¥ç»´æŠ¤ç´¢å¼•ï¼Œæœ‰é¢å¤–çš„å¼€é”€ï¼Œä¼šå½±å“æ€§èƒ½ã€‚
- **ä½é¢‘æŸ¥è¯¢çš„å­—æ®µ**ï¼šå¾ˆå°‘ä½œä¸º `WHERE` æ¡ä»¶æˆ– `JOIN` æ¡ä»¶çš„å­—æ®µï¼Œå»ºç«‹ç´¢å¼•è€Œå¸¦æ¥çš„ç©ºé—´å¼€é”€å’Œç»´æŠ¤æˆæœ¬å¯èƒ½è¶…è¿‡æŸ¥è¯¢æ€§èƒ½æå‡æ‰€å¸¦æ¥çš„æ”¶ç›Šã€‚
- **é«˜åº¦é‡å¤çš„å­—æ®µ**ï¼šè‹¥ç´¢å¼•å­—æ®µçš„é‡å¤åº¦é«˜ï¼Œæ„å‘³ç€é€‰æ‹©æ€§ä½ï¼ˆå¦‚æ€§åˆ«å­—æ®µåªæœ‰ç”·å’Œå¥³ï¼‰ï¼Œç´¢å¼•çš„æ•ˆæœä¸æ˜æ˜¾ï¼Œä¸”ä¼šå¢åŠ é¢å¤–çš„å­˜å‚¨ç©ºé—´ã€‚
- **é•¿æ–‡æœ¬çš„å­—æ®µ**ï¼šå¦‚ TEXTã€BLOB æˆ–éå¸¸é•¿çš„ VARCHAR ç±»å‹ï¼Œå­—æ®µå¸¸åŒ…å«å¤§é‡æ•°æ®ã€‚
  - æ•°æ®é‡å¤§æ—¶ï¼Œæ— æ³•ç”¨å†…å­˜æ’åºï¼Œåªèƒ½åˆ©ç”¨ç£ç›˜æ–‡ä»¶æ’åºï¼Œé€Ÿåº¦å¾ˆæ…¢ã€‚
  - æ•°æ®é¡µé»˜è®¤ 16KBï¼Œå­˜å‚¨æ•°æ®æœ‰é™ï¼Œè¶…å‡ºèŒƒå›´ï¼Œéœ€è¦æ‰«æå¤šæ¬¡ I/Oã€‚
  - è¿™ç§ç±»å‹çš„æ•°æ®å¦‚æœæœ‰æŸ¥è¯¢éœ€æ±‚ï¼Œåº”è€ƒè™‘ä½¿ç”¨ ES æ¥è¿›è¡Œå…¨æ–‡æ£€ç´¢ã€‚

### ã€ä¸­ç­‰ã€‘å“ªäº›æƒ…å†µä¸‹ï¼Œç´¢å¼•ä¼šå¤±æ•ˆï¼ŸğŸŒŸğŸŒŸğŸŒŸ

ç´¢å¼•ä¸ä¸€å®šæœ‰æ•ˆã€‚

æ£€æŸ¥ç´¢å¼•æ˜¯å¦æœ‰æ•ˆçš„æ–¹æ³•ï¼šåœ¨æŸ¥è¯¢è¯­å¥å‰åŠ  `EXPLAIN`ï¼ŒæŸ¥çœ‹æ‰§è¡Œè®¡åˆ’ã€‚ä¸»è¦è§‚å¯Ÿä»¥ä¸‹ä¿¡æ¯ï¼š

- `typeï¼ˆè®¿é—®ç±»å‹ï¼‰`ï¼šå¦‚æœç´¢å¼•æœ‰æ•ˆï¼Œä¸€èˆ¬ä¼šæ˜¾ç¤ºä¸º `index`ã€`range`ï¼›å¦‚æœå€¼ä¸º ALLï¼Œè¡¨ç¤ºé‡‡ç”¨å…¨è¡¨æ‰«ææ–¹å¼ï¼Œæ²¡æœ‰ä½¿ç”¨ç´¢å¼•ã€‚
- `keyï¼ˆé€‰æ‹©çš„ç´¢å¼•ï¼‰`ï¼šè¡¨ç¤ºæŸ¥è¯¢æ—¶ä½¿ç”¨çš„ç´¢å¼•ã€‚

å¯¼è‡´ç´¢å¼•å¤±æ•ˆçš„æƒ…å†µæœ‰ï¼š

- **è¿åæœ€å·¦å‰ç¼€åŸåˆ™**
  - âŒè·³è¿‡äº†æœ€å·¦åˆ—ï¼ˆå¦‚ç´¢å¼• `(a,b,c)`ï¼Œä½†æŸ¥è¯¢ `WHERE b=1`ï¼‰
  - âŒä¸­é—´åˆ—è¢«è·³è¿‡ï¼ˆå¦‚ `WHERE a=1 AND c=3`ï¼Œ`c` æ— æ³•ä½¿ç”¨ç´¢å¼•ï¼‰
- **å¯¹ç´¢å¼•ä½¿ç”¨å‡½æ•°æˆ–è®¡ç®—**
  - âŒ `WHERE YEAR(date_column) = 2023`
  - âŒ `WHERE column * 2 = 10`
  - âŒ `WHERE SUBSTRING(name, 1, 3) = 'Tom'`
- **æ•°æ®ç±»å‹ä¸åŒ¹é…ï¼ˆéšå¼ç±»å‹è½¬æ¢ï¼‰**
  - âŒ `WHERE string_column = 123`ï¼ˆå­—ç¬¦ä¸²åˆ—ç”¨æ•°å­—æ¯”è¾ƒï¼‰
  - âŒ `WHERE int_column = '123'`ï¼ˆæ•°å­—åˆ—ç”¨å­—ç¬¦ä¸²æ¯”è¾ƒï¼‰
- **ä½¿ç”¨ `OR` è¿æ¥éç´¢å¼•åˆ—**
  - âŒ `WHERE a=1 OR b=2`ï¼ˆå¦‚æœ `b` æ— ç´¢å¼•ï¼Œå…¨è¡¨æ‰«æï¼‰
  - âœ… `WHERE a=1 OR a=2`ï¼ˆ`a` æœ‰ç´¢å¼•ï¼Œå¯ä»¥ä¼˜åŒ–ï¼‰
- **ä½¿ç”¨èŒƒå›´æŸ¥è¯¢ï¼ˆ>ã€<ã€BETWEENã€LIKEï¼‰åçš„åˆ—å¤±æ•ˆ**
  - âœ… `WHERE a=1 AND b=2`ï¼ˆ`a, b` éƒ½èƒ½ç”¨ç´¢å¼•ï¼‰
  - âŒ `WHERE a>1 AND b=2`ï¼ˆ`a` æ˜¯èŒƒå›´æŸ¥è¯¢ï¼Œ`b` æ— æ³•ç”¨ç´¢å¼•ï¼‰
  - âŒ `WHERE name LIKE '%abc'`ï¼ˆå‰å¯¼é€šé…ç¬¦ `%` å¯¼è‡´ç´¢å¼•å¤±æ•ˆï¼‰
- **ä½¿ç”¨ `!=`ã€`<>`ã€`NOT IN`ã€`IS NULL`ã€`IS NOT NULL`**
  - âŒ `WHERE status != 'active'`
  - âŒ `WHERE age NOT IN (18, 20)`
  - âŒ `WHERE phone IS NULL`

### ã€ç®€å•ã€‘ç´¢å¼•æœ‰å“ªäº›åˆ†ç±»ï¼ŸğŸŒŸ

MySQL ç´¢å¼•å¯ä»¥ä»ä»¥ä¸‹å››ä¸ªç»´åº¦æ¥åˆ†ç±»ï¼š

- æŒ‰ã€**æ•°æ®ç»“æ„**ã€‘åˆ†ç±»ï¼š**B+tree ç´¢å¼•ã€Hash ç´¢å¼•ã€Full-text ç´¢å¼•**
- æŒ‰ã€**ç‰©ç†å­˜å‚¨**ã€‘åˆ†ç±»ï¼š**èšç°‡ç´¢å¼•ã€äºŒçº§ç´¢å¼•ï¼ˆè¾…åŠ©ç´¢å¼•ï¼‰**
- æŒ‰ã€**å­—æ®µç‰¹æ€§**ã€‘åˆ†ç±»ï¼š**ä¸»é”®ç´¢å¼•ã€å”¯ä¸€ç´¢å¼• ã€æ™®é€šç´¢å¼•ã€å‰ç¼€ç´¢å¼•**
- æŒ‰ã€**å­—æ®µä¸ªæ•°**ã€‘åˆ†ç±»ï¼š**å•åˆ—ç´¢å¼•ã€è”åˆç´¢å¼•ï¼ˆå¤åˆç´¢å¼•ã€ç»„åˆç´¢å¼•ï¼‰**

### ã€ç®€å•ã€‘= å’Œ in çš„é¡ºåºå¯¹äºå‘½ä¸­ç´¢å¼•æ˜¯å¦æœ‰å½±å“ï¼ŸğŸŒŸ

**ä¸éœ€è¦è€ƒè™‘ `=`ã€`IN` ç­‰çš„é¡ºåº**ï¼ŒMySQL ä¼šè‡ªåŠ¨ä¼˜åŒ–è¿™äº›æ¡ä»¶çš„é¡ºåºï¼Œä»¥åŒ¹é…å°½å¯èƒ½å¤šçš„ç´¢å¼•åˆ—ã€‚

ã€ç¤ºä¾‹ã€‘å¦‚æœ‰ç´¢å¼• (a, b, c, d)ï¼ŒæŸ¥è¯¢æ¡ä»¶ `c > 3 and b = 2 and a = 1 and d < 4` ä¸ `a = 1 and c > 3 and b = 2 and d < 4` ç­‰é¡ºåºéƒ½æ˜¯å¯ä»¥çš„ï¼ŒMySQL ä¼šè‡ªåŠ¨ä¼˜åŒ–ä¸º a = 1 and b = 2 and c > 3 and d < 4ï¼Œä¾æ¬¡å‘½ä¸­ aã€bã€cã€dã€‚

## ç´¢å¼•æ•°æ®ç»“æ„

### ã€ç®€å•ã€‘ç´¢å¼•æœ‰å“ªäº›å¸¸è§æ•°æ®ç»“æ„ï¼Ÿ

åœ¨ MySQL ä¸­ï¼Œ**ç´¢å¼•æ˜¯åœ¨å­˜å‚¨å¼•æ“å±‚è€Œä¸æ˜¯æœåŠ¡å™¨å±‚å®ç°çš„**ï¼Œæ‰€ä»¥ï¼Œå¹¶æ²¡æœ‰ç»Ÿä¸€çš„ç´¢å¼•æ ‡å‡†ã€‚ä¸åŒå­˜å‚¨å¼•æ“çš„ç´¢å¼•çš„æ•°æ®ç»“æ„ä¹Ÿä¸ç›¸åŒã€‚ä¸‹é¢æ˜¯ MySQL å¸¸ç”¨å­˜å‚¨å¼•æ“å¯¹ä¸€äº›ä¸»è¦ç´¢å¼•æ•°æ®ç»“æ„çš„æ”¯æŒï¼š

| ç´¢å¼•æ•°æ®ç»“æ„/å­˜å‚¨å¼•æ“ | InnoDB å¼•æ“ | MyISAM å¼•æ“ | Memory å¼•æ“ |
| --------------------- | ----------- | ----------- | ----------- |
| **B+ æ ‘ç´¢å¼•**         | âœ…ï¸ï¸ï¸ï¸ï¸ï¸ï¸   | âœ…ï¸ï¸ï¸ï¸ï¸ï¸ï¸   | âœ…ï¸ï¸ï¸ï¸ï¸ï¸ï¸   |
| **Hash ç´¢å¼•**         | âŒ          | âŒ          | âœ…ï¸ï¸ï¸ï¸ï¸ï¸ï¸   |
| **Full Text ç´¢å¼•**    | âœ…ï¸ï¸ï¸ï¸ï¸ï¸ï¸   | âœ…ï¸ï¸ï¸ï¸ï¸ï¸ï¸   | âŒ          |

MySQL ç´¢å¼•çš„å¸¸è§æ•°æ®ç»“æ„ï¼š

- **å“ˆå¸Œç´¢å¼•**
  - å› ä¸ºç´¢å¼•æ•°æ®ç»“æ„ç´§å‡‘ï¼Œæ‰€ä»¥**æŸ¥è¯¢é€Ÿåº¦éå¸¸å¿«**ã€‚
  - **åªæ”¯æŒç­‰å€¼æ¯”è¾ƒæŸ¥è¯¢** - åŒ…æ‹¬ `=`ã€`IN()`ã€`<=>`ï¼›**ä¸æ”¯æŒä»»ä½•èŒƒå›´æŸ¥è¯¢**ï¼Œå¦‚ `WHERE price > 100`ã€‚
  - **æ— æ³•ç”¨äºæ’åº** - å› ä¸ºå“ˆå¸Œç´¢å¼•æ•°æ®ä¸æ˜¯æŒ‰ç…§ç´¢å¼•å€¼é¡ºåºå­˜å‚¨çš„ã€‚
  - **ä¸æ”¯æŒéƒ¨åˆ†ç´¢å¼•åŒ¹é…æŸ¥æ‰¾** - å› ä¸ºå“ˆå¸Œç´¢å¼•æ—¶ä½¿ç”¨ç´¢å¼•åˆ—çš„å…¨éƒ¨å†…å®¹æ¥è¿›è¡Œå“ˆå¸Œè®¡ç®—çš„ã€‚å¦‚ï¼Œåœ¨æ•°æ®åˆ— (A,B) ä¸Šå»ºç«‹å“ˆå¸Œç´¢å¼•ï¼Œå¦‚æœæŸ¥è¯¢åªæœ‰æ•°æ®åˆ— Aï¼Œæ— æ³•ä½¿ç”¨è¯¥ç´¢å¼•ã€‚
  - **ä¸èƒ½ç”¨ç´¢å¼•ä¸­çš„å€¼æ¥é¿å…è¯»å–è¡Œ** - å› ä¸ºå“ˆå¸Œç´¢å¼•åªåŒ…å«å“ˆå¸Œå€¼å’Œè¡ŒæŒ‡é’ˆï¼Œä¸å­˜å‚¨å­—æ®µï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨ç´¢å¼•ä¸­çš„å€¼æ¥é¿å…è¯»å–è¡Œã€‚ä¸è¿‡ï¼Œè®¿é—®å†…å­˜ä¸­çš„è¡Œçš„é€Ÿåº¦å¾ˆå¿«ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†æƒ…å†µä¸‹è¿™ä¸€ç‚¹å¯¹æ€§èƒ½å½±å“ä¸å¤§ã€‚
  - å“ˆå¸Œç´¢å¼•æœ‰**å¯èƒ½å‡ºç°å“ˆå¸Œå†²çª**
    - å‡ºç°å“ˆå¸Œå†²çªæ—¶ï¼Œå¿…é¡»éå†é“¾è¡¨ä¸­æ‰€æœ‰çš„è¡ŒæŒ‡é’ˆï¼Œé€è¡Œæ¯”è¾ƒï¼Œç›´åˆ°æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„è¡Œã€‚
    - å¦‚æœå“ˆå¸Œå†²çªå¤šçš„è¯ï¼Œç»´æŠ¤ç´¢å¼•çš„ä»£ä»·ä¼šå¾ˆé«˜ã€‚
- B æ ‘ç´¢å¼•
  - é€‚ç”¨äº**å…¨é”®å€¼æŸ¥æ‰¾**ã€**é”®å€¼èŒƒå›´æŸ¥æ‰¾**å’Œ**é”®å‰ç¼€æŸ¥æ‰¾**ï¼Œå…¶ä¸­é”®å‰ç¼€æŸ¥æ‰¾åªé€‚ç”¨äºæœ€å·¦å‰ç¼€æŸ¥æ‰¾ã€‚
  - æ‰€æœ‰çš„å…³é”®å­—ï¼ˆå¯ä»¥ç†è§£ä¸ºæ•°æ®ï¼‰éƒ½å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹ï¼Œéå¶å­èŠ‚ç‚¹å¹¶ä¸å­˜å‚¨çœŸæ­£çš„æ•°æ®ï¼Œæ‰€æœ‰è®°å½•èŠ‚ç‚¹éƒ½æ˜¯æŒ‰é”®å€¼å¤§å°é¡ºåºå­˜æ”¾åœ¨åŒä¸€å±‚å¶å­èŠ‚ç‚¹ä¸Šã€‚
  - æ‰€æœ‰çš„å¶å­èŠ‚ç‚¹ç”±æŒ‡é’ˆè¿æ¥ã€‚

### ã€ä¸­ç­‰ã€‘ä¸ºä»€ä¹ˆ InnoDB é‡‡ç”¨ B+ æ ‘ç´¢å¼•ï¼ŸğŸŒŸğŸŒŸ

InnoDB é€‰æ‹© B+ æ ‘ï¼Œæ˜¯å…¶åœ¨**ç£ç›˜ I/O æ•ˆç‡**ã€**èŒƒå›´æŸ¥è¯¢**ã€**ç¨³å®šæ€§**å’Œ**ç©ºé—´åˆ©ç”¨ç‡**ä¹‹é—´å–å¾—çš„æœ€ä½³å¹³è¡¡ã€‚å®ƒç‰¹åˆ«é€‚åˆå¤„ç†æ•°æ®åº“è¿™ç§æ•°æ®é‡å·¨å¤§ã€ä¸”æŸ¥è¯¢æ¨¡å¼å¤æ‚ï¼ˆå¤§é‡èŒƒå›´æŸ¥è¯¢ã€æ’åºã€åˆ†ç»„ï¼‰çš„åœºæ™¯ã€‚

å³ä½¿ç°åœ¨ SSD è¶Šæ¥è¶Šæ™®åŠï¼Œå…¶éšæœºè¯»å†™æ€§èƒ½è¿œè¶… HDDï¼Œä½†å‡å°‘ I/O æ¬¡æ•°çš„æ ¸å¿ƒæ€æƒ³ä¾ç„¶æ²¡æœ‰å˜ï¼ˆSSD çš„éšæœºè¯»å†™ä»æ…¢äºé¡ºåºè¯»å†™ï¼Œä¸”å­˜åœ¨å†™å…¥æ”¾å¤§ç­‰é—®é¢˜ï¼‰ï¼Œå› æ­¤ B+ æ ‘ä¾ç„¶æ˜¯æ•°æ®åº“ç´¢å¼•çš„é»„é‡‘æ ‡å‡†ã€‚

**å‡å°‘ç£ç›˜ I/O æ¬¡æ•°ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡**

- **ç£ç›˜ç‰¹æ€§**ï¼šæœºæ¢°ç¡¬ç›˜çš„éšæœºè¯»å†™é€Ÿåº¦å¾ˆæ…¢ï¼Œä½†é¡ºåºè¯»å†™é€Ÿåº¦å¿«ã€‚ç£ç›˜è¯»å†™ä»¥â€œé¡µâ€ï¼ˆé€šå¸¸æ˜¯ 4KBï¼‰ä¸ºå•ä½ã€‚å› æ­¤ï¼Œè¯„ä»·ç´¢å¼•ä¼˜åŠ£çš„å…³é”®æ˜¯**æ¯æ¬¡æ“ä½œéœ€è¦è®¿é—®å¤šå°‘ç£ç›˜å—ï¼ˆç£ç›˜é¡µï¼‰**ã€‚
- **æ ‘çš„é«˜åº¦ä½**ï¼šB+ æ ‘æ˜¯ä¸€ä¸ªå¤šè·¯å¹³è¡¡æœç´¢æ ‘ï¼Œä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥æ‹¥æœ‰éå¸¸å¤šçš„å­èŠ‚ç‚¹ï¼ˆæ‰‡å‡ºé«˜ï¼‰ã€‚è¿™æ„å‘³ç€å¯¹äºå¤§é‡æ•°æ®ï¼ˆå¦‚åƒä¸‡çº§ã€äº¿çº§è®°å½•ï¼‰ï¼ŒB+ æ ‘ä¾ç„¶èƒ½ç»´æŒéå¸¸ä½çŸ®çš„é«˜åº¦ï¼ˆé€šå¸¸åªæœ‰ 3-4 å±‚ï¼‰ã€‚
- **ç»“æœ**ï¼šæŸ¥æ‰¾ä»»ä½•ä¸€æ¡è®°å½•ï¼Œæœ€å¤šåªéœ€è¦ 3-4 æ¬¡ç£ç›˜ I/Oï¼ˆå³ä»æ ¹èŠ‚ç‚¹éå†åˆ°å¶å­èŠ‚ç‚¹ï¼‰ã€‚è¿™æ˜¯æ€§èƒ½ä¸Šçš„å·¨å¤§ä¼˜åŠ¿ã€‚

**éå¸¸é€‚åˆèŒƒå›´æŸ¥è¯¢**

è¿™æ˜¯ B+ æ ‘ç›¸å¯¹äº B æ ‘çš„ä¸€ä¸ªæ˜¾è‘—ä¼˜åŠ¿ã€‚

- **æ•°æ®ç»“æ„**ï¼šB+ æ ‘çš„æ‰€æœ‰æ•°æ®è®°å½•éƒ½å­˜å‚¨åœ¨**å¶å­èŠ‚ç‚¹**ä¸Šï¼Œå¹¶æŒ‰é”®å€¼å¤§å°é¡ºåºé“¾æ¥æˆä¸€ä¸ªåŒå‘é“¾è¡¨ã€‚å†…éƒ¨èŠ‚ç‚¹ï¼ˆéå¶å­èŠ‚ç‚¹ï¼‰åªå­˜å‚¨é”®å€¼å’ŒæŒ‡å‘å­èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œä¸å­˜å‚¨å®é™…æ•°æ®ã€‚
- **æŸ¥è¯¢è¿‡ç¨‹**ï¼š
  1. é€šè¿‡æ ¹èŠ‚ç‚¹å’Œå†…éƒ¨èŠ‚ç‚¹å¿«é€Ÿå®šä½åˆ°èŒƒå›´æŸ¥è¯¢çš„èµ·å§‹ç‚¹ï¼ˆä¸€æ¬¡å¿«é€Ÿçš„è¿‘ä¼¼æŸ¥æ‰¾ï¼‰ã€‚
  2. åˆ°è¾¾å¶å­èŠ‚ç‚¹åï¼Œåªéœ€æ²¿ç€é“¾è¡¨çš„æŒ‡é’ˆé¡ºåºæ‰«æå³å¯ï¼Œä¸éœ€è¦å†å›æº¯åˆ°ä¸Šå±‚èŠ‚ç‚¹ã€‚
- **ç»“æœ**ï¼šèŒƒå›´æŸ¥è¯¢ï¼ˆå¦‚ `WHERE id BETWEEN 100 AND 500`ï¼‰æ•ˆç‡æé«˜ï¼Œå‡ ä¹æ˜¯é¡ºåºè¯»å–ï¼Œé€Ÿåº¦éå¸¸å¿«ã€‚è€Œ B æ ‘è¿›è¡ŒèŒƒå›´æŸ¥è¯¢åˆ™éœ€è¦åœ¨å†…éƒ¨èŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹ä¹‹é—´æ¥å›ç§»åŠ¨ï¼Œæ•ˆç‡ä½ä¸‹ã€‚

**æŸ¥è¯¢æ€§èƒ½ç¨³å®š**

- **æ‰€æœ‰æŸ¥è¯¢è·¯å¾„ç­‰é•¿**ï¼šç”±äº B+ æ ‘æ˜¯å¹³è¡¡æ ‘ï¼Œä»æ ¹èŠ‚ç‚¹åˆ°**ä»»ä½•ä¸€ä¸ªå¶å­èŠ‚ç‚¹**çš„è·¯å¾„é•¿åº¦éƒ½æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚è¿™æ„å‘³ç€æŸ¥è¯¢ä»»ä½•ä¸€æ¡è®°å½•ï¼ˆæ— è®ºæ˜¯ç¬¬ä¸€æ¡ã€æœ€åä¸€æ¡è¿˜æ˜¯ä¸­é—´ä»»æ„ä¸€æ¡ï¼‰çš„è€—æ—¶éƒ½éå¸¸ç¨³å®šï¼Œéƒ½æ˜¯ **O(log n)** çš„æ—¶é—´å¤æ‚åº¦ã€‚
- **ç»“æœ**ï¼šæä¾›äº†ç¨³å®šå¯é çš„å¹³å‡æ€§èƒ½ï¼Œæ²¡æœ‰æ€§èƒ½æ³¢åŠ¨é£é™©ã€‚

**æ›´é«˜çš„ç©ºé—´åˆ©ç”¨ç‡å’Œç¼“å­˜æ•ˆç‡**

- **å†…éƒ¨èŠ‚ç‚¹æ— æ•°æ®**ï¼šå› ä¸ºéå¶å­èŠ‚ç‚¹ä¸å­˜å‚¨å®é™…æ•°æ®è¡Œï¼Œæ‰€ä»¥æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥å®¹çº³æ›´å¤šçš„é”®å€¼å’ŒæŒ‡é’ˆï¼ˆæ›´é«˜çš„æ‰‡å‡ºï¼‰ã€‚è¿™ä½¿å¾—æ ‘æ›´â€œèƒ–â€ï¼Œé«˜åº¦æ›´ä½ï¼Œè¿›ä¸€æ­¥å‡å°‘äº† I/O æ¬¡æ•°ã€‚
- **ç¼“å­˜å‹å¥½**ï¼šæ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰æœ‰è‡ªå·±çš„ç¼“å†²æ± ï¼ˆBuffer Poolï¼‰ã€‚ç”±äºéå¶å­èŠ‚ç‚¹æ›´å°ï¼Œåœ¨ä¸€æ¬¡ç£ç›˜ I/O ä¸­ï¼Œå¯ä»¥å°†æ›´å¤šçš„èŠ‚ç‚¹æ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­ã€‚æˆ–è€…ï¼Œåœ¨å†…å­˜æœ‰é™çš„æƒ…å†µä¸‹ï¼Œç¼“å†²æ± å¯ä»¥ç¼“å­˜æ›´å¤šçš„ä¸Šå±‚èŠ‚ç‚¹ï¼ˆå¦‚æ ¹èŠ‚ç‚¹å’Œç»å¸¸è®¿é—®çš„ä¸­é—´èŠ‚ç‚¹ï¼‰ï¼Œä½¿å¾—å¤§å¤šæ•°æŸ¥è¯¢å¯èƒ½åœ¨ 1-2 æ¬¡ I/O å†…å®Œæˆã€‚

**å…¨è¡¨æ‰«ææ›´æ–¹ä¾¿**

- å¦‚æœéœ€è¦è¿›è¡Œå…¨è¡¨æ‰«æï¼ŒB+ æ ‘ä¸éœ€è¦åƒ B æ ‘é‚£æ ·å¯¹æ•´æ£µæ ‘è¿›è¡Œå¤æ‚çš„ä¸­åºéå†ã€‚å®ƒåªéœ€è¦å¯¹å¶å­èŠ‚ç‚¹ç»„æˆçš„é“¾è¡¨è¿›è¡Œ**ä¸€æ¬¡ç®€å•çš„é¡ºåºéå†**å³å¯ï¼Œæ•ˆç‡éå¸¸é«˜ã€‚

![](https://raw.githubusercontent.com/dunwu/images/master/snap/20200304235424.jpg)

> B+ æ ‘ vs B æ ‘

- B+ æ ‘åªåœ¨å¶å­èŠ‚ç‚¹å­˜å‚¨æ•°æ®ï¼Œè€Œ B æ ‘çš„éå¶å­èŠ‚ç‚¹ä¹Ÿè¦å­˜å‚¨æ•°æ®ï¼Œæ‰€ä»¥ B+ æ ‘çš„å•ä¸ªèŠ‚ç‚¹çš„æ•°æ®é‡æ›´å°ï¼Œåœ¨ç›¸åŒçš„ç£ç›˜ I/O æ¬¡æ•°ä¸‹ï¼Œå°±èƒ½æŸ¥è¯¢æ›´å¤šçš„èŠ‚ç‚¹ã€‚
- å¦å¤–ï¼ŒB+ æ ‘å¶å­èŠ‚ç‚¹é‡‡ç”¨çš„æ˜¯åŒé“¾è¡¨è¿æ¥ï¼Œé€‚åˆ MySQL ä¸­å¸¸è§çš„åŸºäºèŒƒå›´çš„é¡ºåºæŸ¥æ‰¾ï¼Œè€Œ B æ ‘æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ã€‚

> B+ æ ‘ vs äºŒå‰æ ‘

- å¯¹äºæœ‰ N ä¸ªå¶å­èŠ‚ç‚¹çš„ B+ æ ‘ï¼Œå…¶æœç´¢å¤æ‚åº¦ä¸º `O(logdN)`ï¼Œå…¶ä¸­ d è¡¨ç¤ºèŠ‚ç‚¹å…è®¸çš„æœ€å¤§å­èŠ‚ç‚¹ä¸ªæ•°ä¸º d ä¸ªã€‚
- åœ¨å®é™…çš„åº”ç”¨å½“ä¸­ï¼Œ d å€¼æ˜¯å¤§äº 100 çš„ï¼Œè¿™æ ·å°±ä¿è¯äº†ï¼Œå³ä½¿æ•°æ®è¾¾åˆ°åƒä¸‡çº§åˆ«æ—¶ï¼ŒB+ æ ‘çš„é«˜åº¦ä¾ç„¶ç»´æŒåœ¨ 1~3 å±‚å·¦å³ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€æ¬¡æ•°æ®æŸ¥è¯¢æ“ä½œåªéœ€è¦åš 1~3 æ¬¡çš„ç£ç›˜ I/O æ“ä½œå°±èƒ½æŸ¥è¯¢åˆ°ç›®æ ‡æ•°æ®ã€‚
- è€ŒäºŒå‰æ ‘çš„æ¯ä¸ªçˆ¶èŠ‚ç‚¹çš„å„¿å­èŠ‚ç‚¹ä¸ªæ•°åªèƒ½æ˜¯ 2 ä¸ªï¼Œæ„å‘³ç€å…¶æœç´¢å¤æ‚åº¦ä¸º `O(logN)`ï¼Œè¿™å·²ç»æ¯” B+ æ ‘é«˜å‡ºä¸å°‘ï¼Œå› æ­¤äºŒå‰æ ‘æ£€ç´¢åˆ°ç›®æ ‡æ•°æ®æ‰€ç»å†çš„ç£ç›˜ I/O æ¬¡æ•°è¦æ›´å¤šã€‚

ä¸€è¨€ä»¥è”½ä¹‹ï¼Œä½¿ç”¨ B+ æ ‘ï¼Œè€Œä¸æ˜¯äºŒå‰æ ‘ï¼Œæ˜¯ä¸ºäº†å‡å°‘æ ‘çš„é«˜åº¦ï¼Œä¹Ÿå°±æ˜¯ä¸ºäº†å‡å°‘ç£ç›˜ I/O æ¬¡æ•°ã€‚

> B+ æ ‘ç´¢å¼•å’Œ Hash ç´¢å¼•çš„å·®å¼‚

- **B+ æ ‘ç´¢å¼•æ”¯æŒèŒƒå›´æŸ¥è¯¢**ï¼›Hash ç´¢å¼•ä¸æ”¯æŒã€‚
- **B+ æ ‘ç´¢å¼•æ”¯æŒè”åˆç´¢å¼•çš„æœ€å·¦åŒ¹é…åŸåˆ™**ï¼›Hash ç´¢å¼•ä¸æ”¯æŒã€‚
- **B+ æ ‘ç´¢å¼•æ”¯æŒæ’åº**ï¼›Hash ç´¢å¼•ä¸æ”¯æŒã€‚
- **B+ æ ‘ç´¢å¼•æ”¯æŒæ¨¡ç³ŠæŸ¥è¯¢**ï¼›Hash ç´¢å¼•ä¸æ”¯æŒã€‚
- Hash ç´¢å¼•çš„ç­‰å€¼æŸ¥è¯¢æ¯” B+ æ ‘ç´¢å¼•æ•ˆç‡é«˜ã€‚

ç»¼ä¸Šï¼ŒHash ç´¢å¼•çš„åº”ç”¨åœºæ™¯å¾ˆè‹›åˆ»ï¼Œä¸é€‚ç”¨äºç»å¤§å¤šæ•°åœºæ™¯ã€‚

### ã€ä¸­ç­‰ã€‘B+ æ ‘ç´¢å¼•èƒ½å­˜å¤šå°‘æ•°æ®ï¼ŸğŸŒŸ

åœ¨ InnoDB å­˜å‚¨å¼•æ“ä¸­ï¼ŒB+ æ ‘é»˜è®¤æ•°æ®é¡µå¤§å°ä¸º **16KB**ã€‚

æ‰€æœ‰ B+ æ ‘éƒ½æ˜¯ä»é«˜åº¦ä¸º 1 çš„æ ‘å¼€å§‹ï¼Œç„¶åæ ¹æ®æ•°æ®çš„æ’å…¥ï¼Œæ…¢æ…¢å¢åŠ æ ‘çš„é«˜åº¦ã€‚éšç€æ’å…¥ B+ æ ‘ç´¢å¼•çš„è®°å½•å˜å¤šï¼Œ1 ä¸ªé¡µï¼ˆ16Kï¼‰æ— æ³•å­˜æ”¾è¿™ä¹ˆå¤šæ•°æ®ï¼Œæ‰€ä»¥ä¼šå‘ç”Ÿ B+ æ ‘çš„åˆ†è£‚ï¼ŒB+ æ ‘çš„é«˜åº¦å˜ä¸º 2ã€‚

> éå¶å­èŠ‚ç‚¹å¯å­˜å‚¨çš„è®°å½•æ•°

æ ¹èŠ‚ç‚¹å’Œä¸­é—´èŠ‚ç‚¹å­˜æ”¾çš„æ˜¯ç´¢å¼•é”®å¯¹ï¼Œç”±ï¼ˆç´¢å¼•é”®ã€æŒ‡é’ˆï¼‰ç»„æˆã€‚

ç´¢å¼•é”®å°±æ˜¯æ’åºçš„åˆ—ï¼Œè€ŒæŒ‡é’ˆæ˜¯æŒ‡å‘ä¸‹ä¸€å±‚çš„åœ°å€ï¼Œåœ¨ MySQL çš„ InnoDB å­˜å‚¨å¼•æ“ä¸­å ç”¨ 6 ä¸ªå­—èŠ‚ã€‚è‹¥ä¸»é”®æ˜¯ BIGINT ç±»å‹ï¼Œå  8 ä¸ªå­—èŠ‚ã€‚ä¹Ÿå³æ˜¯è¯´ï¼Œè¿™æ ·çš„ä¸€ä¸ªé”®å€¼å¯¹éœ€è¦ `8+6 = 14` å­—èŠ‚ã€‚

```
éå¶å­èŠ‚ç‚¹å¯å­˜å‚¨çš„è®°å½•æ•° = é¡µå¤§å°ï¼ˆ16Kï¼‰ / é”®å€¼å¯¹å¤§å°ï¼ˆ14ï¼‰ â‰ˆ 1100
```

> å¶å­èŠ‚ç‚¹å¯å­˜å‚¨çš„è®°å½•æ•°

ä¸ºäº†æ–¹ä¾¿è®¡ç®—ï¼Œå‡è®¾æ•°æ®è®°å½•çš„å¹³å‡å¤§å°ä¸º 1000 å­—èŠ‚ï¼ˆå®é™…ä¸€èˆ¬å°äºè¿™ä¸ªå€¼ï¼‰ï¼Œåˆ™

```
å¶å­èŠ‚ç‚¹å¯å­˜å‚¨çš„è®°å½•æ•° = é¡µå¤§å°ï¼ˆ16Kï¼‰ / è®°å½•å¹³å‡å¤§å°ï¼ˆ1000ï¼‰ â‰ˆ 16
```

ç”±æ­¤å¯çŸ¥ï¼Œæ ‘é«˜åº¦ä¸º 2 çš„ B+ æ ‘ç´¢å¼•ï¼Œæœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œçº¦ 1100 ä¸ªå¶å­èŠ‚ç‚¹ã€‚å› æ­¤ï¼Œæœ€å¤šèƒ½å­˜æ”¾çš„è®°å½•æ•°ä¸ºï¼š

```yaml
äºŒå±‚ B+ æ ‘è®°å½•æ•° â‰ˆ 1100 * 16 =  17,600
```

> å¦‚ä½•æ¨ç®—ä¸åŒé«˜åº¦çš„ B+ æ ‘å¯å­˜å‚¨çš„è®°å½•æ•°

ç»¼ä¸Šæ‰€è¿°ï¼Œæ•°æ®è®°å½•çš„å¹³å‡å¤§å°ä¸º 1000 å­—èŠ‚ï¼Œä¸»é”®ä¸º `BIGINT` çš„è¡¨ï¼Œå¯ä»¥æŒ‰å¦‚ä¸‹æ¨ç®—å…¶å¯å­˜å‚¨çš„è®°å½•æ•°ï¼š

- é«˜åº¦ä¸º 2 çš„ B+æ ‘ç´¢å¼•æœ€å¤šèƒ½å­˜æ”¾çº¦ `1100 * 16 =  17,600` æ¡è®°å½•ï¼ˆçº¦ 1.76 ä¸‡ï¼‰ï¼ŒæŸ¥è¯¢æ—¶åªéœ€ 2 æ¬¡ I/Oã€‚
- é«˜åº¦ä¸º 3 çš„ B+æ ‘ç´¢å¼•æœ€å¤šèƒ½å­˜æ”¾çº¦ `1100 * 1100 * 16 =  19,360,000` æ¡è®°å½•ï¼ˆçº¦ 2 åƒä¸‡ï¼‰ï¼ŒæŸ¥è¯¢æ—¶åªéœ€ 3 æ¬¡ I/Oã€‚
- é«˜åº¦ä¸º 4 çš„ B+æ ‘ç´¢å¼•æœ€å¤šèƒ½å­˜æ”¾çº¦ `1100 * 1100 * 1100 * 16 =  21,296,000,000` æ¡è®°å½•ï¼ˆçº¦ 200 å¤šäº¿ï¼‰ï¼ŒæŸ¥è¯¢æ—¶åªéœ€ 4 æ¬¡ I/Oã€‚

ä¼˜åŒ– B+ æ ‘ç´¢å¼•çš„æ’å…¥æ€§èƒ½ï¼š

- é¡ºåºæ’å…¥ï¼ˆå¦‚è‡ªå¢ ID æˆ–æ—¶é—´åˆ—ï¼‰çš„ç»´æŠ¤ä»£ä»·å°ï¼Œæ€§èƒ½è¾ƒå¥½ã€‚
- æ— åºæ’å…¥ï¼ˆå¦‚ç”¨æˆ·æ˜µç§°ï¼‰ä¼šå¯¼è‡´é¡µåˆ†è£‚ã€æ—‹è½¬ç­‰å¼€é”€è¾ƒå¤§çš„æ“ä½œï¼Œå½±å“æ€§èƒ½ã€‚
- ä¸»é”®è®¾è®¡åº”å°½é‡ä½¿ç”¨é¡ºåºå€¼ï¼ˆå¦‚è‡ªå¢ IDï¼‰ï¼Œä»¥ä¿è¯é«˜å¹¶å‘åœºæ™¯ä¸‹çš„æ€§èƒ½ã€‚

## èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•

### ã€ä¸­ç­‰ã€‘èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŸğŸŒŸğŸŒŸ

æ ¹æ®å¶å­èŠ‚ç‚¹çš„å†…å®¹ï¼Œç´¢å¼•ç±»å‹åˆ†ä¸ºä¸»é”®ç´¢å¼•å’Œéä¸»é”®ç´¢å¼•ã€‚

ä¸»é”®ç´¢å¼•åˆè¢«ç§°ä¸º**èšç°‡ç´¢å¼•ï¼ˆclustered indexï¼‰ï¼Œå…¶å¶å­èŠ‚ç‚¹å­˜çš„æ˜¯æ•´è¡Œæ•°æ®**ã€‚

- èšç°‡è¡¨ç¤ºæ•°æ®è¡Œå’Œç›¸é‚»çš„é”®å€¼ç´§å‡‘åœ°å­˜å‚¨åœ¨ä¸€èµ·ï¼Œå› ä¸ºæ•°æ®ç´§å‡‘ï¼Œæ‰€ä»¥è®¿é—®å¿«ã€‚
- å› ä¸ºæ— æ³•åŒæ—¶æŠŠæ•°æ®è¡Œå­˜æ”¾åœ¨ä¸¤ä¸ªä¸åŒçš„åœ°æ–¹ï¼Œæ‰€ä»¥**ä¸€ä¸ªè¡¨åªèƒ½æœ‰ä¸€ä¸ªèšç°‡ç´¢å¼•**ã€‚
- InnoDB çš„èšç°‡ç´¢å¼•å®é™…æ˜¯åœ¨åŒä¸€ä¸ªç»“æ„ä¸­ä¿å­˜äº† B æ ‘çš„ç´¢å¼•å’Œæ•°æ®è¡Œã€‚

éä¸»é”®ç´¢å¼•åˆè¢«ç§°ä¸º**äºŒçº§ç´¢å¼•ï¼ˆsecondary indexï¼‰ï¼Œå…¶å¶å­èŠ‚ç‚¹å­˜çš„æ˜¯ä¸»é”®çš„å€¼**ã€‚æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªä½ç½®ï¼Œç´¢å¼•å­˜å‚¨åœ¨å¦ä¸€ä¸ªä½ç½®ï¼Œç´¢å¼•ä¸­åŒ…å«æŒ‡å‘æ•°æ®å­˜å‚¨ä½ç½®çš„æŒ‡é’ˆã€‚

- å¦‚æœè¯­å¥æ˜¯ `select * from T where ID=500`ï¼Œå³èšç°‡ç´¢å¼•æŸ¥è¯¢æ–¹å¼ï¼Œåˆ™åªéœ€è¦æœç´¢ä¸»é”®ç´¢å¼•æ ‘ï¼›
- å¦‚æœè¯­å¥æ˜¯ `select * from T where k=5`ï¼Œå³éèšç°‡ç´¢å¼•æŸ¥è¯¢æ–¹å¼ï¼Œåˆ™éœ€è¦å…ˆæœç´¢ k ç´¢å¼•æ ‘ï¼Œå¾—åˆ° ID çš„å€¼ä¸º 500ï¼Œå†åˆ° ID ç´¢å¼•æ ‘æœç´¢ä¸€æ¬¡ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸º**å›è¡¨**ã€‚

![](https://raw.githubusercontent.com/dunwu/images/master/snap/202503221604600.png)

ä¹Ÿå°±æ˜¯è¯´ï¼Œ**åŸºäºéèšç°‡ç´¢å¼•çš„æŸ¥è¯¢éœ€è¦å¤šæ‰«æä¸€æ£µç´¢å¼•æ ‘**ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨åº”ç”¨ä¸­åº”è¯¥å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢ã€‚

**æ˜¾ç„¶ï¼Œä¸»é”®é•¿åº¦è¶Šå°ï¼Œéèšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å°±è¶Šå°ï¼Œéèšç°‡ç´¢å¼•å ç”¨çš„ç©ºé—´ä¹Ÿå°±è¶Šå°ã€‚**

### ã€ç®€å•ã€‘ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•ï¼Ÿ

**è¦†ç›–ç´¢å¼•æ˜¯æŒ‡ï¼šäºŒçº§ç´¢å¼•ä¸Šçš„ä¿¡æ¯æ»¡è¶³æŸ¥è¯¢æ‰€éœ€çš„æ‰€æœ‰å­—æ®µï¼Œä¸éœ€è¦å›è¡¨æŸ¥è¯¢èšç°‡ç´¢å¼•ä¸Šçš„æ•°æ®**ã€‚

**ç”±äºè¦†ç›–ç´¢å¼•å¯ä»¥å‡å°‘æ ‘çš„æœç´¢æ¬¡æ•°ï¼Œæ˜¾è‘—æå‡æŸ¥è¯¢æ€§èƒ½ï¼Œæ‰€ä»¥ä½¿ç”¨è¦†ç›–ç´¢å¼•æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µ**ã€‚

## å­—æ®µç‰¹æ€§ç´¢å¼•

### ã€ç®€å•ã€‘AUTO_INCREMENT åˆ—è¾¾åˆ°æœ€å¤§å€¼æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

> é…ç½®ä¸»é”®

åœ¨ MySQL ä¸­ï¼Œå¦‚æœè¡¨å®šä¹‰çš„è‡ªå¢ ID åˆ°è¾¾ä¸Šé™åï¼Œå†ç”³è¯·ä¸‹ä¸€ä¸ª IDï¼Œå¾—åˆ°çš„å€¼ä¸å˜ï¼å› æ­¤ä¼šå¯¼è‡´é‡å¤å€¼çš„é”™è¯¯ã€‚

> æ²¡æœ‰é…ç½®ä¸»é”®

å¦‚æœ InnoDB è¡¨ä¸­æ²¡æœ‰é…ç½®ä¸»é”®ï¼ŒInnoDB ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªä¸å¯è§çš„ã€é•¿åº¦ä¸º 6 ä¸ªå­—èŠ‚çš„ row_id ä½œä¸ºé»˜è®¤ä¸»é”®ã€‚

InnoDB åœ¨å…¨å±€ç»´æŠ¤ä¸€ä¸ª `dict_sys.row_id` å€¼ã€‚æ¯æ¬¡æ’å…¥ä¸€è¡Œæ•°æ®æ—¶ï¼Œéƒ½ä¼šè·å–å½“å‰çš„ `dict_sys.row_id` å€¼ï¼Œå¹¶å°†å…¶åŠ  1ã€‚`row_id` çš„èŒƒå›´æ˜¯ `0` åˆ° `2^48 - 1`ã€‚å½“ `row_id` è¾¾åˆ°ä¸Šé™åï¼Œä¼šä» `0` å¼€å§‹é‡æ–°å¾ªç¯ã€‚

å¦‚æœæ’å…¥çš„æ–°æ•°æ®çš„ `row_id` åœ¨è¡¨ä¸­å·²å­˜åœ¨ï¼Œè€æ•°æ®ä¼šè¢«æ–°æ•°æ®è¦†ç›–ï¼Œä¸”ä¸ä¼šäº§ç”Ÿä»»ä½•æŠ¥é”™ã€‚å¯ä»¥é€šè¿‡ `gdb` åŠ¨æ€ä¿®æ”¹ `dict_sys.row_id` æ¥éªŒè¯è¿™ä¸€è¡Œä¸ºã€‚

### ã€ç®€å•ã€‘æ™®é€šé”®å’Œå”¯ä¸€é”®ï¼Œåº”è¯¥æ€ä¹ˆé€‰æ‹©ï¼Ÿ

å”¯ä¸€ç´¢å¼•çš„ä¸»è¦ä½œç”¨æ˜¯ä¿è¯æ•°æ®çš„å”¯ä¸€æ€§ï¼Œè€Œæ™®é€šç´¢å¼•åˆ™æ›´çµæ´»ã€‚åœ¨ä¸šåŠ¡ä»£ç ä¿è¯ä¸ä¼šå†™å…¥é‡å¤æ•°æ®çš„æƒ…å†µä¸‹ï¼Œæ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•åœ¨æŸ¥è¯¢æ€§èƒ½ä¸Šå‡ ä¹æ²¡æœ‰å·®åˆ«ã€‚

**æ™®é€šç´¢å¼•** åœ¨æ›´æ–°æ“ä½œä¸­æ€§èƒ½æ›´ä¼˜ï¼Œå°¤å…¶æ˜¯åœ¨å†™å¤šè¯»å°‘çš„åœºæ™¯ä¸‹ï¼Œèƒ½å¤Ÿåˆ©ç”¨ change buffer å‡å°‘ç£ç›˜ I/Oã€‚

**å”¯ä¸€ç´¢å¼•** é€‚ç”¨äºéœ€è¦ä¿è¯æ•°æ®å”¯ä¸€æ€§çš„åœºæ™¯ï¼Œä½†åœ¨æ›´æ–°æ“ä½œä¸­æ€§èƒ½è¾ƒå·®ï¼Œå› ä¸ºå®ƒæ— æ³•ä½¿ç”¨ change bufferã€‚

åœ¨ä¸šåŠ¡å…è®¸çš„æƒ…å†µä¸‹ï¼Œ**ä¼˜å…ˆé€‰æ‹©æ™®é€šç´¢å¼•**ï¼Œå› ä¸ºå®ƒå¯ä»¥åˆ©ç”¨ change buffer æ¥æå‡æ›´æ–°æ€§èƒ½ã€‚å¦‚æœä¸šåŠ¡è¦æ±‚å¿…é¡»ä¿è¯æ•°æ®çš„å”¯ä¸€æ€§ï¼Œåˆ™å¿…é¡»ä½¿ç”¨å”¯ä¸€ç´¢å¼•ã€‚

**æŸ¥è¯¢è¿‡ç¨‹çš„æ€§èƒ½å·®å¼‚**ï¼šå¯¹äºæŸ¥è¯¢æ“ä½œï¼Œæ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•çš„æ€§èƒ½å·®å¼‚å¾®ä¹å…¶å¾®ã€‚å”¯ä¸€ç´¢å¼•åœ¨æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„è®°å½•åä¼šåœæ­¢æ£€ç´¢ï¼Œè€Œæ™®é€šç´¢å¼•éœ€è¦ç»§ç»­æŸ¥æ‰¾ä¸‹ä¸€ä¸ªè®°å½•ï¼Œä½†ç”±äºæ•°æ®é¡µçš„è¯»å–æ–¹å¼ï¼Œè¿™ç§å·®å¼‚å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚

**æ›´æ–°è¿‡ç¨‹çš„æ€§èƒ½å·®å¼‚**ï¼šæ›´æ–°æ“ä½œä¸­ï¼Œæ™®é€šç´¢å¼•å¯ä»¥åˆ©ç”¨ **change buffer** æ¥ä¼˜åŒ–æ€§èƒ½ï¼Œè€Œå”¯ä¸€ç´¢å¼•åˆ™ä¸èƒ½ä½¿ç”¨ change bufferã€‚

- **change buffer** æ˜¯ä¸€ç§å°†æ›´æ–°æ“ä½œç¼“å­˜åœ¨å†…å­˜ä¸­çš„æœºåˆ¶ï¼Œå‡å°‘äº†å¯¹ç£ç›˜çš„éšæœºè¯»å–ï¼Œä»è€Œæå‡äº†æ›´æ–°æ“ä½œçš„æ€§èƒ½ã€‚
- å”¯ä¸€ç´¢å¼•åœ¨æ›´æ–°æ—¶éœ€è¦æ£€æŸ¥å”¯ä¸€æ€§çº¦æŸï¼Œå¿…é¡»å°†æ•°æ®é¡µè¯»å…¥å†…å­˜ï¼Œå¢åŠ äº†ç£ç›˜ I/O çš„å¼€é”€ã€‚

**change buffer çš„åº”ç”¨**

- change buffer çš„æ•°æ®æ˜¯æŒä¹…åŒ–çš„ï¼Œå³ä½¿æœºå™¨æ‰ç”µé‡å¯ï¼Œchange buffer ä¸­çš„æ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±ï¼Œå› ä¸ºå®ƒä¼šè¢«å†™å…¥ç£ç›˜ã€‚
- change buffer é€‚ç”¨äºå†™å¤šè¯»å°‘çš„åœºæ™¯ï¼Œå¦‚è´¦å•ç±»ã€æ—¥å¿—ç±»ç³»ç»Ÿï¼Œå› ä¸ºè¿™äº›åœºæ™¯ä¸‹æ•°æ®é¡µåœ¨å†™å…¥åä¸ä¼šç«‹å³è¢«è®¿é—®ï¼Œchange buffer å¯ä»¥æ˜¾è‘—å‡å°‘ç£ç›˜ I/Oã€‚
- å¯¹äºå†™åç«‹å³æŸ¥è¯¢çš„åœºæ™¯ï¼Œchange buffer çš„æ•ˆæœä¸æ˜æ˜¾ï¼Œç”šè‡³å¯èƒ½å¢åŠ ç»´æŠ¤æˆæœ¬ã€‚

**change buffer vs. redo log**

- **redo log** ä¸»è¦å‡å°‘éšæœºå†™ç£ç›˜çš„ I/O æ¶ˆè€—ï¼Œå°†éšæœºå†™è½¬æ¢ä¸ºé¡ºåºå†™ã€‚
- **change buffer** ä¸»è¦å‡å°‘éšæœºè¯»ç£ç›˜çš„ I/O æ¶ˆè€—ï¼Œé€šè¿‡ç¼“å­˜æ›´æ–°æ“ä½œæ¥å‡å°‘ç£ç›˜è¯»å–ã€‚

### ã€ä¸­ç­‰ã€‘ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨å¤–é”®ï¼Ÿ

**é€»è¾‘å¤–é”®**æ˜¯ä¸€ç§åœ¨åº”ç”¨ç¨‹åºå±‚é¢ä¸Šç®¡ç†å’Œç»´æŠ¤æ•°æ®å®Œæ•´æ€§çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯é€šè¿‡æ•°æ®åº“æœ¬èº«çš„å¤–é”®çº¦æŸã€‚ä¸»è¦æ˜¯åˆ©ç”¨åº”ç”¨ç¨‹åºä»£ç æ¥ä¿è¯å¼•ç”¨çš„å®Œæ•´æ€§ã€‚

é€»è¾‘å¤–é”®çš„ä¼˜ç¼ºç‚¹ï¼š

**ä¼˜ç‚¹**ï¼š

- **çµæ´»æ€§é«˜**ï¼šåº”ç”¨ç¨‹åºå±‚é¢æ§åˆ¶ï¼Œå¯ä»¥æ›´çµæ´»åœ°å®ç°å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ã€‚
- **æ€§èƒ½ä¼˜åŒ–**ï¼šé¿å…äº†æ•°æ®åº“å±‚é¢çš„çº¦æŸæ£€æŸ¥ï¼Œå¯ä»¥åœ¨æŸäº›æƒ…å†µä¸‹æé«˜æ€§èƒ½ï¼ˆè¯¦ç»†çœ‹æ‰©å±•çŸ¥è¯†ï¼‰ã€‚
- **è·¨æ•°æ®åº“å…¼å®¹æ€§**ï¼šé€»è¾‘å¤–é”®åœ¨ä¸åŒç±»å‹çš„æ•°æ®ä¹‹é—´æ›´å®¹æ˜“è¿ç§»ã€‚

**ç¼ºç‚¹**ï¼š

- **ä»£ç å¤æ‚æ€§å¢åŠ **ï¼šéœ€è¦åœ¨åº”ç”¨ç¨‹åºä»£ç ä¸­æ‰‹åŠ¨å®ç°å’Œç»´æŠ¤å¼•ç”¨å®Œæ•´æ€§ï¼Œå¢åŠ äº†ä»£ç çš„å¤æ‚æ€§å’Œé”™è¯¯çš„å¯èƒ½æ€§ã€‚
- **ä¸€è‡´æ€§é£é™©**ï¼šå¦‚æœåº”ç”¨ç¨‹åºä»£ç æœªæ­£ç¡®å®ç°å¼•ç”¨å®Œæ•´æ€§æ£€æŸ¥ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€‚
- **ç»´æŠ¤æˆæœ¬é«˜**ï¼šé€»è¾‘å¤–é”®éœ€è¦å¼€å‘äººå‘˜æŒç»­å…³æ³¨å’Œç»´æŠ¤ï¼Œå¢åŠ äº†ç»´æŠ¤æˆæœ¬ã€‚

ç‰©ç†å¤–é”®çš„ä¼˜ç¼ºç‚¹ï¼š

**ä¼˜ç‚¹**ï¼š

- **è‡ªåŠ¨ç»´æŠ¤å¼•ç”¨å®Œæ•´æ€§**ï¼šæ•°æ®åº“ä¼šè‡ªåŠ¨æ£€æŸ¥å’Œç»´æŠ¤å¤–é”®çº¦æŸï¼Œç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§ã€‚
- **å‡å°‘åº”ç”¨å±‚å¤æ‚æ€§**ï¼šå¼€å‘äººå‘˜ä¸éœ€è¦æ‰‹åŠ¨ç®¡ç†å¼•ç”¨å®Œæ•´æ€§ï¼Œå‡å°‘äº†ä»£ç çš„å¤æ‚æ€§å’Œé”™è¯¯çš„å¯èƒ½æ€§ã€‚
- **æ•°æ®å®Œæ•´æ€§ä¿éšœ**ï¼šæ•°æ®åº“å±‚é¢çš„çº¦æŸèƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°é˜²æ­¢éæ³•æ•°æ®çš„æ’å…¥æˆ–æ›´æ–°ã€‚

**ç¼ºç‚¹**ï¼š

- **æ€§èƒ½å¼€é”€**ï¼šå¤–é”®çº¦æŸä¼šå¢åŠ æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤æ“ä½œçš„å¼€é”€ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶ã€‚
- **è¿ç§»å’Œå¤åˆ¶çš„å¤æ‚æ€§**ï¼šåœ¨è¿›è¡Œæ•°æ®åº“è¿ç§»æˆ–å¤åˆ¶æ—¶ï¼Œå¤–é”®çº¦æŸå¯èƒ½ä¼šå¢åŠ å¤æ‚æ€§ï¼Œéœ€è¦å°å¿ƒå¤„ç†ã€‚
- **çµæ´»æ€§è¾ƒä½**ï¼šç‰©ç†å¤–é”®åœ¨æŸäº›å¤æ‚ä¸šåŠ¡é€»è¾‘ä¸‹å¯èƒ½ä¸å¤Ÿçµæ´»ï¼Œéœ€è¦æ›´å¤šçš„æ‰‹åŠ¨æ§åˆ¶ã€‚

### ã€ä¸­ç­‰ã€‘ä»€ä¹ˆæ˜¯å‰ç¼€ç´¢å¼•ï¼Ÿ

**â€œå‰ç¼€ç´¢å¼•â€æ˜¯æŒ‡ç´¢å¼•å¼€å§‹çš„éƒ¨åˆ†å­—ç¬¦**ã€‚å¯¹äº `BLOB`/`TEXT` è¿™ç§æ–‡æœ¬ç±»å‹çš„åˆ—ï¼Œå¿…é¡»ä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Œå› ä¸ºæ•°æ®åº“å¾€å¾€ä¸å…è®¸ç´¢å¼•è¿™äº›åˆ—çš„å®Œæ•´é•¿åº¦ã€‚

å‰ç¼€ç´¢å¼•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥**å¤§å¤§èŠ‚çº¦ç´¢å¼•ç©ºé—´**ï¼Œä»è€Œ**æé«˜ç´¢å¼•æ•ˆç‡**ã€‚

å‰ç¼€ç´¢å¼•çš„ç¼ºç‚¹æ˜¯**ä¼šé™ä½ç´¢å¼•çš„åŒºåˆ†åº¦**ã€‚æ­¤å¤–ï¼Œ**`order by` æ— æ³•ä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Œæ— æ³•æŠŠå‰ç¼€ç´¢å¼•ç”¨ä½œè¦†ç›–ç´¢å¼•**ã€‚

## å­—æ®µä¸ªæ•°ç´¢å¼•

### ã€ä¸­ç­‰ã€‘ä»€ä¹ˆæ˜¯ç´¢å¼•æœ€å·¦åŒ¹é…åŸåˆ™ï¼ŸğŸŒŸğŸŒŸğŸŒŸ

ä½¿ç”¨è”åˆç´¢å¼•æ—¶ï¼ŒæŸ¥è¯¢æ¡ä»¶å¿…é¡»ä»ç´¢å¼•çš„æœ€å·¦åˆ—å¼€å§‹åŒ¹é…ã€‚

å…¶åº•å±‚åŸç†æ˜¯ï¼ŒInnoDB çš„ç´¢å¼•é‡‡ç”¨ B+ æ ‘æ•°æ®ç»“æ„ï¼ŒæŒ‰å­—æ®µé¡ºåºå­˜å‚¨ã€‚å…¶å­˜å‚¨ç»“æ„ï¼Œå†³å®šäº†å…¶æŸ¥è¯¢æ—¶ï¼Œå¿…é¡»éµå¾ªä»å·¦åˆ°å³çš„é¡ºåºã€‚

å…·ä½“æ¥è¯´ï¼Œæœ€å·¦åŒ¹é…åŸåˆ™æœ‰ä»¥ä¸‹å‡ ä¸ªè¦ç‚¹ï¼š

> ä¸ºæ–¹ä¾¿ç›´è§‚çš„é˜è¿°ï¼Œè¿™é‡Œå‡è®¾æœ‰ä¸€å¼ è¡¨ tï¼Œè®¾ç½®äº†è”åˆç´¢å¼• `(a, b, c)`ã€‚

- **å¿…é¡»åŒ…å«æœ€å·¦åˆ—**ï¼šå¦‚æœæŸ¥è¯¢æ¡ä»¶ä¸­ä¸åŒ…å«æœ€å·¦åˆ—ï¼Œåˆ™è”åˆç´¢å¼•å¤±æ•ˆã€‚å³æŸ¥è¯¢æ¡ä»¶å¿…é¡»åŒ…å« `a` æ‰èƒ½ä½¿ç”¨ç´¢å¼•ã€‚
  - âœ… `WHERE a=1`ï¼ˆèƒ½ç”¨ç´¢å¼•ï¼‰ã€‚
  - âŒ `WHERE b=2`ï¼ˆä¸èƒ½ä½¿ç”¨ç´¢å¼•ï¼Œå› ä¸ºè·³è¿‡äº† `a`ï¼‰ã€‚
- **è¿ç»­åŒ¹é…**ï¼šä¸èƒ½è·³è¿‡ä¸­é—´åˆ—ï¼Œå¦åˆ™åé¢çš„åˆ—æ— æ³•ç´¢å¼•ã€‚
  - âœ… `WHERE a=1 AND b=2`ï¼ˆèƒ½ä½¿ç”¨ `a, b` ä¸¤åˆ—ç´¢å¼•ï¼‰ã€‚
  - âŒ `WHERE a=1 AND c=3`ï¼ˆåªèƒ½ç”¨åˆ° `a`ï¼Œ`c` æ— æ³•ç´¢å¼•ï¼Œå› ä¸ºè·³è¿‡äº† `b`ï¼‰ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒMySQL 5.6 æ”¯æŒäº†**ç´¢å¼•ä¸‹æ¨**ï¼ˆInnoDB å’Œ MyISAM æ”¯æŒï¼‰ï¼Œå…è®¸è¿™ç§æƒ…å†µä¸‹ï¼Œå°†åŒ¹é… a å­—æ®µçš„æ•°æ®æ¨é€åˆ°å¼•æ“å±‚ï¼Œç”±å¼•æ“å±‚åœ¨è¿™äº›æ•°æ®ä¸­è¿‡æ»¤å‡ºåŒ¹é… c å­—æ®µçš„æ•°æ®ï¼Œä»¥æ­¤æå‡æŸ¥è¯¢æ•ˆç‡ã€‚
- **é‡åˆ°èŒƒå›´æŸ¥è¯¢ï¼Œå³ä¾§å¤±æ•ˆ**ï¼š
  - é‡åˆ° `>`ã€`<`ã€å‰ç¼€ `LIKE`ï¼ˆ%xxï¼‰ ä¼šåœæ­¢åŒ¹é…
  - æ³¨æ„ï¼šè‹¥é‡åˆ° >=ã€<=ã€`BETWEEN`ã€åç¼€ `LIKE`ï¼ˆxx%ï¼‰è¿™ç§èŒƒå›´æŸ¥è¯¢ï¼Œä¸ä¼šåœæ­¢åŒ¹é…ï¼Œå› ä¸ºè¿™äº›æŸ¥è¯¢åŒ…å«ä¸€ä¸ªç­‰å€¼åˆ¤æ–­ï¼Œå¯ä»¥ç›´æ¥å®šä½åˆ°æŸä¸ªæ•°æ®ï¼Œå‘åæ‰«æ

**æœ€å·¦å‰ç¼€åŒ¹é…å‘½ä¸­ç¤ºä¾‹**

å‡è®¾æœ‰ç´¢å¼• `(name, age, city)`ï¼š

```sql
âœ… WHERE name='Alice' AND age=25 AND city='Beijing'  -- å®Œæ•´ä½¿ç”¨ç´¢å¼•
âœ… WHERE name='Alice' AND age=25                     -- ä½¿ç”¨ name å’Œ age
âœ… WHERE name='Alice'                               -- ä»…ä½¿ç”¨ name
âŒ WHERE age=25 AND city='Beijing'                  -- è·³è¿‡äº† nameï¼Œæ— æ³•ä½¿ç”¨ç´¢å¼•
âŒ WHERE name='Alice' AND city='Beijing'            -- åªèƒ½ç”¨åˆ° nameï¼Œè·³è¿‡äº† ageï¼Œä½†å¯ä»¥åº”ç”¨ç´¢å¼•ä¸‹æ¨
```

ç»¼ä¸Šï¼Œä¼˜åŒ– SQL æ—¶ï¼Œåº”å°½é‡è®©æŸ¥è¯¢æ¡ä»¶ç¬¦åˆæœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™ï¼Œä»¥æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚

### ã€ä¸­ç­‰ã€‘ä»€ä¹ˆæ˜¯ç´¢å¼•ä¸‹æ¨ï¼ŸğŸŒŸğŸŒŸ

ç´¢å¼•ä¸‹æ¨æ˜¯ä¸€ç§å‡å°‘å›è¡¨æŸ¥è¯¢ã€æé«˜æŸ¥è¯¢æ•ˆç‡çš„æŠ€æœ¯ã€‚ç´¢å¼•ä¸‹æ¨ä¸»è¦åº”ç”¨äºè”åˆç´¢å¼•ã€‚

å®ƒå…è®¸ MySQL åœ¨ä½¿ç”¨ç´¢å¼•æŸ¥æ‰¾æ•°æ®æ—¶ï¼Œå°†éƒ¨åˆ†æŸ¥è¯¢æ¡ä»¶ä¸‹æ¨åˆ°å­˜å‚¨å¼•æ“å±‚è¿›è¡Œè¿‡æ»¤ï¼Œä»è€Œå‡å°‘éœ€è¦ä»è¡¨ä¸­è¯»å–çš„æ•°æ®è¡Œï¼Œå‡å°‘ IO æ“ä½œã€‚

ç´¢å¼•ä¸‹æ¨æ³¨æ„ç‚¹ï¼š

- MySQL 5.6 åŠä»¥åç‰ˆæœ¬æ”¯æŒç´¢å¼•ä¸‹æ¨ï¼Œé€‚ç”¨äº InnoDB å’Œ MyISAM å­˜å‚¨å¼•æ“ã€‚
- ç»¼ä¸Šï¼ŒåŒ…å«å­æŸ¥è¯¢ï¼Œç´¢å¼•ä¸‹æ¨å¯èƒ½ä¸ä¼šç”Ÿæ•ˆã€‚
- ä½¿ç”¨å‡½æ•°æˆ–è¡¨è¾¾å¼æ—¶ï¼Œç´¢å¼•ä¸‹æ¨ä¸ä¼šç”Ÿæ•ˆã€‚
- ä½¿ç”¨èšç°‡ç´¢å¼•ï¼ˆä¸»é”®ï¼‰æŸ¥è¯¢æ—¶ï¼Œç´¢å¼•ä¸‹æ¨ä¸ä¼šç”Ÿæ•ˆï¼Œå› ä¸ºå®ƒä¸»è¦é’ˆå¯¹éèšç°‡ç´¢å¼•ã€‚

> æ‰©å±•é˜…è¯»ï¼šhttps://zhuanlan.zhihu.com/p/121084592

## å‚è€ƒèµ„æ–™

- [ã€Šé«˜æ€§èƒ½ MySQLã€‹](https://book.douban.com/subject/23008813/)
- [æå®¢æ—¶é—´æ•™ç¨‹ - MySQL å®æˆ˜ 45 è®²](https://time.geekbang.org/column/intro/139)
- [å›¾è§£ MySQL ä»‹ç»](https://xiaolincoding.com/mysql/)