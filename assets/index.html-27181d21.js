import{_ as r}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as l,c as i,a as e,b as n,d as a,e as t}from"./app-3113b888.js";const c={},p=t('<h1 id="elasticsearch-文本分析" tabindex="-1"><a class="header-anchor" href="#elasticsearch-文本分析" aria-hidden="true">#</a> Elasticsearch 文本分析</h1><div class="hint-container info"><p class="hint-container-title">概述</p><p>Elasticsearch 中存储的数据可以粗略分为：</p><ul><li><strong>词项数据</strong> - 采用<strong>精确查询</strong>。比较两条词项数据是否相对，实际是比较二者的二进制数据，结果只有相等或不相等。</li><li><strong>文本数据</strong> - 采用<strong>全文搜索</strong>。比较两个文本数据是否相等，没有太大意义，一般只会比较二者是否相似。相似性比较，是通过相关性评分来评估的。而计算相关性评分，需要对全文先分词处理，然后对分词后的词项进行统计才能进行相似性评估。</li></ul><p><strong>Elasticsearch 文本分析是将非结构化文本转换为一组词项（term）的过程</strong>。本文将介绍 Elasticsearch 文本分析的各个关键组件，以及文本分析的处理流程。</p></div><h2 id="文本分析简介" tabindex="-1"><a class="header-anchor" href="#文本分析简介" aria-hidden="true">#</a> 文本分析简介</h2><p>Elasticsearch 需要先对文本数据进行文本分析，将原文本分词处理，然后对分词后的词项进行统计才能进行相似性评估。有了相似性计算分值，才能进行相似性匹配。由此可见，文本分析是全文搜索的基础。</p><p>文本分析可以分为两个方面：</p><ul><li><strong>Tokenization（分词化）</strong> - 分词化将文本分解成更小的块，称为分词。在大多数情况下，这些分词是单独的 term（词项）。</li><li><strong>Normalization（标准化）</strong> - 经过分词后的文本只能进行词项匹配，但是无法进行同义词匹配。为解决这个问题，可以将文本进行标准化处理。例如：将 <code>foxes</code> 标准化为 <code>fox</code>。</li></ul><h2 id="analyzer-分析器" tabindex="-1"><a class="header-anchor" href="#analyzer-分析器" aria-hidden="true">#</a> Analyzer（分析器）</h2>',7),u={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analyzer-anatomy.html",target:"_blank",rel:"noopener noreferrer"},d=e("strong",null,"analyzer（分析器）",-1),h={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analyzer-anatomy.html",target:"_blank",rel:"noopener noreferrer"},k=e("strong",null,"analyzer（分析器）",-1),_={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-charfilters.html",target:"_blank",rel:"noopener noreferrer"},m={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-tokenizers.html",target:"_blank",rel:"noopener noreferrer"},v={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-tokenfilters.html",target:"_blank",rel:"noopener noreferrer"},g=e("code",null,"character filters -> tokenizer -> token filters",-1),f=e("figure",null,[e("img",{src:"https://raw.githubusercontent.com/dunwu/images/master/snap/202412012129250.png",alt:"",tabindex:"0",loading:"lazy"}),e("figcaption")],-1),b=e("p",null,"Elasticsearch 内置的分析器：",-1),y={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-standard-analyzer.html",target:"_blank",rel:"noopener noreferrer"},w=e("code",null,"standard",-1),q={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-simple-analyzer.html",target:"_blank",rel:"noopener noreferrer"},z=e("code",null,"simple",-1),x={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-whitespace-analyzer.html",target:"_blank",rel:"noopener noreferrer"},j=e("code",null,"whitespace",-1),E={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-stop-analyzer.html",target:"_blank",rel:"noopener noreferrer"},T=e("code",null,"stop",-1),U={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-simple-analyzer.html",target:"_blank",rel:"noopener noreferrer"},F=e("code",null,"simple",-1),C={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-keyword-analyzer.html",target:"_blank",rel:"noopener noreferrer"},G=e("code",null,"keyword",-1),P={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-pattern-analyzer.html",target:"_blank",rel:"noopener noreferrer"},Q=e("code",null,"pattern",-1),L={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-fingerprint-analyzer.html",target:"_blank",rel:"noopener noreferrer"},N=e("code",null,"fingerprint",-1),I={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-lang-analyzer.html",target:"_blank",rel:"noopener noreferrer"},V={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-standard-analyzer.html",target:"_blank",rel:"noopener noreferrer"},B=e("strong",null,"standard analyzer（标准分析器）",-1),S=e("h3",{id:"测试分析器",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#测试分析器","aria-hidden":"true"},"#"),n(" 测试分析器")],-1),A={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-analyze.html",target:"_blank",rel:"noopener noreferrer"},H=e("code",null,"_analyze",-1),M=t(`<details class="hint-container details"><summary>【示例】直接指定 analyzer 进行测试</summary><p>查看不同的 analyzer 的效果</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>GET _analyze
<span class="token punctuation">{</span>
  <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2 running Quick brown-foxes leap over lazy dogs in the summer evening.&quot;</span>
<span class="token punctuation">}</span>

GET _analyze
<span class="token punctuation">{</span>
  <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;simple&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2 running Quick brown-foxes leap over lazy dogs in the summer evening.&quot;</span>
<span class="token punctuation">}</span>

GET _analyze
<span class="token punctuation">{</span>
  <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;stop&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2 running Quick brown-foxes leap over lazy dogs in the summer evening.&quot;</span>
<span class="token punctuation">}</span>

GET _analyze
<span class="token punctuation">{</span>
  <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;whitespace&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2 running Quick brown-foxes leap over lazy dogs in the summer evening.&quot;</span>
<span class="token punctuation">}</span>

GET _analyze
<span class="token punctuation">{</span>
  <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2 running Quick brown-foxes leap over lazy dogs in the summer evening.&quot;</span>
<span class="token punctuation">}</span>

GET _analyze
<span class="token punctuation">{</span>
  <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pattern&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2 running Quick brown-foxes leap over lazy dogs in the summer evening.&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><details class="hint-container details"><summary>【示例】自由组合分析器组件进行测试</summary><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>POST _analyze
<span class="token punctuation">{</span>
  <span class="token property">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span>  <span class="token punctuation">[</span> <span class="token string">&quot;lowercase&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;asciifolding&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;text&quot;</span><span class="token operator">:</span>      <span class="token string">&quot;Is this déja vu?&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h3 id="指定分析器" tabindex="-1"><a class="header-anchor" href="#指定分析器" aria-hidden="true">#</a> 指定分析器</h3><p>内置分析器可以直接使用，无需任何配置。但是，其中一些支持配置选项来更改其行为。</p><p>在搜索时，Elasticsearch 通过按顺序检查以下参数来确定要使用的分析器：</p>`,5),O={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analyzer.html",target:"_blank",rel:"noopener noreferrer"},R=e("code",null,"analyzer",-1),D={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/specify-analyzer.html#specify-search-query-analyzer",target:"_blank",rel:"noopener noreferrer"},J={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/search-analyzer.html",target:"_blank",rel:"noopener noreferrer"},K=e("code",null,"search_analyzer",-1),W={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/specify-analyzer.html#specify-search-field-analyzer",target:"_blank",rel:"noopener noreferrer"},X=e("code",null,"analysis.analyzer.default_search",-1),Y={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/specify-analyzer.html#specify-search-default-analyzer",target:"_blank",rel:"noopener noreferrer"},Z={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analyzer.html",target:"_blank",rel:"noopener noreferrer"},$=e("code",null,"analyzer",-1),ee={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/specify-analyzer.html#specify-index-field-analyzer",target:"_blank",rel:"noopener noreferrer"},ne={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-standard-analyzer.html",target:"_blank",rel:"noopener noreferrer"},se=e("code",null,"standard",-1),ae=t(`<details class="hint-container details"><summary>【示例】设置索引的默认分析器</summary><p>将 std_english 分析器定义为基于标准分析器，但配置为删除预定义的英语停用词列表</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>PUT my-index<span class="token number">-000001</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;analysis&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;std_english&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span>      <span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;stopwords&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_english_&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;my_text&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span>     <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;fields&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;english&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span>     <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;std_english&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><details class="hint-container details"><summary>【示例】设置字段的分析器</summary><p>将字段 title 的分析器设为 <code>whitespace</code>：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>PUT my-index<span class="token number">-000001</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;whitespace&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><details class="hint-container details"><summary>【示例】指定查询的搜索分析器</summary><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>GET my-index<span class="token number">-000001</span>/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Quick foxes&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;stop&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><details class="hint-container details"><summary>【示例】指定字段的搜索分析器</summary><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>PUT my-index<span class="token number">-000001</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;whitespace&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;search_analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;simple&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><details class="hint-container details"><summary>【示例】指定索引的默认搜索分析器</summary><p>创建索引时，可以使用该 <code>analysis.analyzer.default_search</code> 设置设置默认搜索分析器。如果提供了搜索分析器，则还必须使用 <code>analysis.analyzer.default</code> 设置指定默认索引分析器。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>PUT my-index<span class="token number">-000001</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;analysis&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;default&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;simple&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;default_search&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;whitespace&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h3 id="自定义分析器" tabindex="-1"><a class="header-anchor" href="#自定义分析器" aria-hidden="true">#</a> 自定义分析器</h3><p>自定义分析器，需要指定 type 为 <code>custom</code> 类型。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>PUT my-index<span class="token number">-000001</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;analysis&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;my_custom_analyzer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;custom&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;char_filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;html_strip&quot;</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;lowercase&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;asciifolding&quot;</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="character-filters-字符过滤器" tabindex="-1"><a class="header-anchor" href="#character-filters-字符过滤器" aria-hidden="true">#</a> Character Filters（字符过滤器）</h2>`,9),te={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-charfilters.html",target:"_blank",rel:"noopener noreferrer"},re=e("strong",null,"零个或多个",-1),oe={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-charfilters.html",target:"_blank",rel:"noopener noreferrer"},le=e("p",null,"Elasticsearch 内置的字符过滤器：",-1),ie={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-htmlstrip-charfilter.html",target:"_blank",rel:"noopener noreferrer"},ce=e("code",null,"html_strip",-1),pe=e("code",null,"html_strip",-1),ue=e("code",null,"<b>",-1),de=e("code",null,"&amp;",-1),he={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-mapping-charfilter.html",target:"_blank",rel:"noopener noreferrer"},ke=e("code",null,"mapping",-1),_e=e("code",null,"mapping",-1),me={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-pattern-replace-charfilter.html",target:"_blank",rel:"noopener noreferrer"},ve=e("code",null,"pattern_replace",-1),ge=e("code",null,"pattern_replace",-1),fe=e("h2",{id:"tokenizer-分词器",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#tokenizer-分词器","aria-hidden":"true"},"#"),n(" Tokenizer（分词器）")],-1),be={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-tokenizers.html",target:"_blank",rel:"noopener noreferrer"},ye=e("strong",null,"有且仅有一个",-1),we={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-tokenizers.html",target:"_blank",rel:"noopener noreferrer"},qe=e("p",null,"Elasticsearch 内置的分词器：",-1),ze={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-standard-tokenizer.html",target:"_blank",rel:"noopener noreferrer"},xe=e("code",null,"standard",-1),je={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-letter-tokenizer.html",target:"_blank",rel:"noopener noreferrer"},Ee=e("code",null,"letter",-1),Te={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-lowercase-tokenizer.html",target:"_blank",rel:"noopener noreferrer"},Ue=e("code",null,"lowercase",-1),Fe={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-whitespace-tokenizer.html",target:"_blank",rel:"noopener noreferrer"},Ce=e("code",null,"whitespace",-1),Ge={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-uaxurlemail-tokenizer.html",target:"_blank",rel:"noopener noreferrer"},Pe=e("code",null,"uax_url_email",-1),Qe={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-standard-tokenizer.html",target:"_blank",rel:"noopener noreferrer"},Le=e("code",null,"standard",-1),Ne={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-classic-tokenizer.html",target:"_blank",rel:"noopener noreferrer"},Ie=e("code",null,"classic",-1),Ve={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-thai-tokenizer.html",target:"_blank",rel:"noopener noreferrer"},Be=e("code",null,"thai",-1),Se={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-ngram-tokenizer.html",target:"_blank",rel:"noopener noreferrer"},Ae=e("code",null,"n-gram",-1),He=e("code",null,"quick",-1),Me=e("code",null,"[qu， ui， ic， ck]",-1),Oe={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-edgengram-tokenizer.html",target:"_blank",rel:"noopener noreferrer"},Re=e("code",null,"edge_n-gram",-1),De=e("code",null,"quick",-1),Je=e("code",null,"[q， qu， qui， quic， quick]",-1),Ke={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-keyword-tokenizer.html",target:"_blank",rel:"noopener noreferrer"},We=e("code",null,"keyword",-1),Xe={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-lowercase-tokenfilter.html",target:"_blank",rel:"noopener noreferrer"},Ye=e("code",null,"lowercase",-1),Ze={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-pattern-tokenizer.html",target:"_blank",rel:"noopener noreferrer"},$e=e("code",null,"pattern",-1),en={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-simplepattern-tokenizer.html",target:"_blank",rel:"noopener noreferrer"},nn=e("code",null,"simple_pattern",-1),sn={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-pattern-tokenizer.html",target:"_blank",rel:"noopener noreferrer"},an=e("code",null,"pattern",-1),tn={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-chargroup-tokenizer.html",target:"_blank",rel:"noopener noreferrer"},rn=e("code",null,"char_group",-1),on={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-simplepatternsplit-tokenizer.html",target:"_blank",rel:"noopener noreferrer"},ln=e("code",null,"simple_pattern_split",-1),cn={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-simplepattern-tokenizer.html",target:"_blank",rel:"noopener noreferrer"},pn=e("code",null,"simple_pattern",-1),un={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-pathhierarchy-tokenizer.html",target:"_blank",rel:"noopener noreferrer"},dn=e("code",null,"path_hierarchy",-1),hn=e("code",null,"/foo/bar/baz",-1),kn=e("code",null,"[/foo, /foo/bar, /foo/bar/baz ]",-1),_n=e("h2",{id:"token-filters-分词过滤器",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#token-filters-分词过滤器","aria-hidden":"true"},"#"),n(" Token Filters（分词过滤器）")],-1),mn={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-tokenfilters.html",target:"_blank",rel:"noopener noreferrer"},vn={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-lowercase-tokenfilter.html",target:"_blank",rel:"noopener noreferrer"},gn=e("code",null,"lowercase",-1),fn={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-stop-tokenfilter.html",target:"_blank",rel:"noopener noreferrer"},bn=e("code",null,"stop",-1),yn={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-synonym-tokenfilter.html",target:"_blank",rel:"noopener noreferrer"},wn=e("code",null,"synonym",-1),qn={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-tokenfilters.html",target:"_blank",rel:"noopener noreferrer"},zn=e("p",null,"Elasticsearch 内置了很多分词过滤器，这里列举几个常见的：",-1),xn={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-classic-tokenfilter.html",target:"_blank",rel:"noopener noreferrer"},jn=e("code",null,"classic",-1),En=e("code",null,"'s",-1),Tn={href:"https://lucene.apache.org/core/9_12_0/analysis/common/org/apache/lucene/analysis/standard/ClassicFilter.html",target:"_blank",rel:"noopener noreferrer"},Un={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-lowercase-tokenfilter.html",target:"_blank",rel:"noopener noreferrer"},Fn=e("code",null,"lowercase",-1),Cn={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-stop-tokenfilter.html",target:"_blank",rel:"noopener noreferrer"},Gn=e("code",null,"stop",-1),Pn={href:"https://en.wikipedia.org/wiki/Stop_word",target:"_blank",rel:"noopener noreferrer"},Qn={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-synonym-tokenfilter.html",target:"_blank",rel:"noopener noreferrer"},Ln=e("code",null,"synonym",-1),Nn={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/search-with-synonyms.html",target:"_blank",rel:"noopener noreferrer"},In=e("h2",{id:"中文分词",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#中文分词","aria-hidden":"true"},"#"),n(" 中文分词")],-1),Vn=e("p",null,"在英文中，单词有自然的空格作为分隔。",-1),Bn=e("p",null,"在中文中，分词有以下难点：",-1),Sn=e("ul",null,[e("li",null,"中文不能根据一个个汉字进行分词"),e("li",null,"不同于英文可以根据自然的空格进行分词；中文中一般不会有空格。"),e("li",null,"同一句话，在不同的上下文中，有不同个理解。例如：这个苹果，不大好吃；这个苹果，不大，好吃！")],-1),An=e("p",null,"可以使用一些插件来获得对中文更好的分析能力：",-1),Hn={href:"https://www.elastic.co/guide/en/elasticsearch/plugins/current/analysis-icu.html",target:"_blank",rel:"noopener noreferrer"},Mn={href:"https://github.com/infinilabs/analysis-ik",target:"_blank",rel:"noopener noreferrer"},On={href:"https://github.com/microbun/elasticsearch-thulac-plugin",target:"_blank",rel:"noopener noreferrer"},Rn=e("h2",{id:"参考资料",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#参考资料","aria-hidden":"true"},"#"),n(" 参考资料")],-1),Dn={href:"https://time.geekbang.org/course/detail/100030501-102659",target:"_blank",rel:"noopener noreferrer"},Jn={href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis.html",target:"_blank",rel:"noopener noreferrer"},Kn={href:"https://www.itshujia.com/read/elasticsearch/356.html",target:"_blank",rel:"noopener noreferrer"};function Wn(Xn,Yn){const s=o("ExternalLinkIcon");return l(),i("div",null,[p,e("p",null,[n("文本分析由 "),e("a",u,[d,a(s)]),n(" 执行，分析器是一组控制整个过程的规则。在 Elasticsearch 中，无论读写，都需要使用分析器。")]),e("p",null,[e("a",h,[k,a(s)]),n(" 由三个组件组成：零个或多个 "),e("a",_,[n("Character Filters（字符过滤器）"),a(s)]),n("、有且仅有一个 "),e("a",m,[n("Tokenizer（分词器）"),a(s)]),n("、零个或多个 "),e("a",v,[n("Token Filters（分词过滤器）"),a(s)]),n("。分析的执行顺序为："),g,n("。")]),f,b,e("ul",null,[e("li",null,[e("a",y,[w,a(s)]),n(" - 根据单词边界将文本划分为多个 term，如 Unicode 文本分割算法所定义。它删除了大多数标点符号、小写 term，并支持删除停用词。")]),e("li",null,[e("a",q,[z,a(s)]),n(" - 遇到非字母字符时将文本划分为多个 term，并将其转为小写。")]),e("li",null,[e("a",x,[j,a(s)]),n(" - 遇到任何空格时将文本划分为多个 term，不转换为小写。")]),e("li",null,[e("a",E,[T,a(s)]),n(" - 与 "),e("a",U,[F,a(s)]),n(" 相似，同时支持删除停用词（如：the、a、is）。")]),e("li",null,[e("a",C,[G,a(s)]),n(" - 部分词，直接将输入当做输出。")]),e("li",null,[e("a",P,[Q,a(s)]),n(" - 使用正则表达式将文本拆分为 term。它支持小写和非索引字。")]),e("li",null,[e("a",L,[N,a(s)]),n(" - 可创建用于重复检测的指纹。")]),e("li",null,[e("a",I,[n("语言分析器"),a(s)]),n(" - 提供了 30 多种常见语言的分词器。")])]),e("p",null,[n("默认情况下，Elasticsearch 使用 "),e("a",V,[B,a(s)]),n("，它开箱即用，适用于大多数使用场景。Elasticsearch 也允许定制分析器。")]),S,e("p",null,[e("a",A,[H,n(" API"),a(s)]),n(" 是查看分析器如何分词的工具。")]),M,e("ol",null,[e("li",null,[n("搜索查询中的 "),e("a",O,[R,a(s)]),n(" 参数。请参阅 "),e("a",D,[n("指定查询的搜索分析器"),a(s)]),n("。")]),e("li",null,[n("字段的 "),e("a",J,[K,a(s)]),n(" 映射参数。请参阅 "),e("a",W,[n("为字段指定搜索分析器"),a(s)]),n("。")]),e("li",null,[X,n(" 索引设置。请参阅 "),e("a",Y,[n("指定索引的默认搜索分析器"),a(s)]),n("。")]),e("li",null,[n("字段的 "),e("a",Z,[$,a(s)]),n(" mapping 参数。请参阅 "),e("a",ee,[n("为字段指定分析器"),a(s)]),n("。")])]),e("p",null,[n("如果未指定这些参数，则使用 "),e("a",ne,[se,a(s)]),n(" 分析器。")]),ae,e("p",null,[e("a",te,[n("Character Filters（字符过滤器）"),a(s)]),n(" 将原始文本作为字符流接收，并可以通过添加、删除或更改字符来转换文本。分析器可以有"),re,n(),e("a",oe,[n("Character Filters（字符过滤器）"),a(s)]),n("，如果配置了多个，它会按照配置的顺序执行。")]),le,e("ul",null,[e("li",null,[e("a",ie,[ce,a(s)]),n(" - "),pe,n("字符过滤器用于去除 HTML 元素（如 "),ue,n("）并转义 HTML 实体（如 "),de,n("）。")]),e("li",null,[e("a",he,[ke,a(s)]),n(" - "),_e,n(" 字符过滤器用于将指定字符串的任何匹配项替换为指定的替换项。")]),e("li",null,[e("a",me,[ve,a(s)]),n(" - "),ge,n(" 字符筛选器将匹配正则表达式的任何字符替换为指定的替换。")])]),fe,e("p",null,[e("a",be,[n("Tokenizer（分词器）"),a(s)]),n(" 接收字符流，将其分解为分词（通常是单个单词），并输出一个分词流。分词器还负责记录每个 term 的顺序或位置，以及该 term 所代表的原始单词的开始和结束字符偏移量。分析器"),ye,n(),e("a",we,[n("Tokenizer（分词器）"),a(s)]),n("。")]),qe,e("ul",null,[e("li",null,[n("面向单词的分词器 "),e("ul",null,[e("li",null,[e("a",ze,[xe,a(s)]),n(" - 将文本划分为单词边界上的 term，如 Unicode 文本分割算法所定义。它会删除大多数标点符号。它是大多数语言的最佳选择。")]),e("li",null,[e("a",je,[Ee,a(s)]),n(" - 遇到非字母字符时将文本划分为多个 term。")]),e("li",null,[e("a",Te,[Ue,a(s)]),n(" - 到非字母字符时将文本划分为多个 term，并将其转为小写。")]),e("li",null,[e("a",Fe,[Ce,a(s)]),n(" - 遇到任何空格时将文本划分为多个 term。")]),e("li",null,[e("a",Ge,[Pe,a(s)]),n(" - 与 "),e("a",Qe,[Le,a(s)]),n(" 相似，不同之处在于它将 URL 和电子邮件地址识别为单个分词。")]),e("li",null,[e("a",Ne,[Ie,a(s)]),n(" - 基于语法的英语分词器。")]),e("li",null,[e("a",Ve,[Be,a(s)]),n(" - 将泰语文本分割为单词。")])])]),e("li",null,[n("部分单词分词器 "),e("ul",null,[e("li",null,[e("a",Se,[Ae,a(s)]),n(" - 遇到指定字符列表（例如空格或标点符号）中的任何一个时，将文本分解为单词，然后返回每个单词的 n-gram：一个连续字母的滑动窗口，例如 "),He,n("→ "),Me,n("。")]),e("li",null,[e("a",Oe,[Re,a(s)]),n(" - 遇到指定字符列表（例如空格或标点符号）中的任何一个时，将文本分解为单词，然后返回锚定到单词开头的每个单词的 n 元语法，例如 "),De,n(" → "),Je,n("。")])])]),e("li",null,[n("结构化文本分词器 "),e("ul",null,[e("li",null,[e("a",Ke,[We,a(s)]),n(" - 接受给定的任何文本，并输出与单个 term 完全相同的文本。它可以与 "),e("a",Xe,[Ye,a(s)]),n(" 等分词过滤器结合使用，以规范化分析的 term。")]),e("li",null,[e("a",Ze,[$e,a(s)]),n(" - 使用正则表达式在文本与单词分隔符匹配时将文本拆分为 term，或者将匹配的文本捕获为 term。")]),e("li",null,[e("a",en,[nn,a(s)]),n(" - 使用正则表达式将匹配的文本捕获为 term。它使用正则表达式特征的受限子集，并且通常比 "),e("a",sn,[an,a(s)]),n(" 更快。")]),e("li",null,[e("a",tn,[rn,a(s)]),n(" - 可以通过要拆分的字符集进行配置，这通常比运行正则表达式代价更小。")]),e("li",null,[e("a",on,[ln,a(s)]),n(" - 使用与 "),e("a",cn,[pn,a(s)]),n(" 分词器相同的受限正则表达式子集，但在匹配项处拆分输入，而不是将匹配项作为 term 返回。")]),e("li",null,[e("a",un,[dn,a(s)]),n(" - 基于文件系统的路径分隔符，进行拆分，例如 "),hn,n(" → "),kn,n(" 。")])])])]),_n,e("p",null,[e("a",mn,[n("Token Filters（分词过滤器）"),a(s)]),n(" 接收分词流，并可以添加、删除或更改分词。常用的分词过滤器有： "),e("a",vn,[gn,n("（小写转换）"),a(s)]),n("、"),e("a",fn,[bn,n("（停用词处理）"),a(s)]),n("、"),e("a",yn,[wn,n("（同义词处理）"),a(s)]),n(" 等等。分析器可以有零个或多个 "),e("a",qn,[n("Token Filters（分词过滤器）"),a(s)]),n("，如果配置了多个，它会按照配置的顺序执行。")]),zn,e("ul",null,[e("li",null,[e("a",xn,[jn,a(s)]),n(" - 从单词末尾删除英语所有格 （"),En,n("），并删除首字母缩略词中的点。它使用 Lucene 的 "),e("a",Tn,[n("ClassicFilter"),a(s)]),n("。")]),e("li",null,[e("a",Un,[Fn,a(s)]),n(" - 将分词转为小写。")]),e("li",null,[e("a",Cn,[Gn,a(s)]),n(" - 从分词中删除 "),e("a",Pn,[n("stop word（停用词）"),a(s)]),n("。")]),e("li",null,[e("a",Qn,[Ln,a(s)]),n(" - 允许在分析过程中轻松处理 "),e("a",Nn,[n("近义词"),a(s)]),n("。")])]),In,Vn,Bn,Sn,An,e("ul",null,[e("li",null,[e("a",Hn,[n("analysis-icu"),a(s)]),n(" - 添加了扩展的 Unicode 支持，包括更好地分析亚洲语言、Unicode 规范化、Unicode 感知大小写折叠、排序规则支持和音译。")]),e("li",null,[e("a",Mn,[n("elasticsearch-analysis-ik"),a(s)]),n(" - 支持自定义词库，支持热更新分词字典")]),e("li",null,[e("a",On,[n("elasticsearch-thulac-plugin"),a(s)]),n(" - 清华大学自然语言处理和社会人文计算实验室的一套中文分词器。")])]),Rn,e("ul",null,[e("li",null,[e("a",Dn,[n("极客时间教程 - Elasticsearch 核心技术与实战"),a(s)])]),e("li",null,[e("a",Jn,[n("Elasticsearch 官方文档之文本分析"),a(s)])]),e("li",null,[e("a",Kn,[n("Elasticsearch 从入门到实践之分词器"),a(s)])])])])}const es=r(c,[["render",Wn],["__file","index.html.vue"]]);export{es as default};
