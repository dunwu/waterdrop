import{_ as c}from"./plugin-vue_export-helper-c27b6911.js";import{r as p,o as d,c as u,a as n,b as s,d as a,w as t,e as o}from"./app-1c9286fd.js";const g={},k=o(`<h1 id="mysql-é¢è¯•" tabindex="-1"><a class="header-anchor" href="#mysql-é¢è¯•" aria-hidden="true">#</a> MySQL é¢è¯•</h1><h2 id="å…³ç³»æ•°æ®åº“ç»¼åˆ" tabindex="-1"><a class="header-anchor" href="#å…³ç³»æ•°æ®åº“ç»¼åˆ" aria-hidden="true">#</a> å…³ç³»æ•°æ®åº“ç»¼åˆ</h2><h3 id="ã€ç®€å•ã€‘ä»€ä¹ˆæ˜¯èŒƒå¼-ä»€ä¹ˆæ˜¯åèŒƒå¼" tabindex="-1"><a class="header-anchor" href="#ã€ç®€å•ã€‘ä»€ä¹ˆæ˜¯èŒƒå¼-ä»€ä¹ˆæ˜¯åèŒƒå¼" aria-hidden="true">#</a> ã€ç®€å•ã€‘ä»€ä¹ˆæ˜¯èŒƒå¼ï¼Ÿä»€ä¹ˆæ˜¯åèŒƒå¼ï¼Ÿ</h3><p>æ•°æ®åº“è§„èŒƒåŒ–ï¼Œåˆç§°â€œ<strong>èŒƒå¼</strong>â€ï¼Œæ˜¯æ•°æ®åº“è®¾è®¡çš„æŒ‡å¯¼ç†è®ºã€‚<strong>èŒƒå¼çš„ç›®æ ‡æ˜¯ï¼šä½¿æ•°æ®åº“ç»“æ„æ›´åˆç†ï¼Œæ¶ˆé™¤å­˜å‚¨å¼‚å¸¸ï¼Œä½¿æ•°æ®å†—ä½™å°½é‡å°ï¼Œå¢è¿›æ•°æ®çš„ä¸€è‡´æ€§</strong>ã€‚</p><p>æ ¹æ®çº¦æŸç¨‹åº¦ä»ä½åˆ°é«˜æœ‰ï¼šç¬¬ä¸€èŒƒå¼ï¼ˆ1NFï¼‰ã€ç¬¬äºŒèŒƒå¼ï¼ˆ2NFï¼‰ã€ç¬¬ä¸‰èŒƒå¼ï¼ˆ3NFï¼‰ã€å·´æ–¯-ç§‘å¾·èŒƒå¼ï¼ˆBCNFï¼‰ç­‰ç­‰ã€‚</p><figure><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/202410022024207.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>1NF è¦æ±‚<strong>æ‰€æœ‰å±æ€§éƒ½ä¸å¯å†åˆ†è§£</strong>ã€‚</li><li>2NF è¦æ±‚<strong>ä¸å­˜åœ¨éƒ¨åˆ†ä¾èµ–</strong>ã€‚</li><li>3NF è¦æ±‚<strong>ä¸å­˜åœ¨ä¼ é€’ä¾èµ–</strong>ã€‚</li></ul><p>åèŒƒå¼ï¼Œé¡¾åæ€ä¹‰ï¼Œä¸èŒƒå¼çš„ç›®æ ‡æ­£å¥½ç›¸åã€‚<strong>èŒƒå¼</strong>çš„ç›®æ ‡æ˜¯<strong>æ¶ˆé™¤å†—ä½™</strong>ï¼›<strong>åèŒƒå¼</strong>çš„ç›®æ ‡æ˜¯<strong>å†—ä½™ä»¥æé«˜æŸ¥è¯¢æ•ˆç‡</strong>ã€‚</p><p>èŒƒå¼å¹¶éè¶Šä¸¥æ ¼è¶Šå¥½ï¼Œç°ä»£æ•°æ®åº“è®¾è®¡ï¼Œä¸€èˆ¬æœ€å¤šæ»¡è¶³ 3NFã€‚èŒƒå¼è¶Šé«˜æ„å‘³ç€è¡¨çš„åˆ’åˆ†æ›´ç»†ï¼Œä¸€ä¸ªæ•°æ®åº“ä¸­éœ€è¦çš„è¡¨ä¹Ÿå°±è¶Šå¤šï¼Œç”¨æˆ·ä¸å¾—ä¸å°†åŸæœ¬ç›¸å…³è”çš„æ•°æ®åˆ†æ‘Šåˆ°å¤šä¸ªè¡¨ä¸­ã€‚å½“ç”¨æˆ·åŒæ—¶éœ€è¦è¿™äº›æ•°æ®æ—¶åªèƒ½é€šè¿‡å…³è”è¡¨çš„å½¢å¼å°†æ•°æ®é‡æ–°åˆå¹¶åœ¨ä¸€èµ·ã€‚åŒæ—¶æŠŠå¤šä¸ªè¡¨è”æ¥åœ¨ä¸€èµ·çš„èŠ±è´¹æ˜¯å·¨å¤§çš„ï¼Œå°¤å…¶æ˜¯å½“éœ€è¦è¿æ¥çš„ä¸¤å¼ æˆ–è€…å¤šå¼ è¡¨æ•°æ®éå¸¸åºå¤§çš„æ—¶å€™ï¼Œè¡¨è¿æ¥æ“ä½œå‡ ä¹æ˜¯ä¸€ä¸ªå™©æ¢¦ï¼Œè¿™ä¸¥é‡åœ°é™ä½äº†ç³»ç»Ÿè¿è¡Œæ€§èƒ½ã€‚å› æ­¤ï¼Œ<strong>æœ‰æ—¶ä¸ºäº†æé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œæœ‰å¿…è¦é€‚å½“çš„å†—ä½™æ•°æ®ï¼Œä»¥è¾¾åˆ°ç©ºé—´æ¢æ—¶é—´çš„ç›®çš„â€”â€”è¿™å°±æ˜¯â€œåèŒƒå¼â€</strong>ã€‚</p><h4 id="ç¬¬ä¸€èŒƒå¼-1nf" tabindex="-1"><a class="header-anchor" href="#ç¬¬ä¸€èŒƒå¼-1nf" aria-hidden="true">#</a> ç¬¬ä¸€èŒƒå¼ (1NF)</h4><p>1NF è¦æ±‚<strong>æ‰€æœ‰å±æ€§éƒ½ä¸å¯å†åˆ†è§£</strong>ã€‚</p><h4 id="ç¬¬äºŒèŒƒå¼-2nf" tabindex="-1"><a class="header-anchor" href="#ç¬¬äºŒèŒƒå¼-2nf" aria-hidden="true">#</a> ç¬¬äºŒèŒƒå¼ (2NF)</h4><p>2NF è¦æ±‚è®°å½•æœ‰å”¯ä¸€æ ‡è¯†ï¼Œå³å®ä½“çš„å”¯ä¸€æ€§ï¼Œå³<strong>ä¸å­˜åœ¨éƒ¨åˆ†ä¾èµ–</strong>ã€‚</p><p>å‡è®¾æœ‰ä¸€å¼  student è¡¨ï¼Œç»“æ„å¦‚ä¸‹ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- å­¦ç”Ÿè¡¨</span>
studentï¼ˆå­¦å·ã€è¯¾ç¨‹å·ã€å§“åã€å­¦åˆ†ã€æˆç»©ï¼‰
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸¾ä¾‹æ¥è¯´ï¼Œç°æœ‰ä¸€å¼  student è¡¨ï¼Œå…·æœ‰å­¦å·ã€è¯¾ç¨‹å·ã€å§“åã€å­¦åˆ†ç­‰å­—æ®µã€‚ä»ä¸­å¯ä»¥çœ‹å‡ºï¼Œè¡¨ä¸­åŒ…å«äº†å­¦ç”Ÿä¿¡æ¯å’Œè¯¾ç¨‹ä¿¡æ¯ã€‚ç”±äºéä¸»é”®å­—æ®µå¿…é¡»ä¾èµ–ä¸»é”®ï¼Œè¿™é‡Œå­¦åˆ†ä¾èµ–è¯¾ç¨‹å·ï¼Œå§“åä¾èµ–å­¦å·ï¼Œæ‰€ä»¥ä¸ç¬¦åˆ 2NFã€‚</p><p>ä¸ç¬¦åˆ 2NF å¯èƒ½ä¼šå­˜åœ¨çš„é—®é¢˜ï¼š</p><ul><li><strong>æ•°æ®å†—ä½™</strong> - æ¯æ¡è®°å½•éƒ½å«æœ‰ç›¸åŒä¿¡æ¯ã€‚</li><li><strong>åˆ é™¤å¼‚å¸¸</strong> - åˆ é™¤æ‰€æœ‰å­¦ç”Ÿæˆç»©ï¼Œå°±æŠŠè¯¾ç¨‹ä¿¡æ¯å…¨åˆ é™¤äº†ã€‚</li><li><strong>æ’å…¥å¼‚å¸¸</strong> - å­¦ç”Ÿæœªé€‰è¯¾ï¼Œæ— æ³•è®°å½•è¿›æ•°æ®åº“ã€‚</li><li><strong>æ›´æ–°å¼‚å¸¸</strong> - è°ƒæ•´è¯¾ç¨‹å­¦åˆ†ï¼Œæ‰€æœ‰è¡Œéƒ½è°ƒæ•´ã€‚</li></ul><p>æ ¹æ® 2NF å¯ä»¥æ‹†åˆ†å¦‚ä¸‹ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- å­¦ç”Ÿè¡¨</span>
studentï¼ˆå­¦å·ã€å§“åï¼‰
<span class="token comment">-- è¯¾ç¨‹è¡¨</span>
courseï¼ˆè¯¾ç¨‹å·ã€å­¦åˆ†ï¼‰
<span class="token comment">-- å­¦ç”Ÿè¯¾ç¨‹å…³ç³»è¡¨</span>
student_courseï¼ˆå­¦å·ã€è¯¾ç¨‹å·ã€æˆç»©ï¼‰
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¬¬ä¸‰èŒƒå¼-3nf" tabindex="-1"><a class="header-anchor" href="#ç¬¬ä¸‰èŒƒå¼-3nf" aria-hidden="true">#</a> ç¬¬ä¸‰èŒƒå¼ (3NF)</h4><p><strong>å¦‚æœä¸€ä¸ªå…³ç³»å±äºç¬¬äºŒèŒƒå¼</strong>ï¼Œå¹¶ä¸”åœ¨<strong>ä¸¤ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰éä¸»é”®å±æ€§ä¹‹é—´ä¸å­˜åœ¨å‡½æ•°ä¾èµ–</strong>ï¼ˆéä¸»é”®å±æ€§ä¹‹é—´çš„å‡½æ•°ä¾èµ–ä¹Ÿç§°ä¸ºä¼ é€’ä¾èµ–ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªå…³ç³»å±äºç¬¬ä¸‰èŒƒå¼ã€‚</p><p>3NF æ˜¯å¯¹å­—æ®µçš„<strong>å†—ä½™æ€§</strong>ï¼Œè¦æ±‚ä»»ä½•å­—æ®µä¸èƒ½ç”±å…¶ä»–å­—æ®µæ´¾ç”Ÿå‡ºæ¥ï¼Œå®ƒè¦æ±‚å­—æ®µæ²¡æœ‰å†—ä½™ï¼Œå³<strong>ä¸å­˜åœ¨ä¼ é€’ä¾èµ–</strong>ã€‚</p><p>å‡è®¾æœ‰ä¸€å¼  student è¡¨ï¼Œç»“æ„å¦‚ä¸‹ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- å­¦ç”Ÿè¡¨</span>
studentï¼ˆå­¦å·ã€å§“åã€å¹´é¾„ã€ç­çº§å·ã€ç­ä¸»ä»»ï¼‰
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šè¡¨å±äºç¬¬äºŒèŒƒå¼ï¼Œå› ä¸ºä¸»é”®ç”±å•ä¸ªå±æ€§ç»„æˆï¼ˆå­¦å·ï¼‰ã€‚</p><p>å› ä¸ºå­˜åœ¨<strong>ä¾èµ–ä¼ é€’</strong>ï¼šï¼ˆå­¦å·ï¼‰ â†’ ï¼ˆå­¦ç”Ÿï¼‰â†’ï¼ˆæ‰€åœ¨ç­çº§ï¼‰ â†’ ï¼ˆç­ä¸»ä»»ï¼‰ ã€‚</p><p><strong>å¯èƒ½ä¼šå­˜åœ¨é—®é¢˜ï¼š</strong></p><ul><li>æ•°æ®å†—ä½™ - æœ‰é‡å¤å€¼ï¼›</li><li>æ›´æ–°å¼‚å¸¸ - æœ‰é‡å¤çš„å†—ä½™ä¿¡æ¯ï¼Œä¿®æ”¹æ—¶éœ€è¦åŒæ—¶ä¿®æ”¹å¤šæ¡è®°å½•ï¼Œå¦åˆ™ä¼šå‡ºç°<strong>æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µ</strong> ã€‚</li></ul><p>å¯ä»¥åŸºäº 3NF æ‹†è§£ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>studentï¼ˆå­¦å·ã€å§“åã€å¹´é¾„ã€æ‰€åœ¨ç­çº§å·ï¼‰
classï¼ˆç­çº§å·ã€ç­ä¸»ä»»ï¼‰
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ã€ç®€å•ã€‘ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨å­˜å‚¨è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#ã€ç®€å•ã€‘ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨å­˜å‚¨è¿‡ç¨‹" aria-hidden="true">#</a> ã€ç®€å•ã€‘ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨å­˜å‚¨è¿‡ç¨‹ï¼Ÿ</h3><p>å­˜å‚¨è¿‡ç¨‹çš„ä¼˜ç‚¹ï¼š</p><ul><li><strong>æ‰§è¡Œæ•ˆç‡é«˜</strong>ï¼šä¸€æ¬¡ç¼–è¯‘å¤šæ¬¡ä½¿ç”¨ã€‚</li><li><strong>å®‰å…¨æ€§å¼º</strong>ï¼šåœ¨è®¾å®šå­˜å‚¨è¿‡ç¨‹çš„æ—¶å€™å¯ä»¥è®¾ç½®å¯¹ç”¨æˆ·çš„ä½¿ç”¨æƒé™ï¼Œè¿™æ ·å°±å’Œè§†å›¾ä¸€æ ·å…·æœ‰è¾ƒå¼ºçš„å®‰å…¨æ€§ã€‚</li><li><strong>å¯å¤ç”¨</strong>ï¼šå°†ä»£ç å°è£…ï¼Œå¯ä»¥æé«˜ä»£ç å¤ç”¨ã€‚</li><li><strong>æ€§èƒ½å¥½</strong><ul><li>ç”±äºæ˜¯é¢„å…ˆç¼–è¯‘ï¼Œå› æ­¤å…·æœ‰å¾ˆé«˜çš„æ€§èƒ½ã€‚</li><li>ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹æ›¿ä»£å¤§é‡ T_SQL è¯­å¥ ï¼Œå¯ä»¥é™ä½ç½‘ç»œé€šä¿¡é‡ï¼Œæé«˜é€šä¿¡é€Ÿç‡ã€‚</li></ul></li></ul><p>å­˜å‚¨è¿‡ç¨‹çš„ç¼ºç‚¹ï¼š</p><ul><li><strong>å¯ç§»æ¤æ€§å·®</strong>ï¼šå­˜å‚¨è¿‡ç¨‹ä¸èƒ½è·¨æ•°æ®åº“ç§»æ¤ã€‚ç”±äºä¸åŒæ•°æ®åº“çš„å­˜å‚¨è¿‡ç¨‹è¯­æ³•å‡ ä¹éƒ½ä¸ä¸€æ ·ï¼Œååˆ†éš¾ä»¥ç»´æŠ¤ï¼ˆä¸é€šç”¨ï¼‰ã€‚</li><li><strong>è°ƒè¯•å›°éš¾</strong>ï¼šåªæœ‰å°‘æ•° DBMS æ”¯æŒå­˜å‚¨è¿‡ç¨‹çš„è°ƒè¯•ã€‚å¯¹äºå¤æ‚çš„å­˜å‚¨è¿‡ç¨‹æ¥è¯´ï¼Œå¼€å‘å’Œç»´æŠ¤éƒ½ä¸å®¹æ˜“ã€‚</li><li><strong>ç‰ˆæœ¬ç®¡ç†å›°éš¾</strong>ï¼šæ¯”å¦‚æ•°æ®è¡¨ç´¢å¼•å‘ç”Ÿå˜åŒ–äº†ï¼Œå¯èƒ½ä¼šå¯¼è‡´å­˜å‚¨è¿‡ç¨‹å¤±æ•ˆã€‚æˆ‘ä»¬åœ¨å¼€å‘è½¯ä»¶çš„æ—¶å€™å¾€å¾€éœ€è¦è¿›è¡Œç‰ˆæœ¬ç®¡ç†ï¼Œä½†æ˜¯å­˜å‚¨è¿‡ç¨‹æœ¬èº«æ²¡æœ‰ç‰ˆæœ¬æ§åˆ¶ï¼Œç‰ˆæœ¬è¿­ä»£æ›´æ–°çš„æ—¶å€™å¾ˆéº»çƒ¦ã€‚</li><li><strong>ä¸é€‚åˆé«˜å¹¶å‘çš„åœºæ™¯</strong>ï¼šé«˜å¹¶å‘çš„åœºæ™¯éœ€è¦å‡å°‘æ•°æ®åº“çš„å‹åŠ›ï¼Œæœ‰æ—¶æ•°æ®åº“ä¼šé‡‡ç”¨åˆ†åº“åˆ†è¡¨çš„æ–¹å¼ï¼Œè€Œä¸”å¯¹å¯æ‰©å±•æ€§è¦æ±‚å¾ˆé«˜ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå­˜å‚¨è¿‡ç¨‹ä¼šå˜å¾—éš¾ä»¥ç»´æŠ¤ï¼Œå¢åŠ æ•°æ®åº“çš„å‹åŠ›ï¼Œæ˜¾ç„¶å°±ä¸é€‚ç”¨äº†ã€‚</li></ul><blockquote><p><em>ç»¼ä¸Šï¼Œå­˜å‚¨è¿‡ç¨‹çš„ä¼˜ç¼ºç‚¹éƒ½éå¸¸çªå‡ºï¼Œæ˜¯å¦ä½¿ç”¨ä¸€å®šè¦æ…é‡ï¼Œéœ€è¦æ ¹æ®å…·ä½“åº”ç”¨åœºæ™¯æ¥æƒè¡¡</em>ã€‚</p></blockquote><h2 id="mysql-crud" tabindex="-1"><a class="header-anchor" href="#mysql-crud" aria-hidden="true">#</a> MySQL CRUD</h2>`,38),h=n("p",null,"æ‰©å±•é˜…è¯»ï¼š",-1),m={href:"https://book.douban.com/subject/35167240/",target:"_blank",rel:"noopener noreferrer"},b={href:"https://book.douban.com/subject/3354490/",target:"_blank",rel:"noopener noreferrer"},y=o('<h3 id="ã€ä¸­ç­‰ã€‘å¦‚ä½•é¿å…é‡å¤æ’å…¥æ•°æ®" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘å¦‚ä½•é¿å…é‡å¤æ’å…¥æ•°æ®" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘å¦‚ä½•é¿å…é‡å¤æ’å…¥æ•°æ®ï¼Ÿ</h3><p>åœ¨ mysql ä¸­ï¼Œå½“å­˜åœ¨ä¸»é”®å†²çªæˆ–å”¯ä¸€é”®å†²çªçš„æƒ…å†µä¸‹ï¼Œæ ¹æ®æ’å…¥ç­–ç•¥ä¸åŒï¼Œä¸€èˆ¬æœ‰ä»¥ä¸‹ä¸‰ç§é¿å…æ–¹æ³•ï¼š</p><ul><li><code>INSERT IGNORE INTO</code>ï¼šè‹¥æ— åˆ™æ’å…¥ï¼Œè‹¥æœ‰åˆ™å¿½ç•¥</li><li><code>REPLACE INTO</code>ï¼šè‹¥æ— åˆ™æ’å…¥ï¼Œè‹¥æœ‰åˆ™å…ˆåˆ é™¤åæ’å…¥</li><li><code>INSERT INTO ... ON DUPLICATE KEY UPDATE</code>ï¼šè‹¥æ— åˆ™æ’å…¥ï¼Œè‹¥æœ‰åˆ™æ›´æ–°</li></ul><p>ä¸‹é¢ç»“åˆç¤ºä¾‹æ¥è¯´æ˜ä¸‰ç§æ–¹å¼çš„æ•ˆæœã€‚</p><p>ä¸‹é¢æ˜¯ç¤ºä¾‹çš„åˆå§‹åŒ–å‡†å¤‡ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- å»ºè¡¨</span>\n<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>\n  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">UNSIGNED</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;ID&#39;</span><span class="token punctuation">,</span>\n  <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;åç§°&#39;</span><span class="token punctuation">,</span>\n  <span class="token identifier"><span class="token punctuation">`</span>age<span class="token punctuation">`</span></span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">&#39;0&#39;</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;å¹´é¾„&#39;</span><span class="token punctuation">,</span>\n  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token keyword">UNIQUE</span> <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span> <span class="token operator">=</span> utf8mb4<span class="token punctuation">;</span>\n\n<span class="token comment">-- æµ‹è¯•æ•°æ®</span>\n<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span>\n<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;åˆ˜å¤‡&#39;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span>\n<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&#39;å…³ç¾½&#39;</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',6),v=n("p",null,[n("code",null,"INSERT IGNORE INTO"),s(" ä¼šæ ¹æ®ä¸»é”®æˆ–è€…å”¯ä¸€é”®åˆ¤æ–­ï¼Œå¿½ç•¥æ•°æ®åº“ä¸­å·²ç»å­˜åœ¨çš„æ•°æ®ï¼š")],-1),f=n("ul",null,[n("li",null,[s("è‹¥æ•°æ®åº“æ²¡æœ‰è¯¥æ¡æ•°æ®ï¼Œå°±æ’å…¥ä¸ºæ–°çš„æ•°æ®ï¼Œè·Ÿæ™®é€šçš„ "),n("code",null,"INSERT INTO"),s(" ä¸€æ ·")]),n("li",null,"è‹¥æ•°æ®åº“æœ‰è¯¥æ¡æ•°æ®ï¼Œå°±å¿½ç•¥è¿™æ¡æ’å…¥è¯­å¥ï¼Œä¸æ‰§è¡Œæ’å…¥æ“ä½œ")],-1),w=n("div",{class:"language-sql line-numbers-mode","data-ext":"sql"},[n("pre",{class:"language-sql"},[n("code",null,[n("span",{class:"token keyword"},"INSERT"),s(),n("span",{class:"token keyword"},"IGNORE"),s(),n("span",{class:"token keyword"},"INTO"),s(),n("span",{class:"token keyword"},"user"),s(),n("span",{class:"token punctuation"},"("),s("name"),n("span",{class:"token punctuation"},","),s(" age"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"VALUES"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'å…³ç¾½'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"29"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'å¼ é£'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"25"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"-- æœ€ç»ˆæ•°æ®"),s(`
`),n("span",{class:"token operator"},"+"),n("span",{class:"token comment"},"----+--------+------+"),s(`
`),n("span",{class:"token operator"},"|"),s(" id "),n("span",{class:"token operator"},"|"),s(" name   "),n("span",{class:"token operator"},"|"),s(" age  "),n("span",{class:"token operator"},"|"),s(`
`),n("span",{class:"token operator"},"+"),n("span",{class:"token comment"},"----+--------+------+"),s(`
`),n("span",{class:"token operator"},"|"),s("  "),n("span",{class:"token number"},"1"),s(),n("span",{class:"token operator"},"|"),s(" åˆ˜å¤‡   "),n("span",{class:"token operator"},"|"),s("   "),n("span",{class:"token number"},"30"),s(),n("span",{class:"token operator"},"|"),s(`
`),n("span",{class:"token operator"},"|"),s("  "),n("span",{class:"token number"},"2"),s(),n("span",{class:"token operator"},"|"),s(" å…³ç¾½   "),n("span",{class:"token operator"},"|"),s("   "),n("span",{class:"token number"},"28"),s(),n("span",{class:"token operator"},"|"),s(`
`),n("span",{class:"token operator"},"|"),s("  "),n("span",{class:"token number"},"3"),s(),n("span",{class:"token operator"},"|"),s(" å¼ é£   "),n("span",{class:"token operator"},"|"),s("   "),n("span",{class:"token number"},"25"),s(),n("span",{class:"token operator"},"|"),s(`
`),n("span",{class:"token operator"},"+"),n("span",{class:"token comment"},"----+--------+------+"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),L=n("p",null,[n("code",null,"REPLACE INTO"),s(" ä¼šæ ¹æ®ä¸»é”®æˆ–è€…å”¯ä¸€é”®åˆ¤æ–­ï¼š")],-1),I=n("ul",null,[n("li",null,[s("è‹¥è¡¨ä¸­å·²å­˜åœ¨è¯¥æ•°æ®ï¼Œåˆ™å…ˆåˆ é™¤æ­¤è¡Œæ•°æ®ï¼Œç„¶åæ’å…¥æ–°çš„æ•°æ®ï¼Œç›¸å½“äº "),n("code",null,"delete + insert")]),n("li",null,[s("è‹¥è¡¨ä¸­ä¸å­˜åœ¨è¯¥æ•°æ®ï¼Œåˆ™ç›´æ¥æ’å…¥æ–°æ•°æ®ï¼Œè·Ÿæ™®é€šçš„ "),n("code",null,"insert into"),s(" ä¸€æ ·")])],-1),S=n("div",{class:"language-sql line-numbers-mode","data-ext":"sql"},[n("pre",{class:"language-sql"},[n("code",null,[n("span",{class:"token keyword"},"REPLACE"),s(),n("span",{class:"token keyword"},"INTO"),s(),n("span",{class:"token keyword"},"user"),n("span",{class:"token punctuation"},"("),s("id"),n("span",{class:"token punctuation"},","),s(" name"),n("span",{class:"token punctuation"},","),s(" age"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"VALUES"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"2"),n("span",{class:"token punctuation"},","),s("  "),n("span",{class:"token string"},"'å…³ç¾½'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"29"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"4"),n("span",{class:"token punctuation"},","),s("  "),n("span",{class:"token string"},"'èµµäº‘'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"22"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"-- æœ€ç»ˆæ•°æ®"),s(`
`),n("span",{class:"token operator"},"+"),n("span",{class:"token comment"},"----+--------+------+"),s(`
`),n("span",{class:"token operator"},"|"),s(" id "),n("span",{class:"token operator"},"|"),s(" name   "),n("span",{class:"token operator"},"|"),s(" age  "),n("span",{class:"token operator"},"|"),s(`
`),n("span",{class:"token operator"},"+"),n("span",{class:"token comment"},"----+--------+------+"),s(`
`),n("span",{class:"token operator"},"|"),s("  "),n("span",{class:"token number"},"1"),s(),n("span",{class:"token operator"},"|"),s(" åˆ˜å¤‡   "),n("span",{class:"token operator"},"|"),s("   "),n("span",{class:"token number"},"30"),s(),n("span",{class:"token operator"},"|"),s(`
`),n("span",{class:"token operator"},"|"),s("  "),n("span",{class:"token number"},"2"),s(),n("span",{class:"token operator"},"|"),s(" å…³ç¾½   "),n("span",{class:"token operator"},"|"),s("   "),n("span",{class:"token number"},"29"),s(),n("span",{class:"token operator"},"|"),s(`
`),n("span",{class:"token operator"},"|"),s("  "),n("span",{class:"token number"},"3"),s(),n("span",{class:"token operator"},"|"),s(" å¼ é£   "),n("span",{class:"token operator"},"|"),s("   "),n("span",{class:"token number"},"25"),s(),n("span",{class:"token operator"},"|"),s(`
`),n("span",{class:"token operator"},"|"),s("  "),n("span",{class:"token number"},"4"),s(),n("span",{class:"token operator"},"|"),s(" èµµäº‘   "),n("span",{class:"token operator"},"|"),s("   "),n("span",{class:"token number"},"22"),s(),n("span",{class:"token operator"},"|"),s(`
`),n("span",{class:"token operator"},"+"),n("span",{class:"token comment"},"----+--------+------+"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),E=n("p",null,[n("code",null,"INSERT ... ON DUPLICATE KEY UPDATE"),s(" ä¼šæ ¹æ®ä¸»é”®æˆ–è€…å”¯ä¸€é”®åˆ¤æ–­ï¼š")],-1),M=n("ul",null,[n("li",null,"è‹¥æ•°æ®åº“å·²æœ‰è¯¥æ•°æ®ï¼Œåˆ™ç›´æ¥æ›´æ–°åŸæ•°æ®ï¼Œç›¸å½“äº UPDATE"),n("li",null,"è‹¥æ•°æ®åº“æ²¡æœ‰è¯¥æ•°æ®ï¼Œåˆ™æ’å…¥ä¸ºæ–°çš„æ•°æ®ï¼Œç›¸å½“äº INSERT")],-1),N=n("div",{class:"language-sql line-numbers-mode","data-ext":"sql"},[n("pre",{class:"language-sql"},[n("code",null,[n("span",{class:"token keyword"},"INSERT"),s(),n("span",{class:"token keyword"},"INTO"),s(),n("span",{class:"token keyword"},"user"),n("span",{class:"token punctuation"},"("),s("id"),n("span",{class:"token punctuation"},","),s(" name"),n("span",{class:"token punctuation"},","),s(" age"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"VALUES"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"2"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'å…³ç¾½'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"27"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"ON"),s(),n("span",{class:"token keyword"},"DUPLICATE"),s(),n("span",{class:"token keyword"},"KEY"),s(),n("span",{class:"token keyword"},"UPDATE"),s(" name"),n("span",{class:"token operator"},"="),n("span",{class:"token keyword"},"values"),n("span",{class:"token punctuation"},"("),s("name"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(" age"),n("span",{class:"token operator"},"="),n("span",{class:"token keyword"},"values"),n("span",{class:"token punctuation"},"("),s("age"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"-- æœ€ç»ˆæ•°æ®"),s(`
`),n("span",{class:"token operator"},"+"),n("span",{class:"token comment"},"----+--------+------+"),s(`
`),n("span",{class:"token operator"},"|"),s(" id "),n("span",{class:"token operator"},"|"),s(" name   "),n("span",{class:"token operator"},"|"),s(" age  "),n("span",{class:"token operator"},"|"),s(`
`),n("span",{class:"token operator"},"+"),n("span",{class:"token comment"},"----+--------+------+"),s(`
`),n("span",{class:"token operator"},"|"),s("  "),n("span",{class:"token number"},"1"),s(),n("span",{class:"token operator"},"|"),s(" åˆ˜å¤‡   "),n("span",{class:"token operator"},"|"),s("   "),n("span",{class:"token number"},"30"),s(),n("span",{class:"token operator"},"|"),s(`
`),n("span",{class:"token operator"},"|"),s("  "),n("span",{class:"token number"},"2"),s(),n("span",{class:"token operator"},"|"),s(" å…³ç¾½   "),n("span",{class:"token operator"},"|"),s("   "),n("span",{class:"token number"},"27"),s(),n("span",{class:"token operator"},"|"),s(`
`),n("span",{class:"token operator"},"|"),s("  "),n("span",{class:"token number"},"3"),s(),n("span",{class:"token operator"},"|"),s(" å¼ é£   "),n("span",{class:"token operator"},"|"),s("   "),n("span",{class:"token number"},"25"),s(),n("span",{class:"token operator"},"|"),s(`
`),n("span",{class:"token operator"},"|"),s("  "),n("span",{class:"token number"},"4"),s(),n("span",{class:"token operator"},"|"),s(" èµµäº‘   "),n("span",{class:"token operator"},"|"),s("   "),n("span",{class:"token number"},"22"),s(),n("span",{class:"token operator"},"|"),s(`
`),n("span",{class:"token operator"},"+"),n("span",{class:"token comment"},"----+--------+------+"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),T=o(`<h3 id="ã€ç®€å•ã€‘exists-å’Œ-in-æœ‰ä»€ä¹ˆåŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#ã€ç®€å•ã€‘exists-å’Œ-in-æœ‰ä»€ä¹ˆåŒºåˆ«" aria-hidden="true">#</a> ã€ç®€å•ã€‘EXISTS å’Œ IN æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>EXISTS å’Œ IN åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li><strong>åŠŸèƒ½</strong><ul><li><code>EXISTS</code> ç”¨äºåˆ¤æ–­å­æŸ¥è¯¢çš„ç»“æœé›†æ˜¯å¦ä¸ºç©ºã€‚</li><li><code>IN</code> ç”¨äºåˆ¤æ–­æŸä¸ªå€¼æ˜¯å¦åœ¨æŒ‡å®šçš„é›†åˆä¸­ã€‚</li></ul></li><li><strong>æ€§èƒ½</strong><ul><li><strong><code>EXISTS</code> å…ˆå¤–åå†…</strong> - å…ˆå¯¹å¤–è¡¨è¿›è¡Œå¾ªç¯æŸ¥è¯¢ï¼Œå†å°†æŸ¥è¯¢ç»“æœæ”¾å…¥ <code>EXISTS</code> çš„å­æŸ¥è¯¢ä¸­è¿›è¡Œæ¡ä»¶æ¯”è¾ƒï¼Œä¸€æ—¦æ‰¾åˆ°åŒ¹é…è®°å½•ï¼Œåˆ™ç»ˆæ­¢å†…è¡¨å­æŸ¥è¯¢ã€‚</li><li><strong><code>IN</code> å…ˆå†…åå¤–</strong> - å…ˆæŸ¥è¯¢å†…è¡¨ï¼Œå°†å†…è¡¨çš„æŸ¥è¯¢ç»“æœä½œä¸ºæ¡ä»¶ï¼Œæä¾›ç»™å¤–è¡¨æŸ¥è¯¢è¯­å¥è¿›è¡Œæ¯”è¾ƒã€‚</li></ul></li><li><strong>åº”ç”¨</strong><ul><li>å¦‚æœæŸ¥è¯¢çš„ä¸¤ä¸ªè¡¨å¤§å°ç›¸å½“ï¼Œé‚£ä¹ˆ <code>EXISTS</code> å’Œ <code>IN</code> å·®åˆ«ä¸å¤§ã€‚</li><li><code>EXISTS</code> é€‚åˆå¤–è¡¨å°è€Œå†…è¡¨å¤§çš„åœºæ™¯ã€‚</li><li><code>IN</code> é€‚åˆå¤–è¡¨å¤§è€Œå†…è¡¨å°çš„åœºæ™¯ã€‚</li></ul></li></ul><p>EXISTS å’Œ IN çš„å¯¹æ¯”ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> A <span class="token keyword">WHERE</span> cc <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> cc <span class="token keyword">FROM</span> B<span class="token punctuation">)</span>
 <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> A <span class="token keyword">WHERE</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> cc <span class="token keyword">FROM</span> B <span class="token keyword">WHERE</span> B<span class="token punctuation">.</span>cc<span class="token operator">=</span>A<span class="token punctuation">.</span>cc<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ A å°äº B æ—¶ï¼Œç”¨ <code>EXISTS</code>ã€‚å› ä¸º <code>EXISTS</code> çš„å®ç°ï¼Œç›¸å½“äºå¤–è¡¨å¾ªç¯ï¼Œå®ç°çš„é€»è¾‘ç±»ä¼¼äºï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code> <span class="token keyword">for</span> i <span class="token operator">in</span> A
     <span class="token keyword">for</span> j <span class="token operator">in</span> B
         <span class="token keyword">if</span> j<span class="token punctuation">.</span>cc <span class="token operator">=</span><span class="token operator">=</span> i<span class="token punctuation">.</span>cc <span class="token keyword">then</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ B å°äº A æ—¶ç”¨ <code>IN</code>ï¼Œå› ä¸ºå®ç°çš„é€»è¾‘ç±»ä¼¼äºï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code> <span class="token keyword">for</span> i <span class="token operator">in</span> B
     <span class="token keyword">for</span> j <span class="token operator">in</span> A
         <span class="token keyword">if</span> j<span class="token punctuation">.</span>cc <span class="token operator">=</span><span class="token operator">=</span> i<span class="token punctuation">.</span>cc <span class="token keyword">then</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å“ªä¸ªè¡¨å°å°±ç”¨å“ªä¸ªè¡¨æ¥é©±åŠ¨ï¼ŒA è¡¨å°å°±ç”¨ <code>EXISTS</code>ï¼ŒB è¡¨å°å°±ç”¨ <code>IN</code>ï¼›å¦‚æœä¸¤ä¸ªè¡¨å¤§å°ç›¸å½“ï¼Œåˆ™ä½¿ç”¨ <code>EXISTS</code> å’Œ <code>IN</code> çš„åŒºåˆ«ä¸å¤§ã€‚</p><h3 id="ã€ç®€å•ã€‘union-å’Œ-union-all-æœ‰ä»€ä¹ˆåŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#ã€ç®€å•ã€‘union-å’Œ-union-all-æœ‰ä»€ä¹ˆåŒºåˆ«" aria-hidden="true">#</a> ã€ç®€å•ã€‘UNION å’Œ UNION ALL æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p><code>UNION</code> å’Œ <code>UNION ALL</code> éƒ½æ˜¯å°†ä¸¤ä¸ªç»“æœé›†åˆå¹¶ä¸ºä¸€ä¸ªï¼Œ<strong>ä¸¤ä¸ªè¦è”åˆçš„ SQL è¯­å¥å­—æ®µä¸ªæ•°å¿…é¡»ä¸€æ ·ï¼Œè€Œä¸”å­—æ®µç±»å‹è¦â€œç›¸å®¹â€ï¼ˆä¸€è‡´ï¼‰</strong>ã€‚</p><ul><li><code>UNION</code> éœ€è¦è¿›è¡Œå»é‡æ‰«æï¼Œå› æ­¤æ•ˆç‡è¾ƒä½ï¼›è€Œ <code>UNION ALL</code> ä¸ä¼šè¿›è¡Œå»é‡ã€‚</li><li><code>UNION</code> ä¼šæŒ‰ç…§å­—æ®µçš„é¡ºåºè¿›è¡Œæ’åºï¼›è€Œ <code>UNION ALL</code> åªæ˜¯ç®€å•çš„å°†ä¸¤ä¸ªç»“æœåˆå¹¶å°±è¿”å›ã€‚</li></ul><h3 id="ã€ç®€å•ã€‘join-æœ‰å“ªäº›ç±»å‹" tabindex="-1"><a class="header-anchor" href="#ã€ç®€å•ã€‘join-æœ‰å“ªäº›ç±»å‹" aria-hidden="true">#</a> ã€ç®€å•ã€‘JOIN æœ‰å“ªäº›ç±»å‹ï¼Ÿ</h3><p><strong>åœ¨ SELECT, UPDATE å’Œ DELETE è¯­å¥ä¸­ï¼Œâ€œè¿æ¥â€å¯ä»¥ç”¨äºè”åˆå¤šè¡¨æŸ¥è¯¢ã€‚è¿æ¥ä½¿ç”¨ <code>JOIN</code> å…³é”®å­—ï¼Œå¹¶ä¸”æ¡ä»¶è¯­å¥ä½¿ç”¨ <code>ON</code> è€Œä¸æ˜¯ <code>WHERE</code></strong>ã€‚</p><p><strong>è¿æ¥å¯ä»¥æ›¿æ¢å­æŸ¥è¯¢ï¼Œå¹¶ä¸”ä¸€èˆ¬æ¯”å­æŸ¥è¯¢çš„æ•ˆç‡æ›´å¿«</strong>ã€‚</p><p><code>JOIN</code> æœ‰ä»¥ä¸‹ç±»å‹ï¼š</p><ul><li>å†…è¿æ¥ - å†…è¿æ¥åˆç§°ç­‰å€¼è¿æ¥ï¼Œç”¨äºè·å–ä¸¤ä¸ªè¡¨ä¸­å­—æ®µåŒ¹é…å…³ç³»çš„è®°å½•ï¼Œ<strong>ä½¿ç”¨ <code>INNER JOIN</code> å…³é”®å­—</strong>ã€‚åœ¨æ²¡æœ‰æ¡ä»¶è¯­å¥çš„æƒ…å†µä¸‹<strong>è¿”å›ç¬›å¡å°”ç§¯</strong>ã€‚ <ul><li>ç¬›å¡å°”ç§¯ - <strong>â€œç¬›å¡å°”ç§¯â€ä¹Ÿç§°ä¸ºäº¤å‰è¿æ¥ï¼ˆ<code>CROSS JOIN</code>ï¼‰ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯å¯ä»¥æŠŠä»»æ„è¡¨è¿›è¡Œè¿æ¥ï¼Œå³ä½¿è¿™ä¸¤å¼ è¡¨ä¸ç›¸å…³</strong>ã€‚</li><li>è‡ªè¿æ¥ï¼ˆ=ï¼‰ - <strong>â€œè‡ªè¿æ¥ï¼ˆ=ï¼‰â€å¯ä»¥çœ‹æˆå†…è¿æ¥çš„ä¸€ç§ï¼Œåªæ˜¯è¿æ¥çš„è¡¨æ˜¯è‡ªèº«è€Œå·²</strong>ã€‚</li><li>è‡ªç„¶è¿æ¥ï¼ˆNATURAL JOINï¼‰ - <strong>â€œè‡ªç„¶è¿æ¥â€ä¼šè‡ªåŠ¨è¿æ¥æ‰€æœ‰åŒååˆ—</strong>ã€‚è‡ªç„¶è¿æ¥ä½¿ç”¨ <code>NATURAL JOIN</code> å…³é”®å­—ã€‚</li></ul></li><li>å¤–è¿æ¥ <ul><li>å·¦è¿æ¥ï¼ˆLEFT JOINï¼‰ - <strong>â€œå·¦å¤–è¿æ¥â€ä¼šè·å–å·¦è¡¨æ‰€æœ‰è®°å½•ï¼Œå³ä½¿å³è¡¨æ²¡æœ‰å¯¹åº”åŒ¹é…çš„è®°å½•</strong>ã€‚å·¦å¤–è¿æ¥ä½¿ç”¨ <code>LEFT JOIN</code> å…³é”®å­—ã€‚</li><li>å³è¿æ¥ï¼ˆRIGHT JOINï¼‰ - <strong>â€œå³å¤–è¿æ¥â€ä¼šè·å–å³è¡¨æ‰€æœ‰è®°å½•ï¼Œå³ä½¿å·¦è¡¨æ²¡æœ‰å¯¹åº”åŒ¹é…çš„è®°å½•</strong>ã€‚å³å¤–è¿æ¥ä½¿ç”¨ <code>RIGHT JOIN</code> å…³é”®å­—ã€‚</li></ul></li></ul><figure><img src="https://raw.githubusercontent.com/dunwu/images/master/cs/database/mysql/sql-join.png" alt="SQL JOIN" tabindex="0" loading="lazy"><figcaption>SQL JOIN</figcaption></figure><h3 id="ã€ä¸­ç­‰ã€‘ä¸ºä»€ä¹ˆä¸æ¨èå¤šè¡¨-join" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘ä¸ºä»€ä¹ˆä¸æ¨èå¤šè¡¨-join" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘ä¸ºä»€ä¹ˆä¸æ¨èå¤šè¡¨ JOINï¼Ÿ</h3>`,20),x={href:"https://www.cnblogs.com/eiffelzero/p/18608160",target:"_blank",rel:"noopener noreferrer"},_={href:"https://book.douban.com/subject/27605355/",target:"_blank",rel:"noopener noreferrer"},q=o('<p>ä¸»è¦åŸå› å¦‚ä¸‹ï¼š</p><ul><li><strong>æ€§èƒ½é—®é¢˜</strong><ul><li><strong>æŸ¥è¯¢æ•ˆç‡ä½</strong>ï¼šå½“æ¶‰åŠå¤šä¸ªè¡¨è¿›è¡Œ <strong>JOIN</strong> æ“ä½œæ—¶ï¼ŒMySQL éœ€è¦æ‰§è¡Œå¤šæ¬¡æ‰«æï¼Œå°¤å…¶æ˜¯åœ¨æ²¡æœ‰åˆé€‚ç´¢å¼•æ”¯æŒçš„æƒ…å†µä¸‹ï¼Œæ€§èƒ½å¯èƒ½ä¼šå¤§å¹…ä¸‹é™ã€‚æ¯å¢åŠ ä¸€ä¸ªè¡¨çš„ <strong>JOIN</strong>ï¼ŒæŸ¥è¯¢çš„å¤æ‚åº¦å‘ˆæŒ‡æ•°å¢é•¿ã€‚</li><li><strong>ä¸´æ—¶è¡¨çš„åˆ›å»º</strong>ï¼šMySQL åœ¨æ‰§è¡Œå¤æ‚çš„å¤šè¡¨ <strong>JOIN</strong> æ—¶ï¼Œé€šå¸¸ä¼šåˆ›å»ºä¸´æ—¶è¡¨æ¥å­˜å‚¨ä¸­é—´ç»“æœã€‚å¦‚æœæ•°æ®é‡å¾ˆå¤§ï¼Œä¸´æ—¶è¡¨å¯èƒ½ä¼šæº¢å‡ºåˆ°ç£ç›˜ï¼Œå¯¼è‡´ç£ç›˜ I/O æ“ä½œå¢åŠ ï¼Œä»è€Œæ˜¾è‘—å½±å“æŸ¥è¯¢æ€§èƒ½ã€‚</li></ul></li><li><strong>ç´¢å¼•çš„ä½œç”¨æœ‰é™</strong><ul><li>åœ¨å¤šè¡¨ <strong>JOIN</strong> çš„æ“ä½œä¸­ï¼Œè™½ç„¶æ¯ä¸ªè¡¨å¯ä»¥ä½¿ç”¨ç´¢å¼•åŠ é€ŸæŸ¥è¯¢ï¼Œä½†æ˜¯å½“æ¶‰åŠåˆ°å¤šä¸ªè¡¨çš„è¿æ¥æ—¶ï¼ŒMySQL å¿…é¡»åœ¨è¿™äº›è¡¨ä¹‹é—´æ‰§è¡Œ <strong>JOIN</strong> æ“ä½œï¼Œè¿™æ—¶ç´¢å¼•çš„æ•ˆæœä¼šå¤§å¤§é™ä½ã€‚ç‰¹åˆ«æ˜¯åœ¨æ²¡æœ‰åˆé€‚ç´¢å¼•çš„æƒ…å†µä¸‹ï¼Œ<strong>JOIN</strong> æŸ¥è¯¢ä¼šå¯¼è‡´å…¨è¡¨æ‰«æï¼Œæå¤§åœ°é™ä½äº†æŸ¥è¯¢æ•ˆç‡ã€‚</li></ul></li><li><strong>æ•°æ®å†—ä½™</strong><ul><li>åœ¨å¤šè¡¨ <strong>JOIN</strong> æ—¶ï¼Œå¦‚æœä¸€ä¸ªè¡¨ä¸­çš„ä¸€è¡Œæ•°æ®ä¸å¦ä¸€ä¸ªè¡¨ä¸­çš„å¤šè¡Œæ•°æ®è¿›è¡ŒåŒ¹é…ï¼Œç»“æœä¼šäº§ç”Ÿæ•°æ®å†—ä½™ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æœ‰ä¸¤ä¸ªè¡¨ï¼š<code>A</code> å’Œ <code>B</code>ï¼Œ<code>A</code> ä¸­æœ‰ 10 æ¡è®°å½•ï¼Œ<code>B</code> ä¸­æœ‰ 5 æ¡è®°å½•ã€‚å¦‚æœåœ¨ <code>A</code> å’Œ <code>B</code> ä¸Šåš <strong>JOIN</strong> æ“ä½œï¼Œä¸”åŒ¹é…æ¡ä»¶æ»¡è¶³ 2 æ¡è®°å½•ï¼Œé‚£ä¹ˆæœ€ç»ˆçš„ç»“æœä¼šæœ‰ 20 æ¡è®°å½•ï¼ˆ10 * 2ï¼‰ã€‚è¿™ä¼šå¯¼è‡´æ•°æ®é‡æ€¥å‰§å¢åŠ ï¼Œæµªè´¹å­˜å‚¨ç©ºé—´ã€‚</li></ul></li><li><strong>å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§</strong><ul><li>å¤šè¡¨ <strong>JOIN</strong> çš„ SQL æŸ¥è¯¢é€šå¸¸æ¯”è¾ƒå¤æ‚ï¼Œå°¤å…¶æ˜¯å½“æ¶‰åŠå¤šä¸ªè¡¨ã€å¤šä¸ªè¿æ¥æ¡ä»¶ä»¥åŠåµŒå¥—æŸ¥è¯¢æ—¶ï¼ŒæŸ¥è¯¢è¯­å¥çš„å¯è¯»æ€§ä¼šä¸‹é™ï¼Œå¢åŠ äº†ç»´æŠ¤çš„éš¾åº¦ã€‚</li><li>å¤æ‚çš„æŸ¥è¯¢å¯èƒ½è®©å¼€å‘è€…å’Œè¿ç»´äººå‘˜éš¾ä»¥ç†è§£å’Œä¼˜åŒ–ï¼Œä»è€Œå¢åŠ äº†é”™è¯¯çš„é£é™©ã€‚</li></ul></li><li><strong>å¯èƒ½å¼•å‘æ­»é”</strong><ul><li>åœ¨è¿›è¡Œå¤šä¸ªè¡¨ <strong>JOIN</strong> æ“ä½œæ—¶ï¼Œå¦‚æœæ¶‰åŠåˆ°å¤šå¼ è¡¨çš„é”å®šï¼Œå¯èƒ½ä¼šå¯¼è‡´æ­»é”ã€‚ç‰¹åˆ«æ˜¯åœ¨é«˜å¹¶å‘çš„ç¯å¢ƒä¸‹ï¼Œé¢‘ç¹æ‰§è¡Œ <strong>JOIN</strong> æ“ä½œå®¹æ˜“å¯¼è‡´å¤šä¸ªäº‹åŠ¡ä¹‹é—´ç›¸äº’ç­‰å¾…ï¼Œæœ€ç»ˆå¯¼è‡´æ­»é”é—®é¢˜ã€‚</li></ul></li><li><strong>ä¼˜åŒ–å™¨çš„ä½œç”¨æœ‰é™</strong><ul><li>MySQL çš„ä¼˜åŒ–å™¨å¯¹å¤šè¡¨ <strong>JOIN</strong> çš„ä¼˜åŒ–èƒ½åŠ›ç›¸å¯¹æœ‰é™ï¼Œå°¤å…¶åœ¨å¤„ç†éå¸¸å¤æ‚çš„æŸ¥è¯¢æ—¶ï¼Œå¯èƒ½æ— æ³•æœ‰æ•ˆé€‰æ‹©æœ€ä¼˜çš„æ‰§è¡Œè®¡åˆ’ï¼Œä»è€Œå¯¼è‡´æ€§èƒ½ç“¶é¢ˆã€‚</li><li>è™½ç„¶ MySQL ä½¿ç”¨äº† <strong>æŸ¥è¯¢ç¼“å­˜</strong> å’Œ <strong>ç´¢å¼•ä¼˜åŒ–</strong>ï¼Œä½†å¯¹äºå¤šè¡¨ <strong>JOIN</strong> çš„ä¼˜åŒ–ä»ç„¶å—åˆ°å¾ˆå¤šé™åˆ¶ï¼Œå¯¼è‡´æ€§èƒ½ä¸å¦‚é¢„æœŸã€‚</li></ul></li></ul><h3 id="ã€ä¸­ç­‰ã€‘dropã€delete-å’Œ-truncate-æœ‰ä»€ä¹ˆåŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘dropã€delete-å’Œ-truncate-æœ‰ä»€ä¹ˆåŒºåˆ«" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘DROPã€DELETE å’Œ TRUNCATE æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><ul><li><code>DROP</code> åˆ é™¤æ•°æ®è¡¨ï¼ŒåŒ…æ‹¬æ•°æ®å’Œç»“æ„ã€‚åœ¨ InnoDB ä¸­ï¼Œè¡¨æ•°æ®å­˜äº <code>.ibd</code> æ–‡ä»¶ï¼›è¡¨ç»“æ„å…ƒæ•°æ®å­˜äº .frm æ–‡ä»¶ã€‚DROP æœ¬è´¨ä¸Šæ˜¯å°±æ˜¯ç›´æ¥åˆ é™¤ <code>.ibd</code> å’Œ <code>.frm</code> æ–‡ä»¶ã€‚</li><li><code>DELETE</code> åˆ é™¤æ•°æ®ï¼Œä½†ä¿ç•™è¡¨ç»“æ„ã€‚æ‰§è¡Œ DELETE åï¼Œç©ºé—´å¤§å°ä¸ä¼šç«‹åˆ»å˜åŒ–ã€‚è¿™æ˜¯å› ä¸ºï¼ŒDLETE æ“ä½œå®é™…ä¸Šåªæ˜¯æ ‡è®°ï¼Œè¢«å†™å…¥ biglogã€redo log å’Œ undo logã€‚</li><li><code>TRUNCATE</code> ä¼šåˆ é™¤å…¨éƒ¨è¡¨æ•°æ®ï¼Œä¸”ä¸ä¼šè®°å½•æ—¥å¿—ï¼Œå› æ­¤æ— æ³•å›æ»šã€‚<code>TRUNCATE</code> æ‰§è¡Œåï¼Œè‡ªå¢ä¸»é”®é‡æ–°ä» 1 å¼€å§‹ã€‚</li></ul><h2 id="mysql-æ•°æ®ç±»å‹" tabindex="-1"><a class="header-anchor" href="#mysql-æ•°æ®ç±»å‹" aria-hidden="true">#</a> MySQL æ•°æ®ç±»å‹</h2>',5),A=n("p",null,"æ‰©å±•é˜…è¯»ï¼š",-1),O={href:"https://dev.mysql.com/doc/refman/8.4/en/data-types.html",target:"_blank",rel:"noopener noreferrer"},R={href:"http://blog.leanote.com/post/weibo-007/mysql_float_double_decimal",target:"_blank",rel:"noopener noreferrer"},Q=o(`<h3 id="ã€ç®€å•ã€‘char-å’Œ-varchar-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#ã€ç®€å•ã€‘char-å’Œ-varchar-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ" aria-hidden="true">#</a> ã€ç®€å•ã€‘CHAR å’Œ VARCHAR çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><code>CHAR</code> å’Œ <code>VARCHAR</code> çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼š<strong>CHAR æ˜¯å®šé•¿å­—ç¬¦ä¸²ï¼ŒVARCHAR æ˜¯å˜é•¿å­—ç¬¦ä¸²ã€‚</strong></p><ul><li><strong>é•¿åº¦é™åˆ¶</strong><ul><li><code>CHAR(M)</code> å’Œ <code>VARCHAR(M)</code> çš„ M éƒ½ä»£è¡¨èƒ½å¤Ÿä¿å­˜çš„å­—ç¬¦æ•°çš„æœ€å¤§å€¼ï¼Œæ— è®ºæ˜¯å­—æ¯ã€æ•°å­—è¿˜æ˜¯ä¸­æ–‡ï¼Œæ¯ä¸ªéƒ½åªå ç”¨ä¸€ä¸ªå­—ç¬¦ã€‚</li></ul></li><li><strong>å ç”¨ç©ºé—´</strong><ul><li><code>CHAR</code> åœ¨å­˜å‚¨æ—¶ä¼šåœ¨å³è¾¹å¡«å……ç©ºæ ¼ä»¥è¾¾åˆ°æŒ‡å®šçš„é•¿åº¦ï¼Œæ£€ç´¢æ—¶ä¼šå»æ‰ç©ºæ ¼ï¼›</li><li><code>VARCHAR</code> åœ¨å­˜å‚¨æ—¶éœ€è¦ä½¿ç”¨ 1 æˆ– 2 ä¸ªé¢å¤–å­—èŠ‚è®°å½•å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œæ£€ç´¢æ—¶ä¸éœ€è¦å¤„ç†ã€‚ <ul><li>å­—ç¬¦é•¿åº¦è¶…è¿‡ 255ï¼Œä½¿ç”¨ 2 ä¸ªå­—èŠ‚</li><li>å­—ç¬¦é•¿åº¦æœªè¶…è¿‡ 255ï¼Œä½¿ç”¨ 1 ä¸ªå­—èŠ‚</li></ul></li></ul></li><li><strong>åº”ç”¨</strong></li><li><strong><code>CHAR</code> é€‚åˆå­˜å‚¨é•¿åº¦è¾ƒçŸ­æˆ–é•¿åº¦å›ºå®šçš„å­—ç¬¦ä¸²</strong>ã€‚ä¾‹å¦‚ Bcrypt ç®—æ³•ã€MD5 ç®—æ³•åŠ å¯†åçš„å¯†ç ã€èº«ä»½è¯å·ç ï¼›</li><li><strong><code>VARCHAR</code> é€‚åˆå­˜å‚¨é•¿åº¦ä¸ç¡®å®šçš„å­—ç¬¦ä¸²</strong>ã€‚ä¾‹å¦‚ç”¨æˆ·æ˜µç§°ã€æ–‡ç« æ ‡é¢˜ç­‰ã€‚</li></ul><p><code>BINARY</code> å’Œ <code>VARBINARY</code> ç±»ä¼¼äº <code>CHAR</code> å’Œ <code>VARCHAR</code>ï¼Œä¸åŒçš„æ˜¯å®ƒä»¬åŒ…å«äºŒè¿›åˆ¶å­—ç¬¦ä¸²è€Œä¸è¦éäºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬åŒ…å«å­—èŠ‚å­—ç¬¦ä¸²è€Œä¸æ˜¯å­—ç¬¦å­—ç¬¦ä¸²ã€‚è¿™è¯´æ˜å®ƒä»¬æ²¡æœ‰å­—ç¬¦é›†ï¼Œå¹¶ä¸”æ’åºå’Œæ¯”è¾ƒåŸºäºåˆ—å€¼å­—èŠ‚çš„æ•°å€¼å€¼ã€‚</p><h3 id="ã€ç®€å•ã€‘é‡‘é¢æ•°æ®ç”¨ä»€ä¹ˆç±»å‹å­˜å‚¨" tabindex="-1"><a class="header-anchor" href="#ã€ç®€å•ã€‘é‡‘é¢æ•°æ®ç”¨ä»€ä¹ˆç±»å‹å­˜å‚¨" aria-hidden="true">#</a> ã€ç®€å•ã€‘é‡‘é¢æ•°æ®ç”¨ä»€ä¹ˆç±»å‹å­˜å‚¨ï¼Ÿ</h3><p>MySQL ä¸­æœ‰ 3 ç§ç±»å‹å¯ä»¥è¡¨ç¤ºæµ®ç‚¹æ•°ï¼Œåˆ†åˆ«æ˜¯ <code>FLOAT</code>ã€<code>DOUBLE</code> å’Œ <code>DECIMAL</code>ã€‚</p><p><strong>é‡‡ç”¨ <code>FLOAT</code> å’Œ <code>DOUBLE</code> ç±»å‹ä¼šä¸¢å¤±ç²¾åº¦</strong>ã€‚æ•°æ®çš„ç²¾ç¡®åº¦å–å†³äºåˆ†é…ç»™æ¯ç§æ•°æ®ç±»å‹çš„å­˜å‚¨é•¿åº¦ã€‚ç”±äºè®¡ç®—æœºåªèƒ½å­˜å‚¨äºŒè¿›åˆ¶ï¼Œæ‰€ä»¥æµ®ç‚¹å‹æ•°æ®åœ¨å­˜å‚¨çš„æ—¶å€™ï¼Œå¿…é¡»è½¬åŒ–æˆäºŒè¿›åˆ¶ã€‚</p><ul><li>å•ç²¾åº¦ç±»å‹ <code>FLOAT</code> å­˜å‚¨ç©ºé—´ä¸º 4 å­—èŠ‚ï¼Œå³ 32 ä½ã€‚</li><li>åŒç²¾åº¦ç±»å‹ <code>DOUBLE</code> å­˜å‚¨ç©ºé—´ä¸º 8 å­—èŠ‚ï¼Œå³ 64 ä½ã€‚</li></ul><p>å¦‚æœå­˜å‚¨çš„æ•°æ®è½¬ä¸ºäºŒè¿›åˆ¶åï¼Œè¶…è¿‡å­˜å‚¨çš„ä½æ•°ï¼Œæ•°æ®å°±è¢«æˆªæ–­ï¼Œå› æ­¤å­˜åœ¨ä¸¢å¤±ç²¾åº¦çš„å¯èƒ½ã€‚</p><p>æ›´é‡è¦çš„æ˜¯ï¼Œä» MySQL 8.0.17 ç‰ˆæœ¬å¼€å§‹ï¼Œå½“åˆ›å»ºè¡¨ç”¨åˆ°ç±»å‹ Float æˆ– Double æ—¶ï¼Œä¼šæŠ›å‡ºä¸‹é¢çš„è­¦å‘Šï¼šMySQL æé†’ç”¨æˆ·ä¸è¯¥ç”¨ä¸Šè¿°æµ®ç‚¹ç±»å‹ï¼Œç”šè‡³æé†’å°†åœ¨ä¹‹åç‰ˆæœ¬ä¸­åºŸå¼ƒæµ®ç‚¹ç±»å‹ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Specifying number of digits for floating point data types is deprecated and will be removed in a future release
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ã€ç¤ºä¾‹ã€‘ä¸¢å¤±ç²¾åº¦æ¡ˆä¾‹</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- åˆ›å»ºè¡¨</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">\`</span>test<span class="token punctuation">\`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">\`</span>value<span class="token punctuation">\`</span></span> <span class="token keyword">FLOAT</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">insert</span> <span class="token keyword">into</span> test <span class="token keyword">value</span> <span class="token punctuation">(</span><span class="token number">131072.32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">row</span> affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------+</span>
<span class="token operator">|</span> <span class="token keyword">value</span>     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+</span>
<span class="token operator">|</span> <span class="token number">131072.31</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.02</span> sec<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯´æ˜ï¼šç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨ FLOAT ç±»å‹ï¼Œæ˜æ˜ä¿ç•™äº†ä¸¤ä½å°æ•°ã€‚ä½†æ˜¯å†™å…¥çš„æ•°æ®å´ä» <code>131072.32</code> å˜æˆäº† <code>131072.31</code> ã€‚</p><p><code>DECIMAL</code> ç±»å‹æ˜¯ MySQL å®˜æ–¹å”¯ä¸€æŒ‡å®šèƒ½ç²¾ç¡®å­˜å‚¨çš„ç±»å‹ã€‚å› æ­¤ï¼Œå¯¹äºä¸å…è®¸ä¸¢å¤±ç²¾åº¦çš„åœºæ™¯ï¼ˆå¦‚é‡‘é¢æ•°æ®ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ <code>DECIMAL</code> ç±»å‹ã€‚</p><p>ç„¶è€Œï¼Œåœ¨æµ·é‡å¹¶å‘çš„äº’è”ç½‘ä¸šåŠ¡ä¸­ä½¿ç”¨ï¼Œé‡‘é¢å­—æ®µçš„è®¾è®¡å¹¶ä¸æ¨èä½¿ç”¨ <code>DECIMAL</code> ç±»å‹ï¼Œè€Œæ›´æ¨èä½¿ç”¨ <code>BIGINT</code> æ•´å‹ç±»å‹ã€‚è¿™é‡Œä¼šç”¨åˆ°ä¸€ä¸ªå·§æ€ï¼šå°†èµ„é‡‘ç±»å‹çš„æ•°æ®ç”¨åˆ†ä¸ºå•ä½å­˜å‚¨ï¼Œè€Œä¸æ˜¯ç”¨å…ƒä¸ºå•ä½å­˜å‚¨ã€‚å¦‚ 1 å…ƒåœ¨æ•°æ®åº“ä¸­ç”¨æ•´å‹ç±»å‹ 100 å­˜å‚¨ã€‚</p><p>ä¸ºä»€ä¹ˆæ›´æ¨èç”¨ <code>BIGINT</code> å­˜å‚¨é‡‘é’±æ•°æ®ï¼Ÿå› ä¸º <code>DECIMAL</code> æ˜¯ä¸ªå˜é•¿å­—æ®µï¼Œè‹¥è¦å®šä¹‰é‡‘é¢å­—æ®µï¼Œåˆ™å®šä¹‰ä¸º <code>DECIMAL(8,2)</code> æ˜¯è¿œè¿œä¸å¤Ÿçš„ã€‚è¿™æ ·åªèƒ½è¡¨ç¤ºå­˜å‚¨æœ€å¤§å€¼ä¸º 999999.99ï¼Œç™¾ä¸‡çº§çš„èµ„é‡‘å­˜å‚¨ã€‚ç”¨æˆ·çš„é‡‘é¢è‡³å°‘è¦å­˜å‚¨ç™¾äº¿çš„å­—æ®µï¼Œè€Œç»Ÿè®¡å±€çš„ GDP é‡‘é¢å­—æ®µåˆ™å¯èƒ½è¾¾åˆ°æ•°åä¸‡äº¿çº§åˆ«ã€‚ç”¨ç±»å‹ <code>DECIMAL</code> å®šä¹‰ï¼Œä¸å¥½ç»Ÿä¸€ã€‚å¦å¤–é‡è¦çš„æ˜¯ï¼Œç±»å‹ <code>DECIMAL</code> æ˜¯é€šè¿‡äºŒè¿›åˆ¶å®ç°çš„ä¸€ç§ç¼–ç æ–¹å¼ï¼Œè®¡ç®—æ•ˆç‡è¿œä¸å¦‚æ•´å‹æ¥çš„é«˜æ•ˆã€‚å› æ­¤ï¼Œæ¨èä½¿ç”¨ <code>BIGINT</code> æ¥å­˜å‚¨é‡‘é¢ç›¸å…³çš„å­—æ®µã€‚</p>`,17),C={href:"http://blog.leanote.com/post/weibo-007/mysql_float_double_decimal",target:"_blank",rel:"noopener noreferrer"},D=o(`<h3 id="ã€ç®€å•ã€‘å¦‚ä½•å­˜å‚¨-emoji-ğŸ˜ƒ" tabindex="-1"><a class="header-anchor" href="#ã€ç®€å•ã€‘å¦‚ä½•å­˜å‚¨-emoji-ğŸ˜ƒ" aria-hidden="true">#</a> ã€ç®€å•ã€‘å¦‚ä½•å­˜å‚¨ emoji ğŸ˜ƒï¼Ÿ</h3><p>åœ¨è¡¨ç»“æ„è®¾è®¡ä¸­ï¼Œé™¤äº†å°†åˆ—å®šä¹‰ä¸º <code>CHAR</code> å’Œ <code>VARCHAR</code> ç”¨ä»¥å­˜å‚¨å­—ç¬¦ä»¥å¤–ï¼Œè¿˜éœ€è¦é¢å¤–å®šä¹‰å­—ç¬¦å¯¹åº”çš„å­—ç¬¦é›†ï¼Œå› ä¸ºæ¯ç§å­—ç¬¦åœ¨ä¸åŒå­—ç¬¦é›†ç¼–ç ä¸‹ï¼Œå¯¹åº”ç€ä¸åŒçš„äºŒè¿›åˆ¶å€¼ã€‚å¸¸è§çš„å­—ç¬¦é›†æœ‰ <code>gbk</code>ã€<code>utf8</code>ï¼Œé€šå¸¸æ¨èæŠŠé»˜è®¤å­—ç¬¦é›†è®¾ç½®ä¸º <code>utf8</code>ã€‚</p><p>éšç€ç§»åŠ¨äº’è”ç½‘çš„é£é€Ÿå‘å±•ï¼Œ<strong>æ¨èæŠŠ MySQL çš„é»˜è®¤å­—ç¬¦é›†è®¾ç½®ä¸º <code>utf8mb4</code></strong>ï¼Œå¦åˆ™ï¼ŒæŸäº› emoji è¡¨æƒ…å­—ç¬¦æ— æ³•åœ¨ UTF8 å­—ç¬¦é›†ä¸‹å­˜å‚¨ã€‚</p><p>ã€ç¤ºä¾‹ã€‘è®¾ç½®è¡¨çš„å­—ç¬¦é›†ä¸º <code>utf8mb4</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> test <span class="token keyword">CHARSET</span> utf8mb4<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>æ³¨æ„ï¼šä¸Šè¿°ä¿®æ”¹åªæ˜¯å°†è¡¨çš„å­—ç¬¦é›†ä¿®æ”¹ä¸º <code>utf8mb4</code>ï¼Œä¸‹æ¬¡æ–°å¢åˆ—æ—¶ï¼Œè‹¥ä¸æ˜¾å¼åœ°æŒ‡å®šå­—ç¬¦é›†ï¼Œæ–°åˆ—çš„å­—ç¬¦é›†ä¼šå˜æ›´ä¸º <code>utf8mb4</code>ï¼Œ<strong>ä½†å¯¹äºå·²ç»å­˜åœ¨çš„åˆ—ï¼Œå…¶é»˜è®¤å­—ç¬¦é›†å¹¶ä¸åšä¿®æ”¹</strong>ã€‚</p></blockquote><p>ã€ç¤ºä¾‹ã€‘è®¾ç½®è¡¨çš„é»˜è®¤å­—ç¬¦é›†ä¸º <code>utf8mb4</code></p><p>æ­£ç¡®è®¾ç½® <code>utf8mb4</code> å­—ç¬¦é›†æ–¹æ³•å¦‚ä¸‹ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> test <span class="token keyword">CONVERT</span> <span class="token keyword">TO</span> <span class="token keyword">CHARSET</span> utf8mb4<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="ã€ç®€å•ã€‘æ—¶é—´æ•°æ®é€‰æ‹©-datetime-è¿˜æ˜¯-timestamp" tabindex="-1"><a class="header-anchor" href="#ã€ç®€å•ã€‘æ—¶é—´æ•°æ®é€‰æ‹©-datetime-è¿˜æ˜¯-timestamp" aria-hidden="true">#</a> ã€ç®€å•ã€‘æ—¶é—´æ•°æ®é€‰æ‹© DATETIME è¿˜æ˜¯ TIMESTAMPï¼Ÿ</h3><p>è¡¨ç»“æ„è®¾è®¡æ—¶ï¼Œå¯¹æ—¶é—´å­—æ®µçš„å­˜å‚¨ï¼Œé€šå¸¸ä¼šæœ‰ 3 ç§é€‰æ‹©ï¼š<code>DATETIME</code>ã€<code>TIMESTAMP</code>ã€<code>INT</code>ã€‚</p><p><code>DATETIME</code>ã€<code>TIMESTAMP</code>ã€<code>INT</code> æ•°æ®è¡¨ç¤ºèŒƒå›´ï¼š</p><ul><li><code>DATETIME</code> å ç”¨ 8 ä¸ªå­—èŠ‚ï¼Œå¯è¡¨ç¤ºèŒƒå›´ä¸ºï¼š<code>1000-01-01 00:00:00.000000</code> åˆ° <code>9999-12-31 23:59:59.999999</code></li><li><code>TIMESTAMP</code> å ç”¨ 4 ä¸ªå­—èŠ‚ï¼Œå¯è¡¨ç¤ºèŒƒå›´ä¸ºï¼š<code>&#39;1970-01-01 00:00:01.000000&#39; UTC</code> åˆ° <code>&#39;2038-01-09 03:14:07.999999&#39; UTC</code>ã€‚è¡¨ç¤ºä» <code>1970-01-01 00:00:00</code> åˆ°ç°åœ¨çš„æ¯«ç§’æ•°ã€‚</li><li><code>INT</code> ç±»å‹å°±æ˜¯ç›´æ¥å­˜å‚¨ â€˜1970-01-01 00:00:00â€™ åˆ°ç°åœ¨çš„æ¯«ç§’æ•°ï¼Œæœ¬è´¨å’Œ <code>TIMESTAMP</code> ä¸€æ ·ï¼Œå› æ­¤ç”¨ <code>INT</code> ä¸å¦‚ç›´æ¥ä½¿ç”¨ <code>TIMESTAMP</code>ã€‚</li></ul><p>æ­¤å¤–ï¼Œ<code>TIMESTAMP</code> è¿˜å­˜åœ¨æ½œåœ¨çš„æ€§èƒ½é—®é¢˜ã€‚è™½ç„¶ä»æ¯«ç§’æ•°è½¬æ¢åˆ°ç±»å‹ <code>TIMESTAMP</code> æœ¬èº«éœ€è¦çš„ CPU æŒ‡ä»¤å¹¶ä¸å¤šï¼Œè¿™å¹¶ä¸ä¼šå¸¦æ¥ç›´æ¥çš„æ€§èƒ½é—®é¢˜ã€‚ä½†æ˜¯å¦‚æœä½¿ç”¨é»˜è®¤çš„æ“ä½œç³»ç»Ÿæ—¶åŒºï¼Œåˆ™æ¯æ¬¡é€šè¿‡æ—¶åŒºè®¡ç®—æ—¶é—´æ—¶ï¼Œè¦è°ƒç”¨æ“ä½œç³»ç»Ÿåº•å±‚ç³»ç»Ÿå‡½æ•° <code>__tz_convert()</code>ï¼Œè€Œè¿™ä¸ªå‡½æ•°éœ€è¦é¢å¤–çš„åŠ é”æ“ä½œï¼Œä»¥ç¡®ä¿è¿™æ—¶æ“ä½œç³»ç»Ÿæ—¶åŒºæ²¡æœ‰ä¿®æ”¹ã€‚æ‰€ä»¥ï¼Œå½“å¤§è§„æ¨¡å¹¶å‘è®¿é—®æ—¶ï¼Œç”±äºçƒ­ç‚¹èµ„æºç«äº‰ï¼Œä¼šäº§ç”Ÿä¸¤ä¸ªé—®é¢˜ã€‚</p><ul><li><strong>æ€§èƒ½ä¸å¦‚ DATETIMEï¼š</strong> <code>DATETIME</code> ä¸å­˜åœ¨æ—¶åŒºè½¬åŒ–é—®é¢˜ã€‚</li><li><strong>æ€§èƒ½æŠ–åŠ¨ï¼š</strong> æµ·é‡å¹¶å‘æ—¶ï¼Œå­˜åœ¨æ€§èƒ½æŠ–åŠ¨é—®é¢˜ã€‚</li></ul><p>ä¸ºäº†ä¼˜åŒ– TIMESTAMP çš„ä½¿ç”¨ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨æ˜¾å¼çš„æ—¶åŒºï¼Œè€Œä¸æ˜¯æ“ä½œç³»ç»Ÿæ—¶åŒºã€‚æ¯”å¦‚åœ¨é…ç½®æ–‡ä»¶ä¸­æ˜¾ç¤ºåœ°è®¾ç½®æ—¶åŒºï¼Œè€Œä¸è¦ä½¿ç”¨ç³»ç»Ÿæ—¶åŒº</p><p>ç»¼ä¸Šï¼Œç”±äº <code>TIMESTAMP</code> å­˜åœ¨æ—¶é—´ä¸Šé™å’Œæ½œåœ¨æ€§èƒ½é—®é¢˜ï¼Œæ‰€ä»¥æ¨èä½¿ç”¨ <code>DATETIME</code> ç±»å‹æ¥å­˜å‚¨æ—¶é—´å­—æ®µã€‚</p><h2 id="mysql-å­˜å‚¨" tabindex="-1"><a class="header-anchor" href="#mysql-å­˜å‚¨" aria-hidden="true">#</a> MySQL å­˜å‚¨</h2>`,18),B=n("p",null,"æ‰©å±•é˜…è¯»ï¼š",-1),U={href:"https://dev.mysql.com/doc/refman/8.4/en/innodb-storage-engine.html",target:"_blank",rel:"noopener noreferrer"},P={href:"https://dev.mysql.com/doc/refman/8.4/en/storage-engines.html",target:"_blank",rel:"noopener noreferrer"},F=o('<h3 id="ã€ä¸­ç­‰ã€‘mysql-æ”¯æŒå“ªäº›å­˜å‚¨å¼•æ“" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘mysql-æ”¯æŒå“ªäº›å­˜å‚¨å¼•æ“" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘MySQL æ”¯æŒå“ªäº›å­˜å‚¨å¼•æ“ï¼Ÿ</h3><p><strong>å­˜å‚¨å¼•æ“å±‚è´Ÿè´£æ•°æ®çš„å­˜å‚¨å’Œæå–</strong>ã€‚MySQL çš„å­˜å‚¨å¼•æ“é‡‡ç”¨äº†æ’æ‹”å¼æ¶æ„ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æ›¿æ¢ã€‚</p><p>MySQL å†…ç½®äº†ä»¥ä¸‹å­˜å‚¨å¼•æ“ï¼š</p><ul><li><strong>InnoDB</strong> - InnoDB æ˜¯ MySQL 5.5 ç‰ˆæœ¬ä»¥åçš„é»˜è®¤å­˜å‚¨å¼•æ“ã€‚ <ul><li>ä¼˜ç‚¹ï¼šæ”¯æŒ<strong>äº‹åŠ¡</strong>ï¼Œæ”¯æŒ<strong>è¡Œçº§é”</strong>ï¼Œæ”¯æŒ<strong>å¤–é”®çº¦æŸ</strong>ç­‰ï¼Œ<strong>å¹¶å‘æ€§èƒ½ä¸é”™</strong>ä¸”æ”¯æŒ<strong>è‡ªåŠ¨æ•…éšœæ¢å¤</strong>ã€‚</li></ul></li><li><strong>MyISAM</strong> - MyISAM æ˜¯ MySQL 5.5 ç‰ˆæœ¬ä»¥å‰çš„é»˜è®¤å­˜å‚¨å¼•æ“ã€‚ <ul><li>ä¼˜ç‚¹ï¼šé€Ÿåº¦å¿«ï¼Œå ç”¨èµ„æºå°‘ã€‚</li><li>ç¼ºç‚¹ï¼šä¸æ”¯æŒäº‹åŠ¡ï¼Œä¸æ”¯æŒè¡Œçº§é”ï¼Œä¸æ”¯æŒå¤–é”®çº¦æŸï¼Œä¹Ÿä¸æ”¯æŒè‡ªåŠ¨æ•…éšœæ¢å¤åŠŸèƒ½ã€‚</li></ul></li><li><strong>Memory</strong> - ä½¿ç”¨ç³»ç»Ÿå†…å­˜ä½œä¸ºå­˜å‚¨ä»‹è´¨ï¼Œä»¥ä¾¿å¾—åˆ°æ›´å¿«çš„å“åº”é€Ÿåº¦ã€‚ä¸è¿‡ï¼Œå¦‚æœ mysqld è¿›ç¨‹å´©æºƒï¼Œåˆ™ä¼šå¯¼è‡´æ‰€æœ‰çš„æ•°æ®ä¸¢å¤±ã€‚å› æ­¤ï¼ŒMemory å¼•æ“å¸¸ç”¨äºä¸´æ—¶è¡¨ã€‚</li><li><strong>NDB</strong> - ä¹Ÿè¢«ç§°ä¸º NDB Cluster å­˜å‚¨å¼•æ“ï¼Œä¸»è¦ç”¨äº MySQL Cluster åˆ†å¸ƒå¼é›†ç¾¤ç¯å¢ƒï¼Œç±»ä¼¼äº Oracle çš„ RAC é›†ç¾¤ã€‚</li><li><strong>Archive</strong> - Archive å­˜å‚¨å¼•æ“æœ‰å¾ˆå¥½çš„å‹ç¼©æœºåˆ¶ï¼Œéå¸¸é€‚åˆç”¨äºå½’æ¡£æ•°æ®ã€‚ <ul><li>Archive å­˜å‚¨å¼•æ“åªæ”¯æŒ <code>INSERT</code> å’Œ <code>SELECT</code> æ“ä½œã€‚</li><li>Archive å­˜å‚¨å¼•æ“é‡‡ç”¨ zlib ç®—æ³•å‹ç¼©æ•°æ®ï¼Œå‹ç¼©æ¯”å¯è¾¾åˆ° 1: 10ã€‚</li></ul></li><li><strong>CSV</strong> - å¯ä»¥å°† CSV æ–‡ä»¶ä½œä¸º MySQL çš„è¡¨æ¥å¤„ç†ï¼Œä½†è¿™ç§è¡¨ä¸æ”¯æŒç´¢å¼•ã€‚</li></ul><figure><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/202503210712752.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="ã€ä¸­ç­‰ã€‘innodb-å’Œ-myisam-æœ‰å“ªäº›å·®å¼‚" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘innodb-å’Œ-myisam-æœ‰å“ªäº›å·®å¼‚" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘InnoDB å’Œ MyISAM æœ‰å“ªäº›å·®å¼‚ï¼Ÿ</h3><table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>MyISAM</th><th>InnoDB</th></tr></thead><tbody><tr><td>å¤–é”®</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td>äº‹åŠ¡</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒå››ç§äº‹åŠ¡éš”ç¦»çº§åˆ«</td></tr><tr><td>é”ç²’åº¦</td><td>æ”¯æŒè¡¨çº§é”</td><td>æ”¯æŒè¡¨çº§é”ã€è¡Œçº§é”</td></tr><tr><td>ç´¢å¼•</td><td>é‡‡ç”¨ B+ æ ‘ç´¢å¼•ï¼ˆéèšç°‡ç´¢å¼•ï¼‰</td><td>é‡‡ç”¨ B+ æ ‘ç´¢å¼•ï¼ˆèšç°‡ç´¢å¼•ï¼‰</td></tr><tr><td>è¡¨ç©ºé—´</td><td>å°</td><td>å¤§</td></tr><tr><td>å…³æ³¨ç‚¹</td><td>æ€§èƒ½</td><td>äº‹åŠ¡</td></tr><tr><td>è®¡æ•°å™¨</td><td>ç»´æŠ¤äº†è®¡æ•°å™¨ï¼Œ<code>SELECT COUNT(*)</code> æ•ˆç‡ä¸º <code>O(1)</code></td><td>æ²¡æœ‰ç»´æŠ¤è®¡æ•°å™¨ï¼Œéœ€è¦å…¨è¡¨æ‰«æ</td></tr><tr><td>è‡ªåŠ¨æ•…éšœæ¢å¤</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒï¼ˆä¾èµ–äº redo logï¼‰</td></tr></tbody></table><h3 id="ã€ä¸­ç­‰ã€‘å¦‚ä½•é€‰æ‹©-mysql-å­˜å‚¨å¼•æ“" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘å¦‚ä½•é€‰æ‹©-mysql-å­˜å‚¨å¼•æ“" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘å¦‚ä½•é€‰æ‹© MySQL å­˜å‚¨å¼•æ“ï¼Ÿ</h3><ul><li>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½¿ç”¨é»˜è®¤çš„ InnoDB å°±å¤Ÿäº†ã€‚å¦‚æœè¦æä¾›æäº¤ã€å›æ»šå’Œæ¢å¤çš„äº‹åŠ¡å®‰å…¨ï¼ˆACID å…¼å®¹ï¼‰èƒ½åŠ›ï¼Œå¹¶è¦æ±‚å®ç°å¹¶å‘æ§åˆ¶ï¼ŒInnoDB å°±æ˜¯æ¯”è¾ƒé å‰çš„é€‰æ‹©äº†ã€‚</li><li>å¦‚æœæ•°æ®è¡¨ä¸»è¦ç”¨æ¥æ’å…¥å’ŒæŸ¥è¯¢è®°å½•ï¼Œåˆ™ MyISAM å¼•æ“æä¾›è¾ƒé«˜çš„å¤„ç†æ•ˆç‡ã€‚</li><li>å¦‚æœåªæ˜¯ä¸´æ—¶å­˜æ”¾æ•°æ®ï¼Œæ•°æ®é‡ä¸å¤§ï¼Œå¹¶ä¸”ä¸éœ€è¦è¾ƒé«˜çš„æ•°æ®å®‰å…¨æ€§ï¼Œå¯ä»¥é€‰æ‹©å°†æ•°æ®ä¿å­˜åœ¨å†…å­˜çš„ MEMORY å¼•æ“ä¸­ã€‚MySQL ä¸­ä½¿ç”¨è¯¥å¼•æ“ä½œä¸ºä¸´æ—¶è¡¨ï¼Œå­˜æ”¾æŸ¥è¯¢çš„ä¸­é—´ç»“æœã€‚</li><li>å¦‚æœå­˜å‚¨å½’æ¡£æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ ARCHIVE å¼•æ“ã€‚</li></ul><p>ä½¿ç”¨å“ªä¸€ç§å¼•æ“å¯ä»¥æ ¹æ®éœ€è¦çµæ´»é€‰æ‹©ï¼Œå› ä¸ºå­˜å‚¨å¼•æ“æ˜¯åŸºäºè¡¨çš„ï¼Œæ‰€ä»¥ä¸€ä¸ªæ•°æ®åº“ä¸­å¤šä¸ªè¡¨å¯ä»¥ä½¿ç”¨ä¸åŒçš„å¼•æ“ä»¥æ»¡è¶³å„ç§æ€§èƒ½å’Œå®é™…éœ€æ±‚ã€‚ä½¿ç”¨åˆé€‚çš„å­˜å‚¨å¼•æ“å°†ä¼šæé«˜æ•´ä¸ªæ•°æ®åº“çš„æ€§èƒ½ã€‚</p><h3 id="ã€ä¸­ç­‰ã€‘mysql-æœ‰å“ªäº›ç‰©ç†å­˜å‚¨æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘mysql-æœ‰å“ªäº›ç‰©ç†å­˜å‚¨æ–‡ä»¶" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘MySQL æœ‰å“ªäº›ç‰©ç†å­˜å‚¨æ–‡ä»¶ï¼Ÿ</h3><p>MySQL ä¸åŒå­˜å‚¨å¼•æ“çš„ç‰©ç†å­˜å‚¨æ–‡ä»¶æ˜¯ä¸ä¸€æ ·çš„ã€‚</p><p>InnoDB çš„ç‰©ç†æ–‡ä»¶ç»“æ„ä¸ºï¼š</p><ul><li><code>.frm</code> æ–‡ä»¶ï¼šä¸è¡¨ç›¸å…³çš„å…ƒæ•°æ®ä¿¡æ¯éƒ½å­˜æ”¾åœ¨ frm æ–‡ä»¶ï¼ŒåŒ…æ‹¬è¡¨ç»“æ„çš„å®šä¹‰ä¿¡æ¯ç­‰ã€‚</li><li><code>.ibd</code> æ–‡ä»¶æˆ– <code>.ibdata</code> æ–‡ä»¶ï¼š è¿™ä¸¤ç§æ–‡ä»¶éƒ½æ˜¯å­˜æ”¾ InnoDB æ•°æ®çš„æ–‡ä»¶ï¼Œä¹‹æ‰€ä»¥æœ‰ä¸¤ç§æ–‡ä»¶å½¢å¼å­˜æ”¾ InnoDB çš„æ•°æ®ï¼Œæ˜¯å› ä¸º InnoDB çš„æ•°æ®å­˜å‚¨æ–¹å¼èƒ½å¤Ÿé€šè¿‡é…ç½®æ¥å†³å®šæ˜¯ä½¿ç”¨<strong>å…±äº«è¡¨ç©ºé—´</strong>å­˜æ”¾å­˜å‚¨æ•°æ®ï¼Œè¿˜æ˜¯ç”¨<strong>ç‹¬äº«è¡¨ç©ºé—´</strong>å­˜æ”¾å­˜å‚¨æ•°æ®ã€‚ <ul><li>ç‹¬äº«è¡¨ç©ºé—´å­˜å‚¨æ–¹å¼ä½¿ç”¨<code>.ibd</code>æ–‡ä»¶ï¼Œå¹¶ä¸”æ¯ä¸ªè¡¨ä¸€ä¸ª<code>.ibd</code>æ–‡ä»¶</li><li>å…±äº«è¡¨ç©ºé—´å­˜å‚¨æ–¹å¼ä½¿ç”¨<code>.ibdata</code>æ–‡ä»¶ï¼Œæ‰€æœ‰è¡¨å…±åŒä½¿ç”¨ä¸€ä¸ª<code>.ibdata</code>æ–‡ä»¶ï¼ˆæˆ–å¤šä¸ªï¼Œå¯è‡ªå·±é…ç½®ï¼‰</li></ul></li></ul><figure><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/202311070640589.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>MyISAM çš„ç‰©ç†æ–‡ä»¶ç»“æ„ä¸ºï¼š</p><ul><li><code>.frm</code>æ–‡ä»¶ï¼šä¸è¡¨ç›¸å…³çš„å…ƒæ•°æ®ä¿¡æ¯éƒ½å­˜æ”¾åœ¨ frm æ–‡ä»¶ï¼ŒåŒ…æ‹¬è¡¨ç»“æ„çš„å®šä¹‰ä¿¡æ¯ç­‰ã€‚</li><li><code>.MYD</code> (<code>MYData</code>) æ–‡ä»¶ï¼šMyISAM å­˜å‚¨å¼•æ“ä¸“ç”¨ï¼Œç”¨äºå­˜å‚¨ MyISAM è¡¨çš„æ•°æ®ã€‚</li><li><code>.MYI</code> (<code>MYIndex</code>) æ–‡ä»¶ï¼šMyISAM å­˜å‚¨å¼•æ“ä¸“ç”¨ï¼Œç”¨äºå­˜å‚¨ MyISAM è¡¨çš„ç´¢å¼•ç›¸å…³ä¿¡æ¯ã€‚</li></ul><h3 id="ã€ä¸­ç­‰ã€‘ä»€ä¹ˆæ˜¯-buffer-pool" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘ä»€ä¹ˆæ˜¯-buffer-pool" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘ä»€ä¹ˆæ˜¯ Buffer Poolï¼Ÿ</h3><p>Buffer Poolï¼ˆç¼“å†²æ± ï¼‰æ˜¯ MySQL InnoDB å­˜å‚¨å¼•æ“çš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ï¼Œå®ƒæ˜¯æ•°æ®åº“ç³»ç»Ÿä¸­çš„å†…å­˜ç¼“å­˜åŒºåŸŸï¼Œä¸»è¦<strong>ç”¨äºç¼“å­˜è¡¨å’Œç´¢å¼•çš„æ•°æ®</strong>ã€‚</p><figure><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/202311070641009.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>ä¸»è¦ä½œç”¨</strong>ï¼š</p><ol><li><strong>å‡å°‘ç£ç›˜ I/O</strong>ï¼šå°†é¢‘ç¹è®¿é—®çš„æ•°æ®é¡µç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œé¿å…æ¯æ¬¡æŸ¥è¯¢éƒ½è¦ä»ç£ç›˜è¯»å–</li><li><strong>æé«˜æŸ¥è¯¢æ€§èƒ½</strong>ï¼šå†…å­˜è®¿é—®é€Ÿåº¦è¿œå¿«äºç£ç›˜è®¿é—®</li><li><strong>å†™ç¼“å†²</strong>ï¼šå¯¹æ•°æ®çš„ä¿®æ”¹å…ˆåœ¨å†…å­˜ä¸­è¿›è¡Œï¼Œå†é€šè¿‡åå°çº¿ç¨‹å®šæœŸåˆ·æ–°åˆ°ç£ç›˜</li></ol><p><strong>å·¥ä½œåŸç†</strong>ï¼š</p><ul><li>Buffer Pool ä»¥é¡µ (page) ä¸ºå•ä½å­˜å‚¨æ•°æ®ï¼Œé»˜è®¤æ¯é¡µ 16KB</li><li>ä½¿ç”¨ LRU ï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ç®—æ³•ç®¡ç†å†…å­˜é¡µ</li><li>åŒ…å«&quot;å¹´è½»ä»£&quot;å’Œ&quot;è€å¹´ä»£&quot;ä¸¤ä¸ªåŒºåŸŸï¼Œé˜²æ­¢å…¨è¡¨æ‰«ææ±¡æŸ“ç¼“å­˜</li></ul><h3 id="ã€ä¸­ç­‰ã€‘ä»€ä¹ˆæ˜¯-change-buffer" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘ä»€ä¹ˆæ˜¯-change-buffer" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘ä»€ä¹ˆæ˜¯ Change Bufferï¼Ÿ</h3><p>Change Buffer æ˜¯ InnoDB å­˜å‚¨å¼•æ“ä¸­çš„ä¸€ç§å…³é”®ä¼˜åŒ–æœºåˆ¶ï¼Œä¸»è¦<strong>ç”¨äºæé«˜éå”¯ä¸€äºŒçº§ç´¢å¼•çš„å†™æ“ä½œæ€§èƒ½</strong>ã€‚</p><p>Change Buffer æ˜¯ä¸€ç§ç‰¹æ®Šçš„å†…å­˜æ•°æ®ç»“æ„ï¼Œç”¨äºç¼“å­˜å¯¹<strong>éå”¯ä¸€äºŒçº§ç´¢å¼•é¡µ</strong>çš„ä¿®æ”¹æ“ä½œï¼ˆINSERTã€UPDATEã€DELETEï¼‰ï¼Œå½“è¿™äº›ç´¢å¼•é¡µä¸åœ¨ç¼“å†²æ±  (Buffer Pool) ä¸­æ—¶ï¼Œé¿å…ç«‹å³ä»ç£ç›˜è¯»å–ç´¢å¼•é¡µã€‚</p><p><strong>å·¥ä½œåŸç†</strong>ï¼š</p><ul><li><p><strong>å†™æ“ä½œå‘ç”Ÿæ—¶</strong>ï¼šå½“ä¿®æ”¹éå”¯ä¸€äºŒçº§ç´¢å¼•çš„æ•°æ®æ—¶ï¼ŒInnoDB ä¼šæ£€æŸ¥ç›®æ ‡ç´¢å¼•é¡µæ˜¯å¦åœ¨ Buffer Pool ä¸­ã€‚</p></li><li><p>å¦‚æœåœ¨ï¼šç›´æ¥ä¿®æ”¹</p><ul><li>å¦‚æœä¸åœ¨ï¼šå°†ä¿®æ”¹æ“ä½œè®°å½•åˆ° Change Buffer</li></ul></li><li><p><strong>åç»­è¯»å–æ—¶</strong>ï¼šå½“éœ€è¦è¯»å–è¯¥ç´¢å¼•é¡µæ—¶ï¼ŒInnoDB ä¼šå°† Change Buffer ä¸­çš„ä¿®æ”¹ä¸ä»ç£ç›˜è¯»å–çš„åŸå§‹é¡µåˆå¹¶ã€‚</p></li><li><p><strong>åå°åˆå¹¶</strong>ï¼šæœ‰ä¸“é—¨çš„çº¿ç¨‹å®šæœŸå°† Change Buffer ä¸­çš„å˜æ›´åˆå¹¶åˆ°ç£ç›˜ä¸Šçš„ç´¢å¼•é¡µã€‚</p></li></ul><p><strong>ä¼˜åŠ¿</strong></p><ul><li><strong>å‡å°‘ç£ç›˜ I/O</strong>ï¼šé¿å…ä¸ºå†™å…¥æ“ä½œç«‹å³è¯»å–ç´¢å¼•é¡µ</li><li><strong>æé«˜ååé‡</strong>ï¼šå¤šä¸ªå˜æ›´å¯ä»¥åˆå¹¶æ‰§è¡Œ</li><li><strong>å‡å°‘éšæœº I/O</strong>ï¼šå°†éšæœºå†™å…¥è½¬ä¸ºé¡ºåºå†™å…¥</li></ul><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p><ul><li>é€‚ç”¨äº<strong>å†™å¤šè¯»å°‘</strong>çš„éå”¯ä¸€äºŒçº§ç´¢å¼•</li><li>ç‰¹åˆ«é€‚åˆ<strong>å¤§é‡ DML æ“ä½œ</strong>ä½†ç´¢å¼•ä¸å¸¸è¢«æŸ¥è¯¢çš„ä¸šåŠ¡åœºæ™¯</li></ul><p><strong>ä¸é€‚ç”¨åœºæ™¯</strong>ï¼š</p><ul><li>å”¯ä¸€ç´¢å¼•ï¼ˆéœ€è¦ç«‹å³æ£€æŸ¥å”¯ä¸€æ€§çº¦æŸï¼‰</li><li>ç´¢å¼•è¢«é¢‘ç¹æŸ¥è¯¢ï¼ˆä¼šå¯¼è‡´é¢‘ç¹åˆå¹¶æ“ä½œï¼‰</li></ul><p><strong>ç›¸å…³é…ç½®</strong>ï¼š</p><ul><li><code>innodb_change_buffer_max_size</code>ï¼šChange Buffer æœ€å¤§å  Buffer Pool çš„æ¯”ä¾‹ï¼ˆé»˜è®¤ 25%ï¼‰</li><li><code>innodb_change_buffering</code>ï¼šæŒ‡å®šç¼“å†²çš„å˜æ›´ç±»å‹ï¼ˆall/none/inserts/deletes ç­‰ï¼‰</li></ul><h2 id="mysql-æ—¥å¿—" tabindex="-1"><a class="header-anchor" href="#mysql-æ—¥å¿—" aria-hidden="true">#</a> MySQL æ—¥å¿—</h2><h3 id="ã€ç®€å•ã€‘mysql-æœ‰å“ªäº›ç±»å‹çš„æ—¥å¿—" tabindex="-1"><a class="header-anchor" href="#ã€ç®€å•ã€‘mysql-æœ‰å“ªäº›ç±»å‹çš„æ—¥å¿—" aria-hidden="true">#</a> ã€ç®€å•ã€‘MySQL æœ‰å“ªäº›ç±»å‹çš„æ—¥å¿—ï¼Ÿ</h3><p>MySQL æ—¥å¿—æ–‡ä»¶æœ‰å¾ˆå¤šï¼ŒåŒ…æ‹¬ ï¼š</p><ul><li><strong>é”™è¯¯æ—¥å¿—</strong>ï¼ˆerror logï¼‰ï¼šé”™è¯¯æ—¥å¿—æ–‡ä»¶å¯¹ MySQL çš„å¯åŠ¨ã€è¿è¡Œã€å…³é—­è¿‡ç¨‹è¿›è¡Œäº†è®°å½•ï¼Œèƒ½å¸®åŠ©å®šä½ MySQL é—®é¢˜ã€‚</li><li><strong>æ…¢æŸ¥è¯¢æ—¥å¿—</strong>ï¼ˆslow query logï¼‰ï¼šæ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯ç”¨æ¥è®°å½•æ‰§è¡Œæ—¶é—´è¶…è¿‡ long_query_time è¿™ä¸ªå˜é‡å®šä¹‰çš„æ—¶é•¿çš„æŸ¥è¯¢è¯­å¥ã€‚é€šè¿‡æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå¯ä»¥æŸ¥æ‰¾å‡ºå“ªäº›æŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œæ•ˆç‡å¾ˆä½ï¼Œä»¥ä¾¿è¿›è¡Œä¼˜åŒ–ã€‚</li><li><strong>ä¸€èˆ¬æŸ¥è¯¢æ—¥å¿—</strong>ï¼ˆgeneral logï¼‰ï¼šä¸€èˆ¬æŸ¥è¯¢æ—¥å¿—è®°å½•äº†æ‰€æœ‰å¯¹ MySQL æ•°æ®åº“è¯·æ±‚çš„ä¿¡æ¯ï¼Œæ— è®ºè¯·æ±‚æ˜¯å¦æ­£ç¡®æ‰§è¡Œã€‚</li><li><strong>äºŒè¿›åˆ¶æ—¥å¿—</strong>ï¼ˆbin logï¼‰ï¼šå…³äºäºŒè¿›åˆ¶æ—¥å¿—ï¼Œå®ƒè®°å½•äº†æ•°æ®åº“æ‰€æœ‰æ‰§è¡Œçš„ DDL å’Œ DML è¯­å¥ï¼ˆé™¤äº†æ•°æ®æŸ¥è¯¢è¯­å¥ selectã€show ç­‰ï¼‰ï¼Œä»¥äº‹ä»¶å½¢å¼è®°å½•å¹¶ä¿å­˜åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚</li></ul><p>è¿˜æœ‰ä¸¤ä¸ª InnoDB å­˜å‚¨å¼•æ“ç‰¹æœ‰çš„æ—¥å¿—æ–‡ä»¶ï¼š</p><ul><li><strong>é‡åšæ—¥å¿—</strong>ï¼ˆredo logï¼‰ï¼šé‡åšæ—¥å¿—è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒä»¬è®°å½•äº†å¯¹äº InnoDB å­˜å‚¨å¼•æ“çš„äº‹åŠ¡æ—¥å¿—ã€‚</li><li><strong>å›æ»šæ—¥å¿—</strong>ï¼ˆundo logï¼‰ï¼šå›æ»šæ—¥å¿—åŒæ ·ä¹Ÿæ˜¯ InnoDB å¼•æ“æä¾›çš„æ—¥å¿—ï¼Œé¡¾åæ€ä¹‰ï¼Œå›æ»šæ—¥å¿—çš„ä½œç”¨å°±æ˜¯å¯¹æ•°æ®è¿›è¡Œå›æ»šã€‚å½“äº‹åŠ¡å¯¹æ•°æ®åº“è¿›è¡Œä¿®æ”¹ï¼ŒInnoDB å¼•æ“ä¸ä»…ä¼šè®°å½• redo logï¼Œè¿˜ä¼šç”Ÿæˆå¯¹åº”çš„ undo log æ—¥å¿—ï¼›å¦‚æœäº‹åŠ¡æ‰§è¡Œå¤±è´¥æˆ–è°ƒç”¨äº† rollbackï¼Œå¯¼è‡´äº‹åŠ¡éœ€è¦å›æ»šï¼Œå°±å¯ä»¥åˆ©ç”¨ undo log ä¸­çš„ä¿¡æ¯å°†æ•°æ®å›æ»šåˆ°ä¿®æ”¹ä¹‹å‰çš„æ ·å­ã€‚</li></ul><h3 id="ã€ç®€å•ã€‘bin-log-å’Œ-redo-log-æœ‰ä»€ä¹ˆåŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#ã€ç®€å•ã€‘bin-log-å’Œ-redo-log-æœ‰ä»€ä¹ˆåŒºåˆ«" aria-hidden="true">#</a> ã€ç®€å•ã€‘bin log å’Œ redo log æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><ul><li>bin log ä¼šè®°å½•æ‰€æœ‰ä¸æ•°æ®åº“æœ‰å…³çš„æ—¥å¿—è®°å½•ï¼ŒåŒ…æ‹¬ InnoDBã€MyISAM ç­‰å­˜å‚¨å¼•æ“çš„æ—¥å¿—ï¼›è€Œ redo log åªè®° InnoDB å­˜å‚¨å¼•æ“çš„æ—¥å¿—ã€‚</li><li>è®°å½•çš„å†…å®¹ä¸åŒï¼Œbin log è®°å½•çš„æ˜¯å…³äºä¸€ä¸ªäº‹åŠ¡çš„å…·ä½“æ“ä½œå†…å®¹ï¼Œå³è¯¥æ—¥å¿—æ˜¯é€»è¾‘æ—¥å¿—ã€‚è€Œ redo log è®°å½•çš„æ˜¯å…³äºæ¯ä¸ªé¡µï¼ˆPageï¼‰çš„æ›´æ”¹çš„ç‰©ç†æƒ…å†µã€‚</li><li>å†™å…¥çš„æ—¶é—´ä¸åŒï¼Œbin log ä»…åœ¨äº‹åŠ¡æäº¤å‰è¿›è¡Œæäº¤ï¼Œä¹Ÿå°±æ˜¯åªå†™ç£ç›˜ä¸€æ¬¡ã€‚è€Œåœ¨äº‹åŠ¡è¿›è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå´ä¸æ–­æœ‰ redo ertry è¢«å†™å…¥ redo log ä¸­ã€‚</li><li>å†™å…¥çš„æ–¹å¼ä¹Ÿä¸ç›¸åŒï¼Œredo log æ˜¯å¾ªç¯å†™å…¥å’Œæ“¦é™¤ï¼Œbin log æ˜¯è¿½åŠ å†™å…¥ï¼Œä¸ä¼šè¦†ç›–å·²ç»å†™çš„æ–‡ä»¶ã€‚</li></ul><h3 id="ã€ç®€å•ã€‘redo-log-å¦‚ä½•åˆ·ç›˜" tabindex="-1"><a class="header-anchor" href="#ã€ç®€å•ã€‘redo-log-å¦‚ä½•åˆ·ç›˜" aria-hidden="true">#</a> ã€ç®€å•ã€‘redo log å¦‚ä½•åˆ·ç›˜ï¼Ÿ</h3><p>redo log çš„å†™å…¥ä¸æ˜¯ç›´æ¥è½åˆ°ç£ç›˜ï¼Œè€Œæ˜¯åœ¨å†…å­˜ä¸­è®¾ç½®äº†ä¸€ç‰‡ç§°ä¹‹ä¸º redo log buffer çš„è¿ç»­å†…å­˜ç©ºé—´ï¼Œä¹Ÿå°±æ˜¯ redo æ—¥å¿—ç¼“å†²åŒºã€‚</p><p>åœ¨å¦‚ä¸‹çš„ä¸€äº›æƒ…å†µä¸­ï¼Œlog buffer çš„æ•°æ®ä¼šåˆ·å…¥ç£ç›˜ï¼š</p><ul><li>log buffer ç©ºé—´ä¸è¶³æ—¶ï¼šlog buffer çš„å¤§å°æ˜¯æœ‰é™çš„ï¼Œå¦‚æœä¸åœçš„å¾€è¿™ä¸ªæœ‰é™å¤§å°çš„ log buffer é‡Œå¡å…¥æ—¥å¿—ï¼Œå¾ˆå¿«å®ƒå°±ä¼šè¢«å¡«æ»¡ã€‚å¦‚æœå½“å‰å†™å…¥ log buffer çš„ redo æ—¥å¿—é‡å·²ç»å æ»¡äº† log buffer æ€»å®¹é‡çš„å¤§çº¦<strong>ä¸€åŠ</strong>å·¦å³ï¼Œå°±éœ€è¦æŠŠè¿™äº›æ—¥å¿—åˆ·æ–°åˆ°ç£ç›˜ä¸Šã€‚</li><li>äº‹åŠ¡æäº¤æ—¶ï¼šåœ¨äº‹åŠ¡æäº¤æ—¶ï¼Œä¸ºäº†ä¿è¯æŒä¹…æ€§ï¼Œä¼šæŠŠ log buffer ä¸­çš„æ—¥å¿—å…¨éƒ¨åˆ·åˆ°ç£ç›˜ã€‚æ³¨æ„ï¼Œè¿™æ—¶å€™ï¼Œé™¤äº†æœ¬äº‹åŠ¡çš„ï¼Œå¯èƒ½è¿˜ä¼šåˆ·å…¥å…¶å®ƒäº‹åŠ¡çš„æ—¥å¿—ã€‚</li><li>åå°çº¿ç¨‹è¾“å…¥ï¼šæœ‰ä¸€ä¸ªåå°çº¿ç¨‹ï¼Œå¤§çº¦æ¯ç§’éƒ½ä¼šåˆ·æ–°ä¸€æ¬¡<code>log buffer</code>ä¸­çš„<code>redo log</code>åˆ°ç£ç›˜ã€‚</li><li>æ­£å¸¸å…³é—­æœåŠ¡å™¨æ—¶</li><li>è§¦å‘ checkpoint è§„åˆ™</li></ul><p>é‡åšæ—¥å¿—ç¼“å­˜ã€é‡åšæ—¥å¿—æ–‡ä»¶éƒ½æ˜¯ä»¥ <strong>å—ï¼ˆblockï¼‰</strong> çš„æ–¹å¼è¿›è¡Œä¿å­˜çš„ï¼Œç§°ä¹‹ä¸ºã€<strong>é‡åšæ—¥å¿—å—ï¼ˆredo log blockï¼‰</strong>, å—çš„å¤§å°æ˜¯å›ºå®šçš„ 512 å­—èŠ‚ã€‚æˆ‘ä»¬çš„ redo log å®ƒæ˜¯å›ºå®šå¤§å°çš„ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªé€»è¾‘ä¸Šçš„ <strong>log group</strong>ï¼Œç”±ä¸€å®šæ•°é‡çš„ <strong>log block</strong> ç»„æˆã€‚</p><p>å®ƒçš„å†™å…¥æ–¹å¼æ˜¯ä»å¤´åˆ°å°¾å¼€å§‹å†™ï¼Œå†™åˆ°æœ«å°¾åˆå›åˆ°å¼€å¤´å¾ªç¯å†™ã€‚</p><p>å…¶ä¸­æœ‰ä¸¤ä¸ªæ ‡è®°ä½ç½®ï¼š</p><p><code>write pos</code>æ˜¯å½“å‰è®°å½•çš„ä½ç½®ï¼Œä¸€è¾¹å†™ä¸€è¾¹åç§»ï¼Œå†™åˆ°ç¬¬ 3 å·æ–‡ä»¶æœ«å°¾åå°±å›åˆ° 0 å·æ–‡ä»¶å¼€å¤´ã€‚<code>checkpoint</code>æ˜¯å½“å‰è¦æ“¦é™¤çš„ä½ç½®ï¼Œä¹Ÿæ˜¯å¾€åæ¨ç§»å¹¶ä¸”å¾ªç¯çš„ï¼Œæ“¦é™¤è®°å½•å‰è¦æŠŠè®°å½•æ›´æ–°åˆ°ç£ç›˜ã€‚</p><p>å½“<code>write_pos</code>è¿½ä¸Š<code>checkpoint</code>æ—¶ï¼Œè¡¨ç¤º redo log æ—¥å¿—å·²ç»å†™æ»¡ã€‚è¿™æ—¶å€™å°±ä¸èƒ½æ¥ç€å¾€é‡Œå†™æ•°æ®äº†ï¼Œéœ€è¦æ‰§è¡Œ<code>checkpoint</code>è§„åˆ™è…¾å‡ºå¯å†™ç©ºé—´ã€‚</p><p>æ‰€è°“çš„ <strong>checkpoint è§„åˆ™</strong>ï¼Œå°±æ˜¯ checkpoint è§¦å‘åï¼Œå°† buffer ä¸­æ—¥å¿—é¡µéƒ½åˆ·åˆ°ç£ç›˜ã€‚</p><h3 id="ã€ä¸­ç­‰ã€‘æ—¥å¿—ä¸ºä»€ä¹ˆè¦ä¸¤é˜¶æ®µæäº¤" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘æ—¥å¿—ä¸ºä»€ä¹ˆè¦ä¸¤é˜¶æ®µæäº¤" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘æ—¥å¿—ä¸ºä»€ä¹ˆè¦ä¸¤é˜¶æ®µæäº¤ï¼Ÿ</h3><p>ç”±äº redo log å’Œ binlog æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„é€»è¾‘ï¼Œå¦‚æœä¸ç”¨ä¸¤é˜¶æ®µæäº¤ï¼Œè¦ä¹ˆå°±æ˜¯å…ˆå†™å®Œ redo log å†å†™ binlogï¼Œæˆ–è€…é‡‡ç”¨åè¿‡æ¥çš„é¡ºåºã€‚</p><ol><li><strong>å…ˆå†™ redo log åå†™ binlog</strong>ã€‚å‡è®¾åœ¨ redo log å†™å®Œï¼Œbinlog è¿˜æ²¡æœ‰å†™å®Œçš„æ—¶å€™ï¼ŒMySQL è¿›ç¨‹å¼‚å¸¸é‡å¯ã€‚ç”±äºæˆ‘ä»¬å‰é¢è¯´è¿‡çš„ï¼Œredo log å†™å®Œä¹‹åï¼Œç³»ç»Ÿå³ä½¿å´©æºƒï¼Œä»ç„¶èƒ½å¤ŸæŠŠæ•°æ®æ¢å¤å›æ¥ï¼Œæ‰€ä»¥æ¢å¤åè¿™ä¸€è¡Œ c çš„å€¼æ˜¯ 1ã€‚ <ul><li>ä½†æ˜¯ç”±äº binlog æ²¡å†™å®Œå°± crash äº†ï¼Œè¿™æ—¶å€™ binlog é‡Œé¢å°±æ²¡æœ‰è®°å½•è¿™ä¸ªè¯­å¥ã€‚å› æ­¤ï¼Œä¹‹åå¤‡ä»½æ—¥å¿—çš„æ—¶å€™ï¼Œå­˜èµ·æ¥çš„ binlog é‡Œé¢å°±æ²¡æœ‰è¿™æ¡è¯­å¥ã€‚</li><li>ç„¶åä½ ä¼šå‘ç°ï¼Œå¦‚æœéœ€è¦ç”¨è¿™ä¸ª binlog æ¥æ¢å¤ä¸´æ—¶åº“çš„è¯ï¼Œç”±äºè¿™ä¸ªè¯­å¥çš„ binlog ä¸¢å¤±ï¼Œè¿™ä¸ªä¸´æ—¶åº“å°±ä¼šå°‘äº†è¿™ä¸€æ¬¡æ›´æ–°ï¼Œæ¢å¤å‡ºæ¥çš„è¿™ä¸€è¡Œ c çš„å€¼å°±æ˜¯ 0ï¼Œä¸åŸåº“çš„å€¼ä¸åŒã€‚</li></ul></li><li><strong>å…ˆå†™ binlog åå†™ redo log</strong>ã€‚å¦‚æœåœ¨ binlog å†™å®Œä¹‹å crashï¼Œç”±äº redo log è¿˜æ²¡å†™ï¼Œå´©æºƒæ¢å¤ä»¥åè¿™ä¸ªäº‹åŠ¡æ— æ•ˆï¼Œæ‰€ä»¥è¿™ä¸€è¡Œ c çš„å€¼æ˜¯ 0ã€‚ä½†æ˜¯ binlog é‡Œé¢å·²ç»è®°å½•äº†â€œæŠŠ c ä» 0 æ”¹æˆ 1â€è¿™ä¸ªæ—¥å¿—ã€‚æ‰€ä»¥ï¼Œåœ¨ä¹‹åç”¨ binlog æ¥æ¢å¤çš„æ—¶å€™å°±å¤šäº†ä¸€ä¸ªäº‹åŠ¡å‡ºæ¥ï¼Œæ¢å¤å‡ºæ¥çš„è¿™ä¸€è¡Œ c çš„å€¼å°±æ˜¯ 1ï¼Œä¸åŸåº“çš„å€¼ä¸åŒã€‚</li></ol><p>å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœä¸ä½¿ç”¨â€œä¸¤é˜¶æ®µæäº¤â€ï¼Œé‚£ä¹ˆæ•°æ®åº“çš„çŠ¶æ€å°±æœ‰å¯èƒ½å’Œç”¨å®ƒçš„æ—¥å¿—æ¢å¤å‡ºæ¥çš„åº“çš„çŠ¶æ€ä¸ä¸€è‡´ã€‚</p><h3 id="ã€ä¸­ç­‰ã€‘ä»€ä¹ˆæ˜¯-wal" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘ä»€ä¹ˆæ˜¯-wal" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘ä»€ä¹ˆæ˜¯ WALï¼Ÿ</h3><p>WALï¼ˆWrite-Ahead Loggingï¼‰æ˜¯ä¸€ç§æ•°æ®åº“äº‹åŠ¡æ—¥å¿—ç®¡ç†æŠ€æœ¯ï¼Œç¡®ä¿åœ¨ä¿®æ”¹æ•°æ®ä¹‹å‰å…ˆå°†ä¿®æ”¹è®°å½•å†™å…¥æ—¥å¿—ã€‚å®ƒçš„å…³é”®ç‚¹å°±æ˜¯ <strong>å…ˆå†™æ—¥å¿—ï¼Œå†å†™ç£ç›˜</strong>ã€‚</p><p>WAL æ˜¯ä¸€ç§é€šç”¨æŠ€æœ¯ï¼Œè¢«å¹¿æ³›åº”ç”¨äºå„ç§æ•°æ®åº“ï¼Œä½†å®ç°å„æœ‰ä¸åŒã€‚åœ¨ InnoDB ä¸­ï¼Œredo log å°±æ˜¯ WAL çš„å®ç°ã€‚</p><p>å¤§è‡´æµç¨‹ä¸ºï¼š</p><ul><li>äº‹åŠ¡å¼€å§‹æ—¶ï¼Œä¿®æ”¹è®°å½•åˆ° redo log ç¼“å†²åŒºã€‚</li><li>redo log ç¼“å†²åŒºçš„æ•°æ®å‘¨æœŸæ€§åˆ·æ–°åˆ°ç£ç›˜ä¸Šçš„ redo log æ–‡ä»¶ã€‚</li><li>äº‹åŠ¡æäº¤æ—¶ï¼Œç¡®ä¿ redo log å·²å†™å…¥ç£ç›˜ï¼Œç„¶åå°†æ•°æ®é¡µçš„ä¿®æ”¹å†™å…¥æ•°æ®æ–‡ä»¶ã€‚</li><li>ç³»ç»Ÿå´©æºƒæ—¶ï¼Œé€šè¿‡ redo log é‡æ–°åº”ç”¨æœªå®Œæˆçš„äº‹åŠ¡ï¼Œæ¢å¤æ•°æ®åº“åˆ°ä¸€è‡´çŠ¶æ€ã€‚</li></ul><h3 id="ã€ä¸­ç­‰ã€‘ä»€ä¹ˆæ˜¯-log-buffer" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘ä»€ä¹ˆæ˜¯-log-buffer" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘ä»€ä¹ˆæ˜¯ Log Bufferï¼Ÿ</h3><p><strong>Log Buffer</strong> ç”¨äºç¼“å†² redo log çš„å†™å…¥ï¼Œå‡å°‘é¢‘ç¹åˆ·ç›˜ fsync çš„å¼€é”€ï¼Œå°†å¤šæ¬¡å†™å…¥ä¼˜åŒ–ä¸ºä¸€æ¬¡æ‰¹é‡å†™å…¥ã€‚</p><p>redo log æ˜¯ InnoDB çš„é‡åšæ—¥å¿—ï¼Œç”¨äºå´©æºƒæ¢å¤ï¼Œç¡®ä¿æ•°æ®æ­£ç¡®æ€§ã€‚redo log é‡‡ç”¨ WAL æœºåˆ¶ï¼šå…ˆå†™æ—¥å¿—ï¼Œå†å†™ç£ç›˜æ•°æ®ï¼Œå°†éšæœºå†™å…¥è½¬æ¢ä¸ºé¡ºåºå†™å…¥ã€‚</p><figure><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/202311070641668.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>Log Buffer çš„åˆ·ç›˜æ—¶æœº</strong></p><ul><li><strong>äº‹åŠ¡æäº¤æ—¶</strong>ï¼šäº‹åŠ¡äº§ç”Ÿçš„å¤šæ¡ redo log ä¼šå…ˆç¼“å­˜åœ¨ Log Bufferï¼Œæäº¤æ—¶ä¸€æ¬¡æ€§å†™å…¥æ–‡ä»¶ï¼ˆå—é…ç½®å‚æ•°æ§åˆ¶ï¼‰ã€‚</li><li><strong>å®¹é‡è§¦å‘</strong>ï¼šå½“ Log Buffer è¶…è¿‡æ€»å®¹é‡çš„ä¸€åŠï¼ˆé»˜è®¤ 16MBï¼‰æ—¶è‡ªåŠ¨åˆ·ç›˜ã€‚</li><li><strong>åå°çº¿ç¨‹</strong>ï¼šæ¯éš” 1 ç§’å®šæ—¶åˆ·ç›˜ã€‚</li></ul><p><strong>é…ç½®å‚æ•°<code>innodb_flush_log_at_trx_commit</code></strong></p><ul><li><strong>0</strong>ï¼šäº‹åŠ¡æäº¤ä¸åˆ·ç›˜ï¼Œä¾èµ–åå°çº¿ç¨‹æ¯ç§’åˆ·ç›˜ã€‚æ€§èƒ½æœ€ä½³ï¼Œä½†å¯èƒ½ä¸¢å¤± 1 ç§’æ•°æ®ã€‚</li><li><strong>1</strong>ï¼ˆé»˜è®¤ï¼‰ï¼šäº‹åŠ¡æäº¤æ—¶åŒæ­¥åˆ·ç›˜ï¼ˆå†™ OS cache å¹¶è°ƒç”¨ fsyncï¼‰ã€‚æ•°æ®æœ€å®‰å…¨ï¼Œæ€§èƒ½æœ€å·®ã€‚</li><li><strong>2</strong>ï¼šäº‹åŠ¡æäº¤æ—¶ä»…å†™ OS cacheï¼Œåå°çº¿ç¨‹æ¯ç§’è°ƒç”¨ fsyncã€‚æ€§èƒ½æŠ˜ä¸­ï¼ŒæœåŠ¡å™¨å®•æœºå¯èƒ½ä¸¢å¤± 1 ç§’æ•°æ®ã€‚</li></ul><h2 id="mysql-å¤åˆ¶" tabindex="-1"><a class="header-anchor" href="#mysql-å¤åˆ¶" aria-hidden="true">#</a> MySQL å¤åˆ¶</h2><h3 id="ã€ä¸­ç­‰ã€‘mysql-å¦‚ä½•å®ç°ä¸»ä»åŒæ­¥" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘mysql-å¦‚ä½•å®ç°ä¸»ä»åŒæ­¥" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘MySQL å¦‚ä½•å®ç°ä¸»ä»åŒæ­¥ï¼Ÿ</h3><p>å¤åˆ¶è§£å†³çš„åŸºæœ¬é—®é¢˜æ˜¯è®©ä¸€å°æœåŠ¡å™¨çš„æ•°æ®ä¸å…¶ä»–æœåŠ¡å™¨ä¿æŒåŒæ­¥ã€‚ä¸€å°ä¸»åº“çš„æ•°æ®å¯ä»¥åŒæ­¥åˆ°å¤šå°ä»åº“ä¸Šï¼Œä»åº“æœ¬èº«ä¹Ÿå¯ä»¥è¢«é…ç½®æˆå¦å¤–ä¸€å°æœåŠ¡å™¨çš„ä¸»åº“ã€‚ä¸»åº“å’Œä»åº“ä¹‹é—´å¯ä»¥æœ‰å¤šç§ä¸åŒçš„ç»„åˆæ–¹å¼ã€‚</p><p>MySQL å¤åˆ¶é‡‡ç”¨ä¸»ä»åŒæ­¥ï¼ŒåŸºäº <strong>binlogï¼ˆäºŒè¿›åˆ¶æ—¥å¿—ï¼‰</strong> å®ç°ã€‚å…¶æµç¨‹å¤§è‡´ä¸ºï¼š</p><ul><li>ä¸»åº“è®°å½• <strong>DML/DDL</strong> æ“ä½œåˆ° binlogã€‚</li><li>ä»åº“è·å– binlog å¹¶é‡æ”¾ï¼Œä¿æŒæ•°æ®åŒæ­¥ã€‚</li></ul><p>MySQL æ”¯æŒä¸‰ç§å¤åˆ¶æ–¹å¼ï¼šåŒæ­¥ã€å¼‚æ­¥ã€åŠåŒæ­¥ã€‚ä¸‹é¢æ˜¯ä¸‰ç§æ–¹å¼çš„å¯¹æ¯”ï¼š</p><table><thead><tr><th><strong>æ¨¡å¼</strong></th><th><strong>æœºåˆ¶</strong></th><th><strong>ä¼˜ç‚¹</strong></th><th><strong>ç¼ºç‚¹</strong></th></tr></thead><tbody><tr><td><strong>å¼‚æ­¥å¤åˆ¶</strong>ï¼ˆé»˜è®¤ï¼‰</td><td>ä¸»åº“ä¸ç­‰å¾…ä»åº“å“åº”</td><td>é«˜æ€§èƒ½</td><td>æ•°æ®ä¸€è‡´æ€§å¼±ï¼ˆå¯èƒ½ä¸¢å¤±ï¼‰</td></tr><tr><td><strong>åŒæ­¥å¤åˆ¶</strong></td><td>ä¸»åº“ç­‰å¾…æ‰€æœ‰ä»åº“ç¡®è®¤</td><td>å¼ºä¸€è‡´æ€§</td><td>æ€§èƒ½å·®ï¼Œå»¶è¿Ÿé«˜</td></tr><tr><td><strong>åŠåŒæ­¥å¤åˆ¶</strong></td><td>ä¸»åº“ç­‰å¾…è‡³å°‘ä¸€ä¸ªä»åº“ç¡®è®¤</td><td>å¹³è¡¡æ€§èƒ½ä¸ä¸€è‡´æ€§</td><td>æ¯”å¼‚æ­¥ç•¥æ…¢</td></tr></tbody></table><h4 id="å¼‚æ­¥å¤åˆ¶" tabindex="-1"><a class="header-anchor" href="#å¼‚æ­¥å¤åˆ¶" aria-hidden="true">#</a> å¼‚æ­¥å¤åˆ¶</h4><p>MySQL å¼‚æ­¥å¤åˆ¶å¯ä»¥åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼Œåˆ†åˆ«ç”±ä¸‰ä¸ªçº¿ç¨‹å®Œæˆï¼š</p><ul><li><strong>binlog dump çº¿ç¨‹</strong> - ä¸»åº“æ¥æ”¶äº‹åŠ¡è¯·æ±‚ï¼Œæ›´æ–°æ•°æ®ï¼Œå¹¶å³æ—¶å“åº”å®¢æˆ·ç«¯ï¼ˆä¸ç­‰å¾…ä»åº“ï¼‰ã€‚ä¸»åº“ä¸Šæœ‰ä¸€ä¸ªç‰¹æ®Šçš„ binlog dump çº¿ç¨‹ï¼Œè´Ÿè´£å°†ä¸»æœåŠ¡å™¨ä¸Šçš„æ•°æ®æ›´æ”¹å†™å…¥ binlog ä¸­ã€‚</li><li><strong>I/O çº¿ç¨‹</strong> - ä»åº“ä¸Šæœ‰ä¸€ä¸ª I/O çº¿ç¨‹ï¼Œè´Ÿè´£ä»ä¸»åº“ä¸Šè¯»å– binlogï¼Œå¹¶å†™å…¥ä»åº“çš„ä¸­ç»§æ—¥å¿—ï¼ˆrelay logï¼‰ä¸­ã€‚</li><li><strong>SQL çº¿ç¨‹</strong> - ä»åº“ä¸Šæœ‰ä¸€ä¸ª SQL çº¿ç¨‹ï¼Œè´Ÿè´£é‡æ”¾ä¸­ç»§æ—¥å¿—ï¼ˆrelay logï¼‰ï¼Œæ›´æ–°ä»åº“æ•°æ®ã€‚</li></ul><figure><img src="https://raw.githubusercontent.com/dunwu/images/master/cs/database/mysql/master-slave.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>é‡‡ç”¨å¼‚æ­¥å¤åˆ¶æœ‰ä¸¢å¤±æ•°æ®çš„é£é™©</strong>ï¼Œä¸»åº“å´©æºƒæ—¶ï¼ŒæœªåŒæ­¥çš„ binlog å¯èƒ½ä¸¢å¤±ï¼ˆ<strong>å¼±ä¸€è‡´æ€§</strong>ï¼‰ã€‚</p><h4 id="åŒæ­¥å¤åˆ¶" tabindex="-1"><a class="header-anchor" href="#åŒæ­¥å¤åˆ¶" aria-hidden="true">#</a> åŒæ­¥å¤åˆ¶</h4><p>ä¸»åº“å¿…é¡»ç­‰å¾…<strong>æ‰€æœ‰ä»åº“</strong>å®Œæˆ binlog åŒæ­¥åæ‰å“åº”å®¢æˆ·ç«¯ã€‚</p><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>æ•°æ®å¼ºä¸€è‡´æ€§ï¼ˆæ‰€æœ‰èŠ‚ç‚¹å®Œå…¨åŒæ­¥ï¼‰</li><li>æ€§èƒ½æå·®ï¼ˆå»¶è¿Ÿé«˜ï¼Œååé‡ä½ï¼‰</li><li>ç”Ÿäº§ç¯å¢ƒåŸºæœ¬ä¸ä½¿ç”¨</li></ul><h4 id="åŠåŒæ­¥å¤åˆ¶" tabindex="-1"><a class="header-anchor" href="#åŠåŒæ­¥å¤åˆ¶" aria-hidden="true">#</a> åŠåŒæ­¥å¤åˆ¶</h4><p>MySQL 5.7 å¼•å…¥äº†åŠåŒæ­¥å¤åˆ¶ï¼šä¸»åº“åªéœ€ç­‰å¾…<strong>è‡³å°‘ N ä¸ªä»åº“</strong>ï¼ˆå¯é…ç½®ï¼‰ç¡®è®¤å³è¿”å›ã€‚</p><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li><strong>æ€§èƒ½ä¸å¯é æ€§çš„å¹³è¡¡</strong>ï¼ˆæ¯”å…¨åŒæ­¥å¿«ï¼Œæ¯”å¼‚æ­¥å®‰å…¨ï¼‰ã€‚</li><li>ä»…å½“ä¸»åº“å’Œæ‰€æœ‰å·²ç¡®è®¤ä»åº“<strong>åŒæ—¶å´©æºƒ</strong>æ—¶å¯èƒ½ä¸¢æ•°æ®ã€‚</li></ul><h3 id="ã€ä¸­ç­‰ã€‘å¦‚ä½•å¤„ç†-mysql-ä¸»ä»åŒæ­¥å»¶è¿Ÿ" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘å¦‚ä½•å¤„ç†-mysql-ä¸»ä»åŒæ­¥å»¶è¿Ÿ" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘å¦‚ä½•å¤„ç† MySQL ä¸»ä»åŒæ­¥å»¶è¿Ÿï¼Ÿ</h3><p><strong>ä¸»ä»å»¶è¿Ÿçš„å¸¸è§è§£å†³æ–¹æ¡ˆ</strong></p><ul><li><strong>äºŒæ¬¡æŸ¥è¯¢</strong>ï¼ˆå…œåº•ç­–ç•¥ï¼‰ï¼šä»åº“æŸ¥ä¸åˆ°æ—¶ï¼Œå†æŸ¥ä¸»åº“ã€‚ç¼ºç‚¹æ˜¯ï¼šæ¶æ„æŸ¥è¯¢å¯èƒ½å¯¼è‡´ä¸»åº“å‹åŠ›å¢å¤§ã€‚</li><li><strong>å¼ºåˆ¶å†™åè¯»èµ°ä¸»åº“</strong>ï¼šå†™å…¥åç«‹å³è¯»çš„æ“ä½œç»‘å®šèµ°ä¸»åº“ã€‚ç¼ºç‚¹æ˜¯ï¼šä»£ç è€¦åˆï¼Œçµæ´»æ€§å·®ã€‚</li><li><strong>å…³é”®ä¸šåŠ¡è¯»å†™ä¸»åº“ï¼Œéå…³é”®ä¸šåŠ¡è¯»å†™åˆ†ç¦»</strong></li><li><strong>ä½¿ç”¨ç¼“å­˜</strong>ï¼šä¸»åº“å†™å…¥ååŒæ­¥ç¼“å­˜ï¼ŒæŸ¥è¯¢ä¼˜å…ˆæŸ¥ç¼“å­˜ã€‚ç¼ºç‚¹æ˜¯ï¼šå¼•å…¥ç¼“å­˜åï¼Œæ–°å¢äº†ä¸€è‡´æ€§é—®é¢˜ã€‚</li><li><strong>æå‡ä»åº“é…ç½®</strong>ï¼šä¼˜åŒ–ä»åº“ç¡¬ä»¶ï¼ˆCPUã€å†…å­˜ã€ç£ç›˜ç­‰ï¼‰ï¼Œæé«˜åŒæ­¥æ•ˆç‡ã€‚</li></ul><p><strong>MySQL ä¸»ä»å»¶è¿Ÿçš„å¸¸è§åŸå› åŠä¼˜åŒ–æ–¹æ¡ˆ</strong></p><table><thead><tr><th style="text-align:left;"><strong>åŸå› </strong></th><th style="text-align:left;"><strong>ä¼˜åŒ–æ–¹æ¡ˆ</strong></th></tr></thead><tbody><tr><td style="text-align:left;">ä»åº“å•çº¿ç¨‹å¤åˆ¶</td><td style="text-align:left;">å¯ç”¨ <strong>å¹¶è¡Œå¤åˆ¶</strong>ï¼ˆå¤šçº¿ç¨‹åŒæ­¥ï¼‰ã€‚</td></tr><tr><td style="text-align:left;">ç½‘ç»œå»¶è¿Ÿ</td><td style="text-align:left;">ä¼˜åŒ–ç½‘ç»œï¼Œç¼©çŸ­ä¸»ä»ç‰©ç†è·ç¦»ã€‚</td></tr><tr><td style="text-align:left;">ä»åº“æ€§èƒ½ä¸è¶³</td><td style="text-align:left;">å‡çº§ç¡¬ä»¶ï¼ˆCPUã€å†…å­˜ã€å­˜å‚¨ï¼‰ã€‚</td></tr><tr><td style="text-align:left;">é•¿äº‹åŠ¡</td><td style="text-align:left;">å‡å°‘ä¸»åº“é•¿äº‹åŠ¡ï¼Œä¼˜åŒ– SQLã€‚</td></tr><tr><td style="text-align:left;">ä»åº“æ•°é‡è¿‡å¤š</td><td style="text-align:left;">åˆç†æ§åˆ¶ä»åº“æ•°é‡ï¼Œé¿å…ä¸»åº“åŒæ­¥å‹åŠ›è¿‡å¤§ã€‚</td></tr><tr><td style="text-align:left;">ä»åº“æŸ¥è¯¢è´Ÿè½½é«˜</td><td style="text-align:left;">å¢åŠ ä»åº“å®ä¾‹ï¼Œä¼˜åŒ–æ…¢æŸ¥è¯¢ã€‚</td></tr></tbody></table><p><strong>å°ç»“</strong></p><ul><li>ä¸»ä»å»¶è¿Ÿ <strong>æ— æ³•å®Œå…¨é¿å…</strong>ï¼Œåªèƒ½ä¼˜åŒ–é™ä½å»¶è¿Ÿæ—¶é—´ã€‚</li><li>ä¸šåŠ¡å±‚é¢åº”ç»“åˆ <strong>ç¼“å­˜ã€è¯»å†™åˆ†ç¦»ç­–ç•¥ã€å…³é”®ä¸šåŠ¡èµ°ä¸»åº“</strong> ç­‰æ–¹å¼ç»¼åˆè§£å†³ã€‚</li><li>æŠ€æœ¯å±‚é¢å¯ä¼˜åŒ– <strong>å¹¶è¡Œå¤åˆ¶ã€ç½‘ç»œã€ç¡¬ä»¶</strong> ç­‰ã€‚</li></ul><h2 id="mysql-è¯»å†™åˆ†ç¦»-åˆ†åº“åˆ†è¡¨" tabindex="-1"><a class="header-anchor" href="#mysql-è¯»å†™åˆ†ç¦»-åˆ†åº“åˆ†è¡¨" aria-hidden="true">#</a> MySQL è¯»å†™åˆ†ç¦»+åˆ†åº“åˆ†è¡¨</h2><h3 id="ã€ä¸­ç­‰ã€‘å¦‚ä½•å®ç°-mysql-è¯»å†™åˆ†ç¦»" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘å¦‚ä½•å®ç°-mysql-è¯»å†™åˆ†ç¦»" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘å¦‚ä½•å®ç° MySQL è¯»å†™åˆ†ç¦»ï¼Ÿ</h3><p><strong>è¯»å†™åˆ†ç¦»çš„åŸºæœ¬åŸç†æ˜¯ï¼šä¸»æœåŠ¡å™¨ç”¨æ¥å¤„ç†å†™æ“ä½œä»¥åŠå®æ—¶æ€§è¦æ±‚æ¯”è¾ƒé«˜çš„è¯»æ“ä½œï¼Œè€Œä»æœåŠ¡å™¨ç”¨æ¥å¤„ç†è¯»æ“ä½œ</strong>ã€‚</p><blockquote><p>ä¸ºä½•è¦è¯»å†™åˆ†ç¦»ï¼Ÿ</p></blockquote><ul><li><strong>æœ‰æ•ˆå‡å°‘é”ç«äº‰</strong> - ä¸»æœåŠ¡å™¨åªè´Ÿè´£å†™ï¼Œä»æœåŠ¡å™¨åªè´Ÿè´£è¯»ï¼Œèƒ½å¤Ÿæœ‰æ•ˆçš„é¿å…ç”±æ•°æ®æ›´æ–°å¯¼è‡´çš„è¡Œé”ç«äº‰ï¼Œä½¿å¾—æ•´ä¸ªç³»ç»Ÿçš„æŸ¥è¯¢æ€§èƒ½å¾—åˆ°æå¤§çš„æ”¹å–„ã€‚</li><li><strong>æé«˜æŸ¥è¯¢ååé‡</strong> - é€šè¿‡ä¸€ä¸»å¤šä»çš„é…ç½®æ–¹å¼ï¼Œå¯ä»¥å°†æŸ¥è¯¢è¯·æ±‚å‡åŒ€çš„åˆ†æ•£åˆ°å¤šä¸ªæ•°æ®å‰¯æœ¬ï¼Œèƒ½å¤Ÿè¿›ä¸€æ­¥çš„æå‡ç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›ã€‚</li><li><strong>æå‡æ•°æ®åº“å¯ç”¨æ€§</strong> - ä½¿ç”¨å¤šä¸»å¤šä»çš„æ–¹å¼ï¼Œä¸ä½†èƒ½å¤Ÿæå‡ç³»ç»Ÿçš„ååé‡ï¼Œè¿˜èƒ½å¤Ÿæå‡æ•°æ®åº“çš„å¯ç”¨æ€§ï¼Œå¯ä»¥è¾¾åˆ°åœ¨ä»»ä½•ä¸€ä¸ªæ•°æ®åº“å®•æœºï¼Œç”šè‡³ç£ç›˜ç‰©ç†æŸåçš„æƒ…å†µä¸‹ä»ç„¶ä¸å½±å“ç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œã€‚</li></ul><p>è¯»å†™åˆ†ç¦»çš„å®ç°æ˜¯æ ¹æ® SQL è¯­ä¹‰åˆ†æï¼Œå°†è¯»æ“ä½œå’Œå†™æ“ä½œåˆ†åˆ«è·¯ç”±è‡³ä¸»åº“ä¸ä»åº“ã€‚</p><p>è¯»å†™åˆ†ç¦»æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼šä»£ç å°è£…ã€ä¸­é—´ä»¶ã€‚ä»¥ä¸‹æ˜¯ä¸¤ç§æ–¹æ¡ˆçš„å¯¹æ¯”ï¼š</p><table><thead><tr><th style="text-align:left;"><strong>æ–¹æ¡ˆ</strong></th><th style="text-align:left;"><strong>å®ç°æ–¹å¼</strong></th><th style="text-align:left;"><strong>ä¼˜ç‚¹</strong></th><th style="text-align:left;"><strong>ç¼ºç‚¹</strong></th></tr></thead><tbody><tr><td style="text-align:left;"><strong>ä»£ç å°è£…</strong></td><td style="text-align:left;">ä¸šåŠ¡å±‚é€šè¿‡ä»£ç†ç±»è·¯ç”±è¯»å†™è¯·æ±‚ï¼ˆè¯»èµ°ä»åº“ï¼Œå†™èµ°ä¸»åº“ï¼‰ã€‚</td><td style="text-align:left;">ç®€å•çµæ´»ï¼Œå¯å®šåˆ¶åŒ– - é€‚åˆä¸šåŠ¡ç‰¹å®šéœ€æ±‚</td><td style="text-align:left;">ä¸»ä»åˆ‡æ¢éœ€ä¿®æ”¹é…ç½®å¹¶é‡å¯ - å¤šè¯­è¨€éœ€é‡å¤å¼€å‘</td></tr><tr><td style="text-align:left;"><strong>ä¸­é—´ä»¶</strong></td><td style="text-align:left;">ç‹¬ç«‹ä»£ç†æœåŠ¡ï¼ˆå¦‚ MySQL-Proxyã€ShardingSphereï¼‰ï¼Œå®¢æˆ·ç«¯æ— æ„ŸçŸ¥ã€‚</td><td style="text-align:left;">å±è”½å¤šè¯­è¨€å·®å¼‚ï¼Œç»Ÿä¸€ç®¡ç†æ•°æ®æº</td><td style="text-align:left;">æœ‰é¢å¤–ç»´æŠ¤æˆæœ¬ï¼Œå¯èƒ½æˆä¸ºæ€§èƒ½ç“¶é¢ˆ</td></tr></tbody></table><blockquote><p>ç»“è®ºï¼š<strong>ä»£ç å°è£…</strong>é€‚åˆç®€å•æ¶æ„ï¼Œä½†æ‰©å±•æ€§å·®ï¼›<strong>ä¸­é—´ä»¶</strong>é€‚åˆå¤æ‚æ¶æ„ï¼Œä½†éœ€ç»´æŠ¤ã€‚</p></blockquote><p><strong>å¸¸è§çš„è¯»å†™åˆ†ç¦»ä¸­é—´ä»¶</strong></p><ul><li><strong>MySQL-Proxy</strong>ï¼ˆå®˜æ–¹ï¼‰</li><li><strong>Atlas</strong>ï¼ˆ360ï¼‰</li><li><strong>ShardingSphere</strong>ï¼ˆApacheï¼‰</li><li><strong>Mycat</strong></li></ul><h3 id="ã€ä¸­ç­‰ã€‘ä»€ä¹ˆæ˜¯åˆ†åº“åˆ†è¡¨-ä¸ºä½•è¦åˆ†åº“åˆ†è¡¨" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘ä»€ä¹ˆæ˜¯åˆ†åº“åˆ†è¡¨-ä¸ºä½•è¦åˆ†åº“åˆ†è¡¨" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘ä»€ä¹ˆæ˜¯åˆ†åº“åˆ†è¡¨ï¼Ÿä¸ºä½•è¦åˆ†åº“åˆ†è¡¨ï¼Ÿ</h3><blockquote><p>ä»€ä¹ˆæ˜¯åˆ†åº“åˆ†è¡¨ï¼Ÿ</p></blockquote><p><strong>åˆ†åº“åˆ†è¡¨</strong>æ˜¯ä¸€ç§æ•°æ®åº“æ°´å¹³æ‹†åˆ†æ–¹æ¡ˆï¼Œç”¨äºè§£å†³å•æœºæ•°æ®åº“çš„<strong>å­˜å‚¨ç“¶é¢ˆ</strong>å’Œ<strong>æ€§èƒ½ç“¶é¢ˆ</strong>é—®é¢˜ã€‚</p><ul><li><strong>åˆ†åº“</strong>ï¼šå°†æ•°æ®åˆ†æ•£åˆ°ä¸åŒçš„æ•°æ®åº“å®ä¾‹ï¼ˆå¦‚ <code>DB1</code>ã€<code>DB2</code>ï¼‰ã€‚</li><li><strong>åˆ†è¡¨</strong>ï¼šå°†æ•°æ®åˆ†æ•£åˆ°åŒä¸€æ•°æ®åº“çš„ä¸åŒè¡¨ï¼ˆå¦‚ <code>order_1</code>ã€<code>order_2</code>ï¼‰ã€‚</li></ul><blockquote><p>ä¸ºä½•è¦åˆ†åº“åˆ†è¡¨ï¼Ÿ</p></blockquote><p>åˆ†åº“åˆ†è¡¨ä¸»è¦åŸºäºä»¥ä¸‹ç†ç”±ï¼š</p><ul><li><strong>å¹¶å‘è¿æ¥</strong> - ä¸€ä¸ªå¥åº·çš„å•åº“æœ€å¥½ä¿æŒåœ¨æ¯ç§’ 1000 ä¸ªå¹¶å‘å·¦å³ï¼Œä¸è¦å¤ªå¤§ã€‚</li><li><strong>ç£ç›˜å®¹é‡</strong> - ç£ç›˜å®¹é‡å æ»¡ï¼Œä¼šå¯¼è‡´æœåŠ¡å™¨ä¸å¯ç”¨ã€‚</li><li><strong>SQL æ€§èƒ½</strong> - å•è¡¨æ•°æ®é‡è¿‡å¤§ï¼Œä¼šå¯¼è‡´ SQL æ‰§è¡Œæ•ˆç‡ä½ä¸‹ã€‚ä¸€èˆ¬ï¼Œå•è¡¨è¶…è¿‡ 1000 ä¸‡æ¡æ•°æ®ï¼Œå°±å¯ä»¥è€ƒè™‘åˆ†è¡¨äº†ã€‚</li></ul><table><thead><tr><th>#</th><th>åˆ†åº“åˆ†è¡¨å‰</th><th>åˆ†åº“åˆ†è¡¨å</th></tr></thead><tbody><tr><td>å¹¶å‘æ”¯æ’‘æƒ…å†µ</td><td>MySQL å•æœºéƒ¨ç½²ï¼Œæ‰›ä¸ä½é«˜å¹¶å‘</td><td>MySQL ä»å•æœºåˆ°å¤šæœºï¼Œèƒ½æ‰¿å—çš„å¹¶å‘å¢åŠ äº†å¤šå€</td></tr><tr><td>ç£ç›˜ä½¿ç”¨æƒ…å†µ</td><td>MySQL å•æœºç£ç›˜å®¹é‡å‡ ä¹æ’‘æ»¡</td><td>æ‹†åˆ†ä¸ºå¤šä¸ªåº“ï¼Œæ•°æ®åº“æœåŠ¡å™¨ç£ç›˜ä½¿ç”¨ç‡å¤§å¤§é™ä½</td></tr><tr><td>SQL æ‰§è¡Œæ€§èƒ½</td><td>å•è¡¨æ•°æ®é‡å¤ªå¤§ï¼ŒSQL è¶Šè·‘è¶Šæ…¢</td><td>å•è¡¨æ•°æ®é‡å‡å°‘ï¼ŒSQL æ‰§è¡Œæ•ˆç‡æ˜æ˜¾æå‡</td></tr></tbody></table><h3 id="ã€ä¸­ç­‰ã€‘åˆ†åº“åˆ†è¡¨æœ‰å“ªäº›ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘åˆ†åº“åˆ†è¡¨æœ‰å“ªäº›ç­–ç•¥" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘åˆ†åº“åˆ†è¡¨æœ‰å“ªäº›ç­–ç•¥ï¼Ÿ</h3><p>åˆ†åº“åˆ†è¡¨ç­–ç•¥ä¸»è¦æœ‰ä¸¤ç§ï¼š</p><ul><li>æ ¹æ®æ•°å€¼èŒƒå›´åˆ’åˆ†</li><li>æ ¹æ® Hash åˆ’åˆ†</li><li>è·¯ç”±è¡¨</li></ul><h4 id="æ•°å€¼èŒƒå›´è·¯ç”±" tabindex="-1"><a class="header-anchor" href="#æ•°å€¼èŒƒå›´è·¯ç”±" aria-hidden="true">#</a> æ•°å€¼èŒƒå›´è·¯ç”±</h4><p>æ•°å€¼èŒƒå›´è·¯ç”±ï¼Œå°±æ˜¯æ ¹æ® IDã€æ—¶é—´èŒƒå›´ è¿™ç±»å…·æœ‰æ’åºæ€§çš„å­—æ®µæ¥è¿›è¡Œåˆ’åˆ†ã€‚ä¾‹å¦‚ï¼šç”¨æˆ· Id ä¸º 1-9999 çš„è®°å½•åˆ†åˆ°ç¬¬ä¸€ä¸ªåº“ï¼Œ10000-20000 çš„åˆ†åˆ°ç¬¬äºŒä¸ªåº“ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><p>æŒ‰è¿™ç§ç­–ç•¥åˆ’åˆ†å‡ºæ¥çš„æ•°æ®ï¼Œå…·æœ‰æ•°æ®è¿ç»­æ€§ã€‚</p><ul><li><strong>ä¼˜ç‚¹</strong>ï¼šæ•°æ®è¿ç§»å¾ˆç®€å•ã€‚</li><li><strong>ç¼ºç‚¹</strong>ï¼šå®¹æ˜“äº§ç”Ÿçƒ­ç‚¹é—®é¢˜ï¼Œå¤§é‡çš„æµé‡éƒ½æ‰“åœ¨æœ€æ–°çš„æ•°æ®ä¸Šäº†ã€‚</li></ul><h4 id="hash-è·¯ç”±" tabindex="-1"><a class="header-anchor" href="#hash-è·¯ç”±" aria-hidden="true">#</a> Hash è·¯ç”±</h4><p>å…¸å‹çš„ Hash è·¯ç”±ï¼Œå¦‚æ ¹æ®æ•°å€¼å–æ¨¡ï¼Œå½“éœ€è¦æ‰©å®¹æ—¶ï¼Œä¸€èˆ¬ä»¥ 2 çš„å¹‚æ¬¡æ–¹è¿›è¡Œæ‰©å®¹ï¼ˆè¿™æ ·ï¼Œæ‰©å®¹æ—¶è¿ç§»çš„æ•°æ®é‡ä¼šå°ä¸€äº›ï¼‰ã€‚ä¾‹å¦‚ï¼šç”¨æˆ· Id mod nï¼Œä½™æ•°ä¸º 0 çš„è®°å½•æ”¾åˆ°ç¬¬ä¸€ä¸ªåº“ï¼Œä½™æ•°ä¸º 1 çš„æ”¾åˆ°ç¬¬äºŒä¸ªåº“ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><p>ä¸€èˆ¬é‡‡ç”¨ <strong>é¢„åˆ†åŒº</strong> çš„æ–¹å¼ï¼Œæå‰æ ¹æ® <strong>æ•°æ®é‡</strong> è§„åˆ’å¥½ <strong>åˆ†åŒºæ•°</strong>ï¼Œæ¯”å¦‚åˆ’åˆ†ä¸º <code>512</code> æˆ– <code>1024</code> å¼ è¡¨ï¼Œä¿è¯å¯æ”¯æ’‘æœªæ¥ä¸€æ®µæ—¶é—´çš„ <strong>æ•°æ®å®¹é‡</strong>ï¼Œå†æ ¹æ® <strong>è´Ÿè½½æƒ…å†µ</strong> å°† <strong>è¡¨</strong> è¿ç§»åˆ°å…¶ä»– <strong>æ•°æ®åº“</strong> ä¸­ã€‚æ‰©å®¹æ—¶é€šå¸¸é‡‡ç”¨ <strong>ç¿»å€æ‰©å®¹</strong>ï¼Œé¿å… <strong>æ•°æ®æ˜ å°„</strong> å…¨éƒ¨è¢« <strong>æ‰“ä¹±</strong>ï¼Œå¯¼è‡´ <strong>å…¨é‡è¿ç§»</strong> çš„æƒ…å†µã€‚</p><ul><li><strong>ä¼˜ç‚¹</strong>ï¼šæ•°æ®ç¦»æ•£åˆ†å¸ƒï¼Œä¸å­˜åœ¨çƒ­ç‚¹é—®é¢˜ã€‚</li><li><strong>ç¼ºç‚¹</strong>ï¼šæ•°æ®è¿ç§»ã€æ‰©å®¹éº»çƒ¦ï¼ˆä¹‹å‰çš„æ•°æ®éœ€è¦é‡æ–°è®¡ç®— hash å€¼é‡æ–°åˆ†é…åˆ°ä¸åŒçš„åº“æˆ–è¡¨ï¼‰ã€‚å½“èŠ‚ç‚¹æ•°é‡å˜åŒ–æ—¶ï¼Œå¦‚<strong>æ‰©å®¹</strong>æˆ–<strong>æ”¶ç¼©</strong>èŠ‚ç‚¹ï¼Œæ•°æ®èŠ‚ç‚¹<strong>æ˜ å°„å…³ç³»</strong>éœ€è¦é‡æ–°è®¡ç®—ï¼Œä¼šå¯¼è‡´æ•°æ®çš„ <strong>é‡æ–°è¿ç§»</strong>ã€‚</li></ul><h4 id="è·¯ç”±è¡¨" tabindex="-1"><a class="header-anchor" href="#è·¯ç”±è¡¨" aria-hidden="true">#</a> è·¯ç”±è¡¨</h4><p>è¿™ç§ç­–ç•¥ï¼Œå°±æ˜¯ç”¨ä¸€å¼ ç‹¬ç«‹çš„è¡¨è®°å½•è·¯ç”±ä¿¡æ¯ã€‚</p><ul><li><strong>ä¼˜ç‚¹</strong>ï¼šç®€å•ã€çµæ´»ï¼Œå°¤å…¶æ˜¯åœ¨æ‰©å®¹ã€è¿ç§»æ—¶ï¼Œåªéœ€è¦è¿ç§»æŒ‡å®šçš„æ•°æ®ï¼Œç„¶åä¿®æ”¹è·¯ç”±è¡¨å³å¯ã€‚</li><li><strong>ç¼ºç‚¹</strong>ï¼šæ¯æ¬¡æŸ¥è¯¢ï¼Œå¿…é¡»å…ˆæŸ¥è·¯ç”±è¡¨ï¼Œå¢åŠ äº† IO å¼€é”€ã€‚å¹¶ä¸”ï¼Œå¦‚æœè·¯ç”±è¡¨æœ¬èº«å¤ªå¤§ï¼Œä¹Ÿä¼šé¢ä¸´æ€§èƒ½ç“¶é¢ˆï¼Œå¦‚æœæƒ³å¯¹è·¯ç”±è¡¨å†åšåˆ†åº“åˆ†è¡¨ï¼Œå°†å‡ºç°æ­»å¾ªç¯å¼çš„è·¯ç”±ç®—æ³•é€‰æ‹©é—®é¢˜ã€‚</li></ul><h3 id="ã€å›°éš¾ã€‘åˆ†åº“åˆ†è¡¨å­˜åœ¨å“ªäº›é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#ã€å›°éš¾ã€‘åˆ†åº“åˆ†è¡¨å­˜åœ¨å“ªäº›é—®é¢˜" aria-hidden="true">#</a> ã€å›°éš¾ã€‘åˆ†åº“åˆ†è¡¨å­˜åœ¨å“ªäº›é—®é¢˜ï¼Ÿ</h3><p>åˆ†åº“åˆ†è¡¨ä¸»è¦å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p><ul><li><strong>åˆ†å¸ƒå¼ ID é—®é¢˜</strong></li><li><strong>åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜</strong></li><li><strong>è·¨èŠ‚ç‚¹ Join å’Œèšåˆ</strong></li><li><strong>è·¨åˆ†ç‰‡çš„æ’åºåˆ†é¡µ</strong></li></ul><h4 id="åˆ†å¸ƒå¼-id-é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#åˆ†å¸ƒå¼-id-é—®é¢˜" aria-hidden="true">#</a> åˆ†å¸ƒå¼ ID é—®é¢˜</h4><p>ä¸€æ—¦æ•°æ®åº“è¢«åˆ‡åˆ†åˆ°å¤šä¸ªç‰©ç†ç»“ç‚¹ä¸Šï¼Œæˆ‘ä»¬å°†ä¸èƒ½å†ä¾èµ–æ•°æ®åº“è‡ªèº«çš„ä¸»é”®ç”Ÿæˆæœºåˆ¶ã€‚ä¸€æ–¹é¢ï¼ŒæŸä¸ªåˆ†åŒºæ•°æ®åº“è‡ªç”Ÿæˆçš„ ID æ— æ³•ä¿è¯åœ¨å…¨å±€ä¸Šæ˜¯å”¯ä¸€çš„ï¼›å¦ä¸€æ–¹é¢ï¼Œåº”ç”¨ç¨‹åºåœ¨æ’å…¥æ•°æ®ä¹‹å‰éœ€è¦å…ˆè·å¾— IDï¼Œä»¥ä¾¿è¿›è¡Œ SQL è·¯ç”±ã€‚</p>',137),J={href:"https://dunwu.github.io/waterdrop/pages/1050baf5/",target:"_blank",rel:"noopener noreferrer"},H=n("h4",{id:"åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜","aria-hidden":"true"},"#"),s(" åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜")],-1),Y=n("p",null,"è·¨åº“äº‹åŠ¡ä¹Ÿæ˜¯åˆ†å¸ƒå¼çš„æ•°æ®åº“é›†ç¾¤è¦é¢å¯¹çš„æ£˜æ‰‹äº‹æƒ…ã€‚ åˆç†é‡‡ç”¨åˆ†è¡¨ï¼Œå¯ä»¥åœ¨é™ä½å•è¡¨æ•°æ®é‡çš„æƒ…å†µä¸‹ï¼Œå°½é‡ä½¿ç”¨æœ¬åœ°äº‹åŠ¡ï¼Œå–„äºä½¿ç”¨åŒåº“ä¸åŒè¡¨å¯æœ‰æ•ˆé¿å…åˆ†å¸ƒå¼äº‹åŠ¡å¸¦æ¥çš„éº»çƒ¦ã€‚åœ¨ä¸èƒ½é¿å…è·¨åº“äº‹åŠ¡çš„åœºæ™¯ï¼Œæœ‰äº›ä¸šåŠ¡ä»ç„¶éœ€è¦ä¿æŒäº‹åŠ¡çš„ä¸€è‡´æ€§ã€‚ è€ŒåŸºäº XA çš„åˆ†å¸ƒå¼äº‹åŠ¡ç”±äºåœ¨å¹¶å‘åº¦é«˜çš„åœºæ™¯ä¸­æ€§èƒ½æ— æ³•æ»¡è¶³éœ€è¦ï¼Œå¹¶æœªè¢«äº’è”ç½‘å·¨å¤´å¤§è§„æ¨¡ä½¿ç”¨ï¼Œä»–ä»¬å¤§å¤šé‡‡ç”¨æœ€ç»ˆä¸€è‡´æ€§çš„æŸ”æ€§äº‹åŠ¡ä»£æ›¿å¼ºä¸€è‡´äº‹åŠ¡ã€‚",-1),j={href:"https://dunwu.github.io/waterdrop/pages/36844fb1/",target:"_blank",rel:"noopener noreferrer"},z=o(`<h4 id="è·¨èŠ‚ç‚¹-join-å’Œèšåˆ" tabindex="-1"><a class="header-anchor" href="#è·¨èŠ‚ç‚¹-join-å’Œèšåˆ" aria-hidden="true">#</a> è·¨èŠ‚ç‚¹ Join å’Œèšåˆ</h4><p>åˆ†åº“åˆ†è¡¨åï¼Œæ— æ³•ç›´æ¥è·¨èŠ‚ç‚¹ <code>join</code> ã€<code>count</code>ã€<code>order by</code>ã€<code>group by</code> ä»¥åŠèšåˆã€‚</p><p>é’ˆå¯¹è¿™ç±»é—®é¢˜ï¼Œæ™®éåšæ³•æ˜¯<strong>äºŒæ¬¡æŸ¥è¯¢</strong>ã€‚</p><ul><li><p>åœ¨ç¬¬ä¸€æ¬¡æŸ¥è¯¢æ—¶ï¼Œè·å–å„ä¸ªèŠ‚ç‚¹ä¸Šçš„ç»“æœã€‚</p></li><li><p>åœ¨ç¨‹åºä¸­å°†è¿™äº›ç»“æœè¿›è¡Œåˆå¹¶ã€ç­›é€‰ã€‚</p></li></ul><h4 id="è·¨åˆ†ç‰‡çš„æ’åºåˆ†é¡µ" tabindex="-1"><a class="header-anchor" href="#è·¨åˆ†ç‰‡çš„æ’åºåˆ†é¡µ" aria-hidden="true">#</a> è·¨åˆ†ç‰‡çš„æ’åºåˆ†é¡µ</h4><p>ä¸€èˆ¬æ¥è®²ï¼Œåˆ†é¡µæ—¶éœ€è¦æŒ‰ç…§æŒ‡å®šå­—æ®µè¿›è¡Œæ’åºã€‚å½“æ’åºå­—æ®µå°±æ˜¯åˆ†ç‰‡å­—æ®µçš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šè¿‡åˆ†ç‰‡è§„åˆ™å¯ä»¥æ¯”è¾ƒå®¹æ˜“å®šä½åˆ°æŒ‡å®šçš„åˆ†ç‰‡ï¼Œè€Œå½“æ’åºå­—æ®µéåˆ†ç‰‡å­—æ®µçš„æ—¶å€™ï¼Œæƒ…å†µå°±ä¼šå˜å¾—æ¯”è¾ƒå¤æ‚äº†ã€‚ä¸ºäº†æœ€ç»ˆç»“æœçš„å‡†ç¡®æ€§ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸åŒçš„åˆ†ç‰‡èŠ‚ç‚¹ä¸­å°†æ•°æ®è¿›è¡Œæ’åºå¹¶è¿”å›ï¼Œå¹¶å°†ä¸åŒåˆ†ç‰‡è¿”å›çš„ç»“æœé›†è¿›è¡Œæ±‡æ€»å’Œå†æ¬¡æ’åºï¼Œæœ€åå†è¿”å›ç»™ç”¨æˆ·ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><figure><img src="https://raw.githubusercontent.com/dunwu/images/master/202506050815256.webp" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ä¸Šé¢å›¾ä¸­æ‰€æè¿°çš„åªæ˜¯æœ€ç®€å•çš„ä¸€ç§æƒ…å†µï¼ˆå–ç¬¬ä¸€é¡µæ•°æ®ï¼‰ï¼Œçœ‹èµ·æ¥å¯¹æ€§èƒ½çš„å½±å“å¹¶ä¸å¤§ã€‚ä½†æ˜¯ï¼Œå¦‚æœæƒ³å–å‡ºç¬¬ 10 é¡µæ•°æ®ï¼Œæƒ…å†µåˆå°†å˜å¾—å¤æ‚å¾ˆå¤šï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><figure><img src="https://raw.githubusercontent.com/dunwu/images/master/202506050816625.webp" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æœ‰äº›è¯»è€…å¯èƒ½å¹¶ä¸å¤ªç†è§£ï¼Œä¸ºä»€ä¹ˆä¸èƒ½åƒè·å–ç¬¬ä¸€é¡µæ•°æ®é‚£æ ·ç®€å•å¤„ç†ï¼ˆæ’åºå–å‡ºå‰ 10 æ¡å†åˆå¹¶ã€æ’åºï¼‰ã€‚å…¶å®å¹¶ä¸éš¾ç†è§£ï¼Œå› ä¸ºå„åˆ†ç‰‡èŠ‚ç‚¹ä¸­çš„æ•°æ®å¯èƒ½æ˜¯éšæœºçš„ï¼Œä¸ºäº†æ’åºçš„å‡†ç¡®æ€§ï¼Œå¿…é¡»æŠŠæ‰€æœ‰åˆ†ç‰‡èŠ‚ç‚¹çš„å‰ N é¡µæ•°æ®éƒ½æ’åºå¥½ååšåˆå¹¶ï¼Œæœ€åå†è¿›è¡Œæ•´ä½“çš„æ’åºã€‚å¾ˆæ˜¾ç„¶ï¼Œè¿™æ ·çš„æ“ä½œæ˜¯æ¯”è¾ƒæ¶ˆè€—èµ„æºçš„ï¼Œç”¨æˆ·è¶Šå¾€åç¿»é¡µï¼Œç³»ç»Ÿæ€§èƒ½å°†ä¼šè¶Šå·®ã€‚</p><p>é‚£å¦‚ä½•è§£å†³åˆ†åº“æƒ…å†µä¸‹çš„åˆ†é¡µé—®é¢˜å‘¢ï¼Ÿæœ‰ä»¥ä¸‹å‡ ç§åŠæ³•ï¼š</p><p>å¦‚æœæ˜¯åœ¨å‰å°åº”ç”¨æä¾›åˆ†é¡µï¼Œåˆ™é™å®šç”¨æˆ·åªèƒ½çœ‹å‰é¢ n é¡µï¼Œè¿™ä¸ªé™åˆ¶åœ¨ä¸šåŠ¡ä¸Šä¹Ÿæ˜¯åˆç†çš„ï¼Œä¸€èˆ¬çœ‹åé¢çš„åˆ†é¡µæ„ä¹‰ä¸å¤§ï¼ˆå¦‚æœä¸€å®šè¦çœ‹ï¼Œå¯ä»¥è¦æ±‚ç”¨æˆ·ç¼©å°èŒƒå›´é‡æ–°æŸ¥è¯¢ï¼‰ã€‚</p><p>å¦‚æœæ˜¯åå°æ‰¹å¤„ç†ä»»åŠ¡è¦æ±‚åˆ†æ‰¹è·å–æ•°æ®ï¼Œåˆ™å¯ä»¥åŠ å¤§ page sizeï¼Œæ¯”å¦‚æ¯æ¬¡è·å– 5000 æ¡è®°å½•ï¼Œæœ‰æ•ˆå‡å°‘åˆ†é¡µæ•°ï¼ˆå½“ç„¶ç¦»çº¿è®¿é—®ä¸€èˆ¬èµ°å¤‡åº“ï¼Œé¿å…å†²å‡»ä¸»åº“ï¼‰ã€‚</p><p>åˆ†åº“è®¾è®¡æ—¶ï¼Œä¸€èˆ¬è¿˜æœ‰é…å¥—å¤§æ•°æ®å¹³å°æ±‡æ€»æ‰€æœ‰åˆ†åº“çš„è®°å½•ï¼Œæœ‰äº›åˆ†é¡µæŸ¥è¯¢å¯ä»¥è€ƒè™‘èµ°å¤§æ•°æ®å¹³å°ã€‚</p><h3 id="ã€å›°éš¾ã€‘å¦‚ä½•å®ç°è¿åº“å’Œæ‰©å®¹" tabindex="-1"><a class="header-anchor" href="#ã€å›°éš¾ã€‘å¦‚ä½•å®ç°è¿åº“å’Œæ‰©å®¹" aria-hidden="true">#</a> ã€å›°éš¾ã€‘å¦‚ä½•å®ç°è¿åº“å’Œæ‰©å®¹ï¼Ÿ</h3><h4 id="åœæœºè¿ç§»-æ‰©å®¹-ä¸æ¨è" tabindex="-1"><a class="header-anchor" href="#åœæœºè¿ç§»-æ‰©å®¹-ä¸æ¨è" aria-hidden="true">#</a> åœæœºè¿ç§»/æ‰©å®¹ï¼ˆä¸æ¨èï¼‰</h4><p>åœæœºè¿ç§»/æ‰©å®¹æ˜¯æœ€æš´åŠ›ã€æœ€ç®€å•çš„è¿ç§»ã€æ‰©å®¹æ–¹æ¡ˆã€‚</p><figure><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/20200601114836.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>åœæœºè¿ç§»/æ‰©å®¹æµç¨‹</strong>ï¼š</p><ol><li>é¢„ä¼°åœæœæ—¶é—´ï¼Œå‘å¸ƒåœæœå…¬å‘Šï¼›åœæœï¼Œä¸å…è®¸æ•°æ®è®¿é—®ã€‚</li><li>ç¼–å†™ä¸´æ—¶çš„æ•°æ®å¯¼å…¥ç¨‹åºï¼Œä»è€æ•°æ®åº“ä¸­è¯»å–æ•°æ®ã€‚</li><li>å°†æ•°æ®å†™å…¥ä¸­é—´ä»¶ã€‚</li><li>ä¸­é—´ä»¶æ ¹æ®åˆ†ç‰‡è§„åˆ™ï¼Œå°†æ•°æ®åˆ†å‘åˆ°åˆ†åº“ï¼ˆåˆ†è¡¨ï¼‰ä¸­ã€‚</li><li>åº”ç”¨ç¨‹åºä¿®æ”¹é…ç½®ï¼Œé‡å¯ã€‚</li></ol><p><strong>åœæœºè¿ç§»/æ‰©å®¹æ–¹æ¡ˆåˆ†æ</strong>ï¼š</p><ul><li><strong>ä¼˜ç‚¹</strong>ï¼šç®€å•ã€æ— æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚</li><li><strong>ç¼ºç‚¹</strong>ï¼š <ul><li>åœæœæ—¶é—´é•¿ï¼ˆæ•°æ®é‡å¤§æ—¶å¯èƒ½éœ€æ•°å°æ—¶ï¼‰ã€‚</li><li>é£é™©é«˜ï¼Œå¤±è´¥åéš¾ä»¥å›æ»šã€‚</li></ul></li></ul><p><strong>ç»“è®º</strong>ï¼šä»£ä»·è¿‡é«˜ï¼Œä¸æ¨èä½¿ç”¨ã€‚</p><h4 id="åŒå†™è¿ç§»" tabindex="-1"><a class="header-anchor" href="#åŒå†™è¿ç§»" aria-hidden="true">#</a> åŒå†™è¿ç§»</h4><p><strong>åŒå†™è¿ç§»æ–¹æ¡ˆæ ¸å¿ƒæ€æƒ³</strong>ï¼š</p><ul><li>æ–°æ—§åº“åŒæ—¶å†™å…¥ï¼Œé€šè¿‡å¼€å…³æ§åˆ¶è¯»å†™çŠ¶æ€ï¼ˆåªå†™æ—§åº“ã€åªå†™æ–°åº“ã€åŒå†™ï¼‰ã€‚</li><li>é€æ­¥åˆ‡æ¢è¯»è¯·æ±‚åˆ°æ–°åº“ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚</li></ul><p><strong>åŒå†™è¿ç§»æ–¹æ¡ˆå…³é”®æ­¥éª¤</strong>ï¼š</p><ol><li><strong>åŒå†™é˜¶æ®µ</strong>ï¼šå…ˆå†™æ—§åº“ï¼Œå†å†™æ–°åº“ï¼Œä»¥æ—§åº“ç»“æœä¸ºå‡†ã€‚è®°å½•æ—§åº“æˆåŠŸä½†æ–°åº“å¤±è´¥çš„æ—¥å¿—ï¼Œç”¨äºè¡¥å¿ã€‚</li><li><strong>æ•°æ®æ ¡éªŒ</strong>ï¼šè¿è¡Œå¯¹æ¯”ç¨‹åºï¼Œæ£€æŸ¥æ–°æ—§åº“æ•°æ®å·®å¼‚å¹¶ä¿®å¤ã€‚</li><li><strong>ç°åº¦åˆ‡æ¢è¯»è¯·æ±‚</strong>ï¼šé€æ­¥å°†è¯»æµé‡åˆ‡è‡³æ–°åº“ï¼Œè§‚å¯Ÿç¨³å®šæ€§ã€‚</li><li><strong>æœ€ç»ˆåˆ‡æ¢</strong>ï¼šè¯»å†™å…¨éƒ¨åˆ‡è‡³æ–°åº“ï¼Œæ¸…ç†æ—§åº“å†—ä½™æ•°æ®ã€‚</li></ol><figure><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/20200601135751.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>åŒå†™è¿ç§»æµç¨‹</strong>ï¼š</p><ol><li>ä¿®æ”¹åº”ç”¨ç¨‹åºé…ç½®ï¼Œå°†æ•°æ®åŒæ—¶å†™å…¥è€æ•°æ®åº“å’Œä¸­é—´ä»¶ã€‚è¿™å°±æ˜¯æ‰€è°“çš„<strong>åŒå†™</strong>ï¼ŒåŒæ—¶å†™ä¿©åº“ï¼Œè€åº“å’Œæ–°åº“ã€‚</li><li>ç¼–å†™ä¸´æ—¶ç¨‹åºï¼Œè¯»å–è€æ•°æ®åº“ã€‚</li><li>å°†æ•°æ®å†™å…¥ä¸­é—´ä»¶ã€‚å¦‚æœæ•°æ®ä¸å­˜åœ¨ï¼Œç›´æ¥å†™å…¥ï¼›å¦‚æœæ•°æ®å­˜åœ¨ï¼Œæ¯”è¾ƒæ—¶é—´æˆ³ï¼Œåªå…è®¸æ–°æ•°æ®è¦†ç›–è€æ•°æ®ã€‚</li><li>å¯¼å…¥æ•°æ®åï¼Œæœ‰å¯èƒ½æ•°æ®è¿˜æ˜¯å­˜åœ¨ä¸ä¸€è‡´ï¼Œé‚£ä¹ˆå°±å¯¹æ•°æ®è¿›è¡Œæ ¡éªŒï¼Œæ¯”å¯¹æ–°è€åº“çš„æ¯æ¡æ•°æ®ã€‚å¦‚æœå­˜åœ¨å·®å¼‚ï¼Œé’ˆå¯¹å·®å¼‚æ•°æ®ï¼Œæ‰§è¡Œï¼ˆ3ï¼‰ã€‚å¾ªç¯ï¼ˆ3ï¼‰ã€ï¼ˆ4ï¼‰æ­¥éª¤ï¼Œç›´è‡³æ•°æ®å®Œå…¨ä¸€è‡´ã€‚</li><li>ä¿®æ”¹åº”ç”¨ç¨‹åºé…ç½®ï¼Œå°†æ•°æ®åªå†™å…¥ä¸­é—´ä»¶ã€‚</li><li>ä¸­é—´ä»¶æ ¹æ®åˆ†ç‰‡è§„åˆ™ï¼Œå°†æ•°æ®åˆ†å‘åˆ°åˆ†åº“ï¼ˆåˆ†è¡¨ï¼‰ä¸­ã€‚</li></ol><p><strong>åŒå†™è¿ç§»æ–¹æ¡ˆåˆ†æ</strong>ï¼š</p><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>æ— éœ€åœæœï¼Œä¸šåŠ¡å½±å“å°ã€‚</li><li>å¯ç°åº¦éªŒè¯ï¼Œé£é™©å¯æ§ã€‚</li></ul><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>å®ç°å¤æ‚ï¼Œéœ€å¤„ç†åŒå†™ä¸€è‡´æ€§å’Œè¡¥å¿é€»è¾‘ã€‚</li></ul><h4 id="ä¸»ä»æ›¿æ¢" tabindex="-1"><a class="header-anchor" href="#ä¸»ä»æ›¿æ¢" aria-hidden="true">#</a> ä¸»ä»æ›¿æ¢</h4><p>ç”Ÿäº§ç¯å¢ƒçš„æ•°æ®åº“ï¼Œä¸ºäº†ä¿è¯é«˜å¯ç”¨ï¼Œä¸€èˆ¬ä¼šé‡‡ç”¨ä¸»ä»æ¶æ„ã€‚ä¸»åº“æ”¯æŒè¯»å†™æ“ä½œï¼Œä»åº“æ”¯æŒè¯»æ“ä½œã€‚</p><figure><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/20200601121215.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ç”±äºä¸»ä»èŠ‚ç‚¹æ•°æ®ä¸€è‡´ï¼Œæ‰€ä»¥å°†ä»åº“å‡çº§ä¸ºä¸»èŠ‚ç‚¹ï¼Œå¹¶ä¿®æ”¹åˆ†ç‰‡é…ç½®ï¼Œå°†ä»èŠ‚ç‚¹ä½œä¸ºåˆ†åº“ä¹‹ä¸€ï¼Œå°±å®ç°äº†æ‰©å®¹ã€‚</p><figure><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/20200601121400.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>ä¸»ä»æ›¿æ¢æ–¹æ¡ˆæµç¨‹</strong>ï¼š</p><ol><li>è§£é™¤ä¸»ä»å…³ç³»ï¼Œä»åº“å‡çº§ä¸ºä¸»åº“ã€‚</li><li>åº”ç”¨ç¨‹åºï¼Œä¿®æ”¹é…ç½®ï¼Œè¯»å†™é€šè¿‡ä¸­é—´ä»¶ã€‚</li><li>åˆ†åº“åˆ†è¡¨ä¸­é—´ï¼Œä¿®æ”¹åˆ†ç‰‡é…ç½®ã€‚å°†æ•°æ®æŒ‰ç…§æ–°çš„è§„åˆ™åˆ†å‘ã€‚</li><li>ç¼–å†™ä¸´æ—¶ç¨‹åºï¼Œæ¸…ç†å†—ä½™æ•°æ®ã€‚æ¯”å¦‚ï¼šåŸæ¥æ˜¯ä¸€ä¸ªå•åº“ï¼Œæ•°æ®é‡ä¸º 400 ä¸‡ã€‚ä»èŠ‚ç‚¹å‡çº§ä¸ºåˆ†åº“ä¹‹ä¸€åï¼Œæ¯ä¸ªåˆ†åº“éƒ½æœ‰ 400 ä¸‡æ•°æ®ï¼Œå…¶ä¸­ 200 ä¸‡æ˜¯å†—ä½™æ•°æ®ã€‚æ¸…ç†å®Œåï¼Œè¿›è¡Œæ•°æ®æ ¡éªŒã€‚</li><li>ä¸ºæ¯ä¸ªåˆ†åº“æ·»åŠ æ–°çš„ä»åº“ï¼Œä¿è¯é«˜å¯ç”¨ã€‚</li></ol><p><strong>ä¸»ä»æ›¿æ¢æ–¹æ¡ˆåˆ†æ</strong>ï¼š</p><ul><li><strong>æ— éœ€åœæœº</strong>ï¼Œæ— éœ€å…¨é‡æ•°æ®è¿ç§»ã€‚</li><li>åˆ©ç”¨ç°æœ‰ä»åº“èµ„æºï¼ŒèŠ‚çœæˆæœ¬ã€‚</li></ul><h4 id="ä¸‰ç§æ–¹æ¡ˆå¯¹æ¯”" tabindex="-1"><a class="header-anchor" href="#ä¸‰ç§æ–¹æ¡ˆå¯¹æ¯”" aria-hidden="true">#</a> ä¸‰ç§æ–¹æ¡ˆå¯¹æ¯”</h4><table><thead><tr><th style="text-align:left;"><strong>æ–¹æ¡ˆ</strong></th><th style="text-align:left;"><strong>é€‚ç”¨åœºæ™¯</strong></th><th style="text-align:left;"><strong>ä¼˜ç‚¹</strong></th><th style="text-align:left;"><strong>ç¼ºç‚¹</strong></th></tr></thead><tbody><tr><td style="text-align:left;"><strong>åœæœºè¿ç§»</strong></td><td style="text-align:left;">å°è§„æ¨¡æ•°æ®ï¼Œå®¹å¿åœæœ</td><td style="text-align:left;">ç®€å•ï¼Œæ— ä¸€è‡´æ€§é—®é¢˜</td><td style="text-align:left;">åœæœæ—¶é—´é•¿ï¼Œé£é™©é«˜</td></tr><tr><td style="text-align:left;"><strong>åŒå†™è¿ç§»</strong></td><td style="text-align:left;">å¤§è§„æ¨¡æ•°æ®ï¼Œè¦æ±‚é«˜å¯ç”¨</td><td style="text-align:left;">æ— åœæœï¼Œç°åº¦å¯æ§</td><td style="text-align:left;">å¤æ‚ï¼Œéœ€è¡¥å¿æœºåˆ¶</td></tr><tr><td style="text-align:left;"><strong>ä¸»ä»æ›¿æ¢</strong></td><td style="text-align:left;">å·²æœ‰ä¸»ä»æ¶æ„</td><td style="text-align:left;">æ— éœ€è¿ç§»æ•°æ®ï¼Œå¿«é€Ÿæ‰©å®¹</td><td style="text-align:left;">ä¾èµ–ç°æœ‰ä»åº“ï¼Œæ¸…ç†å†—ä½™å¤æ‚</td></tr></tbody></table><p><strong>æ¨èé€‰æ‹©</strong>ï¼š</p><ul><li><strong>ä¼˜å…ˆåŒå†™è¿ç§»</strong>ï¼šé€‚åˆå¤§å¤šæ•°ä¸šåŠ¡ï¼Œå¹³è¡¡é£é™©ä¸å¤æ‚åº¦ã€‚</li><li><strong>ä¸»ä»å‡çº§</strong>ï¼šé€‚åˆå·²æœ‰ä¸»ä»ä¸”æ•°æ®é‡é€‚ä¸­çš„åœºæ™¯ã€‚</li><li><strong>é¿å…åœæœºè¿ç§»</strong>ï¼šé™¤éæ•°æ®é‡æå°ä¸”å¯æ¥å—åœæœã€‚</li></ul><h2 id="mysql-æ¶æ„" tabindex="-1"><a class="header-anchor" href="#mysql-æ¶æ„" aria-hidden="true">#</a> MySQL æ¶æ„</h2><h3 id="ã€ä¸­ç­‰ã€‘sql-æŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œé¡ºåºæ˜¯æ€ä¹ˆæ ·çš„" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘sql-æŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œé¡ºåºæ˜¯æ€ä¹ˆæ ·çš„" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘SQL æŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œé¡ºåºæ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ</h3><figure><img src="https://raw.githubusercontent.com/dunwu/images/master/202506050817770.jpg" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æ‰€æœ‰çš„æŸ¥è¯¢è¯­å¥éƒ½æ˜¯ä» FROM å¼€å§‹æ‰§è¡Œçš„ï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªæ­¥éª¤éƒ½ä¼šä¸ºä¸‹ä¸€ä¸ªæ­¥éª¤ç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿè¡¨ï¼Œè¿™ä¸ªè™šæ‹Ÿè¡¨å°†ä½œä¸ºä¸‹ä¸€ä¸ªæ‰§è¡Œæ­¥éª¤çš„è¾“å…¥ã€‚</p><p><strong>æ‰§è¡Œé¡ºåº</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">SELECT</span> <span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token keyword">DISTINCT</span><span class="token operator">&lt;</span>Select_list<span class="token operator">&gt;</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token operator">&lt;</span>left_table<span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span>join_type<span class="token operator">&gt;</span><span class="token keyword">JOIN</span><span class="token operator">&lt;</span>right_table<span class="token operator">&gt;</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">ON</span><span class="token operator">&lt;</span>join_condition<span class="token operator">&gt;</span>
<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">WHERE</span><span class="token operator">&lt;</span>where_condition<span class="token operator">&gt;</span>
<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span><span class="token operator">&lt;</span>group_by_list<span class="token operator">&gt;</span>
<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">WITH</span> {CUBE<span class="token operator">|</span>ROLLUP}
<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token keyword">HAVING</span><span class="token operator">&lt;</span>having_condtion<span class="token operator">&gt;</span>
<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span><span class="token operator">&lt;</span>order_by_list<span class="token operator">&gt;</span>
<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">LIMIT</span><span class="token operator">&lt;</span>limit_number<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,55),V={href:"https://zhuanlan.zhihu.com/p/77847158",target:"_blank",rel:"noopener noreferrer"},X=o(`<h3 id="ã€å›°éš¾ã€‘ä¸€æ¡-sql-æŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„" tabindex="-1"><a class="header-anchor" href="#ã€å›°éš¾ã€‘ä¸€æ¡-sql-æŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„" aria-hidden="true">#</a> ã€å›°éš¾ã€‘ä¸€æ¡ SQL æŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿ</h3><figure><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/202410022029759.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>MySQL æ•´ä¸ªæŸ¥è¯¢æ‰§è¡Œè¿‡ç¨‹ï¼Œæ€»çš„æ¥è¯´åˆ†ä¸º 6 ä¸ªæ­¥éª¤ï¼š</p><ol><li><strong>è¿æ¥å™¨</strong> - å®¢æˆ·ç«¯å’Œ MySQL æœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼›è¿æ¥å™¨è´Ÿè´£è·Ÿå®¢æˆ·ç«¯<strong>å»ºç«‹è¿æ¥</strong>ã€<strong>è·å–æƒé™</strong>ã€<strong>ç»´æŒå’Œç®¡ç†è¿æ¥</strong>ã€‚</li><li><strong>æŸ¥è¯¢ç¼“å­˜</strong> - MySQL æœåŠ¡å™¨é¦–å…ˆæ£€æŸ¥æŸ¥è¯¢ç¼“å­˜ï¼Œå¦‚æœå‘½ä¸­ç¼“å­˜ï¼Œåˆ™ç«‹åˆ»è¿”å›ç»“æœã€‚å¦åˆ™è¿›å…¥ä¸‹ä¸€é˜¶æ®µã€‚MySQL ç¼“å­˜å¼Šå¤§äºåˆ©ï¼Œå› ä¸ºå¤±æ•ˆéå¸¸é¢‘ç¹â€”â€”ä»»ä½•æ›´æ–°éƒ½ä¼šæ¸…ç©ºæŸ¥è¯¢ç¼“å­˜ã€‚</li><li><strong>åˆ†æå™¨</strong> - MySQL æœåŠ¡å™¨è¿›è¡Œ SQL è§£æï¼š<strong>è¯­æ³•åˆ†æ</strong>ã€<strong>è¯æ³•åˆ†æ</strong>ã€‚</li><li><strong>ä¼˜åŒ–å™¨</strong> - MySQL æœåŠ¡å™¨ç”¨ä¼˜åŒ–å™¨<strong>ç”Ÿæˆå¯¹åº”çš„æ‰§è¡Œè®¡åˆ’</strong>ï¼Œ<strong>æ ¹æ®ç­–ç•¥é€‰æ‹©æœ€ä¼˜ç´¢å¼•</strong>ã€‚</li><li><strong>æ‰§è¡Œå™¨</strong> - MySQL æœåŠ¡å™¨æ ¹æ®æ‰§è¡Œè®¡åˆ’ï¼Œè°ƒç”¨å­˜å‚¨å¼•æ“çš„ API æ¥<strong>æ‰§è¡ŒæŸ¥è¯¢</strong>ã€‚</li><li><strong>è¿”å›ç»“æœ</strong> - MySQL æœåŠ¡å™¨å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ï¼ŒåŒæ—¶ç¼“å­˜æŸ¥è¯¢ç»“æœã€‚</li></ol><h3 id="ã€å›°éš¾ã€‘ä¸€æ¡-sql-æ›´æ–°è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„" tabindex="-1"><a class="header-anchor" href="#ã€å›°éš¾ã€‘ä¸€æ¡-sql-æ›´æ–°è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„" aria-hidden="true">#</a> ã€å›°éš¾ã€‘ä¸€æ¡ SQL æ›´æ–°è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿ</h3><p>æ›´æ–°æµç¨‹å’ŒæŸ¥è¯¢çš„æµç¨‹å¤§è‡´ç›¸åŒï¼Œä¸åŒä¹‹å¤„åœ¨äºï¼šæ›´æ–°æµç¨‹è¿˜æ¶‰åŠä¸¤ä¸ªé‡è¦çš„æ—¥å¿—æ¨¡å—ï¼š</p><ul><li><strong>redo logï¼ˆé‡åšæ—¥å¿—ï¼‰</strong><ul><li>InnoDB å­˜å‚¨å¼•æ“ç‹¬æœ‰çš„æ—¥å¿—ï¼ˆç‰©ç†æ—¥å¿—ï¼‰</li><li>é‡‡ç”¨å¾ªç¯å†™å…¥</li></ul></li><li><strong>bin logï¼ˆå½’æ¡£æ—¥å¿—ï¼‰</strong><ul><li>MySQL Server å±‚é€šç”¨æ—¥å¿—ï¼ˆé€»è¾‘æ—¥å¿—ï¼‰</li><li>é‡‡ç”¨è¿½åŠ å†™å…¥</li></ul></li></ul><p>ä¸ºäº†ä¿è¯ redo log å’Œ bin log çš„æ•°æ®ä¸€è‡´æ€§ï¼Œæ‰€ä»¥é‡‡ç”¨ä¸¤é˜¶æ®µæäº¤æ–¹å¼æ›´æ–°æ—¥å¿—ã€‚</p><h3 id="ã€å›°éš¾ã€‘mysql-å¦‚ä½•é€‰æ‹©æ‰§è¡Œè®¡åˆ’" tabindex="-1"><a class="header-anchor" href="#ã€å›°éš¾ã€‘mysql-å¦‚ä½•é€‰æ‹©æ‰§è¡Œè®¡åˆ’" aria-hidden="true">#</a> ã€å›°éš¾ã€‘MySQL å¦‚ä½•é€‰æ‹©æ‰§è¡Œè®¡åˆ’ï¼Ÿ</h3><p>MySQL é€šè¿‡ä¼˜åŒ–å™¨ï¼ˆOptimizerï¼‰é€‰æ‹©æ‰§è¡Œè®¡åˆ’ï¼Œæ ¸å¿ƒæµç¨‹å¦‚ä¸‹ï¼š</p><p><strong>æ‰§è¡Œè®¡åˆ’ç”Ÿæˆæ­¥éª¤</strong></p><ol><li><strong>è§£æ SQL</strong>ï¼šç”Ÿæˆè¯­æ³•æ ‘ï¼Œæ£€æŸ¥è¡¨/åˆ—æ˜¯å¦å­˜åœ¨</li><li><strong>é¢„å¤„ç†é˜¶æ®µ</strong>ï¼šå±•å¼€è§†å›¾ã€ä¼˜åŒ–å­æŸ¥è¯¢</li><li><strong>ä¼˜åŒ–å™¨æ ¸å¿ƒå·¥ä½œ</strong>ï¼š <ul><li><strong>ç”Ÿæˆå€™é€‰æ‰§è¡Œè®¡åˆ’</strong>ï¼ˆå…¨è¡¨æ‰«æã€ç´¢å¼•æ‰«æã€JOIN é¡ºåºç­‰ï¼‰</li><li><strong>æˆæœ¬ä¼°ç®—</strong>ï¼ˆåŸºäºç»Ÿè®¡ä¿¡æ¯è®¡ç®—æ¯ä¸ªè®¡åˆ’çš„ I/Oã€CPU æ¶ˆè€—ï¼‰</li><li><strong>é€‰æ‹©æˆæœ¬æœ€ä½çš„è®¡åˆ’</strong></li></ul></li></ol><p><strong>å½±å“æ‰§è¡Œè®¡åˆ’çš„å…³é”®å› ç´ </strong></p><table><thead><tr><th>å› ç´ </th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><strong>ç»Ÿè®¡ä¿¡æ¯</strong></td><td>è¡¨å¤§å°ã€ç´¢å¼•åŒºåˆ†åº¦ç­‰</td><td><code>ANALYZE TABLE</code>æ›´æ–°ç»Ÿè®¡</td></tr><tr><td><strong>ç´¢å¼•æƒ…å†µ</strong></td><td>å¯ç”¨ç´¢å¼•åŠå…¶é€‰æ‹©æ€§</td><td>é«˜åŒºåˆ†åº¦ç´¢å¼•ä¼˜å…ˆ</td></tr><tr><td><strong>æŸ¥è¯¢å¤æ‚åº¦</strong></td><td>JOIN/å­æŸ¥è¯¢æ•°é‡</td><td>ç®€å•æŸ¥è¯¢ä¼˜å…ˆèµ°ç´¢å¼•</td></tr><tr><td><strong>ç³»ç»Ÿå˜é‡</strong></td><td>ä¼˜åŒ–å™¨å¼€å…³é…ç½®</td><td><code>optimizer_switch</code>å‚æ•°</td></tr><tr><td><strong>HINT æŒ‡ä»¤</strong></td><td>å¼ºåˆ¶å¹²é¢„ä¼˜åŒ–å™¨</td><td><code>/*+ INDEX(idx_name) */</code></td></tr></tbody></table><p><strong>æˆæœ¬ä¼°ç®—æ¨¡å‹</strong></p><p>ä¼˜åŒ–å™¨ä¸»è¦è®¡ç®—ï¼š</p><ul><li><strong>I/O æˆæœ¬</strong>ï¼šè¯»å–æ•°æ®é¡µçš„ä»£ä»·</li><li><strong>CPU æˆæœ¬</strong>ï¼šå¤„ç†æ•°æ®çš„è®¡ç®—ä»£ä»·</li><li><strong>å†…å­˜æˆæœ¬</strong>ï¼šæ’åº/ä¸´æ—¶è¡¨æ¶ˆè€—</li></ul><div class="language-plaintext line-numbers-mode" data-ext="plaintext"><pre class="language-plaintext"><code>æ€»æˆæœ¬ = ï¼ˆæ•°æ®é¡µè¯»å–æ•° Ã— å•é¡µ I/O æˆæœ¬ï¼‰
       + ï¼ˆæ‰«æè¡Œæ•° Ã— è¡Œ CPU å¤„ç†æˆæœ¬ï¼‰
       + ï¼ˆæ’åºè¡Œæ•° Ã— æ’åºæˆæœ¬ï¼‰
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æŸ¥çœ‹å’Œå¹²é¢„æ‰§è¡Œè®¡åˆ’</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’</span>
<span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> age <span class="token operator">&gt;</span> <span class="token number">20</span><span class="token punctuation">;</span>

<span class="token comment">-- å¼ºåˆ¶ä½¿ç”¨ç´¢å¼•ï¼ˆæ…ç”¨ï¼‰</span>
<span class="token keyword">SELECT</span> <span class="token comment">/*+ INDEX(users idx_age) */</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> age <span class="token operator">&gt;</span> <span class="token number">20</span><span class="token punctuation">;</span>

<span class="token comment">-- æ›´æ–°ç»Ÿè®¡ä¿¡æ¯</span>
<span class="token keyword">ANALYZE</span> <span class="token keyword">TABLE</span> users<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å¸¸è§æ‰§è¡Œè®¡åˆ’é—®é¢˜</strong></p><ul><li><p><strong>ç´¢å¼•å¤±æ•ˆ</strong>ï¼šå‡½æ•°è®¡ç®—ã€éšå¼ç±»å‹è½¬æ¢</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- åä¾‹ï¼šç´¢å¼•å¤±æ•ˆ</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span>create_time<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2023</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>é”™è¯¯ JOIN é¡ºåº</strong>ï¼šè§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨<code>STRAIGHT_JOIN</code>å¼ºåˆ¶é¡ºåº</p></li><li><p><strong>ä¸´æ—¶è¡¨/æ–‡ä»¶æ’åº</strong>ï¼šå…³æ³¨<code>EXPLAIN</code>ä¸­çš„<code>Using temporary</code>/<code>Using filesort</code></p></li></ul><p><strong>ä¼˜åŒ–å»ºè®®</strong></p><ul><li>å®šæœŸ<code>ANALYZE TABLE</code>æ›´æ–°ç»Ÿè®¡ä¿¡æ¯</li><li>é¿å…åœ¨ç´¢å¼•åˆ—ä¸Šä½¿ç”¨å‡½æ•°</li><li>ä½¿ç”¨è¦†ç›–ç´¢å¼•å‡å°‘å›è¡¨</li><li>ç›‘æ§<code>performance_schema</code>ä¸­çš„ SQL æ‰§è¡Œå†å²</li></ul><blockquote><p><strong>æ³¨æ„</strong>ï¼šMySQL 8.0 å¼•å…¥ç›´æ–¹å›¾ç»Ÿè®¡ï¼ˆ<code>histogram</code>ï¼‰å’Œä»£ä»·æ¨¡å‹æ”¹è¿›ï¼Œå¤§å¹…æå‡å¤æ‚æŸ¥è¯¢çš„è®¡åˆ’å‡†ç¡®æ€§ã€‚</p></blockquote><h3 id="ã€å›°éš¾ã€‘order-by-æ˜¯æ€ä¹ˆå·¥ä½œçš„" tabindex="-1"><a class="header-anchor" href="#ã€å›°éš¾ã€‘order-by-æ˜¯æ€ä¹ˆå·¥ä½œçš„" aria-hidden="true">#</a> ã€å›°éš¾ã€‘<code>order by</code> æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ</h3><p>ç”¨ explain å‘½ä»¤æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’æ—¶ï¼ŒExtra è¿™ä¸ªå­—æ®µä¸­çš„â€œUsing filesortâ€è¡¨ç¤ºçš„å°±æ˜¯éœ€è¦æ’åºã€‚</p><h4 id="å…¨å­—æ®µæ’åº" tabindex="-1"><a class="header-anchor" href="#å…¨å­—æ®µæ’åº" aria-hidden="true">#</a> å…¨å­—æ®µæ’åº</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> city<span class="token punctuation">,</span>name<span class="token punctuation">,</span>age <span class="token keyword">from</span> t <span class="token keyword">where</span> city<span class="token operator">=</span><span class="token string">&#39;æ­å·&#39;</span> <span class="token keyword">order</span> <span class="token keyword">by</span> name <span class="token keyword">limit</span> <span class="token number">1000</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è¿™ä¸ªè¯­å¥æ‰§è¡Œæµç¨‹å¦‚ä¸‹æ‰€ç¤º ï¼š</p><p><strong>æ‰§è¡Œæµç¨‹</strong>ï¼š</p><ul><li>åˆå§‹åŒ– <code>sort_buffer</code>ï¼Œç¡®å®šæ”¾å…¥éœ€è¦æ’åºçš„å­—æ®µï¼ˆå¦‚ <code>name</code>ã€<code>city</code>ã€<code>age</code>ï¼‰ã€‚</li><li>ä»ç´¢å¼•ä¸­æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œå–å‡ºå¯¹åº”çš„å­—æ®µå€¼å­˜å…¥ <code>sort_buffer</code>ã€‚</li><li>å¯¹ <code>sort_buffer</code> ä¸­çš„æ•°æ®æŒ‰ç…§æ’åºå­—æ®µè¿›è¡Œæ’åºã€‚</li><li>è¿”å›æ’åºåçš„ç»“æœã€‚</li></ul><figure><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/20220728090300.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>å†…å­˜ä¸ç£ç›˜æ’åº</strong>ï¼š</p><ul><li>å¦‚æœæ’åºæ•°æ®é‡å°äº <code>sort_buffer_size</code>ï¼Œæ’åºåœ¨å†…å­˜ä¸­å®Œæˆã€‚</li><li>å¦‚æœæ•°æ®é‡è¿‡å¤§ï¼ŒMySQL ä¼šä½¿ç”¨ä¸´æ—¶æ–‡ä»¶è¿›è¡Œå¤–éƒ¨æ’åºï¼ˆå½’å¹¶æ’åºï¼‰ã€‚<strong>MySQL å°†éœ€è¦æ’åºçš„æ•°æ®åˆ†æˆ N ä»½ï¼Œæ¯ä¸€ä»½å•ç‹¬æ’åºåå­˜åœ¨è¿™äº›ä¸´æ—¶æ–‡ä»¶ä¸­ã€‚ç„¶åæŠŠè¿™ N ä¸ªæœ‰åºæ–‡ä»¶å†åˆå¹¶æˆä¸€ä¸ªæœ‰åºçš„å¤§æ–‡ä»¶ã€‚</strong></li></ul><p><strong>ä¼˜åŒ–å™¨è¿½è¸ª</strong>ï¼šé€šè¿‡ <code>OPTIMIZER_TRACE</code> å¯ä»¥æŸ¥çœ‹æ’åºè¿‡ç¨‹ä¸­æ˜¯å¦ä½¿ç”¨äº†ä¸´æ—¶æ–‡ä»¶ï¼ˆ<code>number_of_tmp_files</code>ï¼‰ã€‚</p><h4 id="rowid-æ’åº" tabindex="-1"><a class="header-anchor" href="#rowid-æ’åº" aria-hidden="true">#</a> rowid æ’åº</h4><ul><li><strong>æ‰§è¡Œæµç¨‹</strong>ï¼š <ul><li>å½“å•è¡Œæ•°æ®è¿‡å¤§æ—¶ï¼ŒMySQL ä¼šé‡‡ç”¨ <code>rowid</code> æ’åºï¼Œåªå°†æ’åºå­—æ®µï¼ˆå¦‚ <code>name</code>ï¼‰å’Œä¸»é”® <code>id</code> æ”¾å…¥ <code>sort_buffer</code>ã€‚</li><li>æ’åºå®Œæˆåï¼Œæ ¹æ® <code>id</code> å›è¡¨æŸ¥è¯¢å…¶ä»–å­—æ®µï¼ˆå¦‚ <code>city</code>ã€<code>age</code>ï¼‰ã€‚</li></ul></li><li><strong>æ€§èƒ½å½±å“</strong>ï¼š<code>rowid</code> æ’åºå‡å°‘äº† <code>sort_buffer</code> çš„å†…å­˜å ç”¨ï¼Œä½†å¢åŠ äº†å›è¡¨æ“ä½œï¼Œå¯¼è‡´æ›´å¤šçš„ç£ç›˜ I/Oã€‚</li></ul><figure><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/20220728090919.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="å…¨å­—æ®µæ’åº-vs-rowid-æ’åº" tabindex="-1"><a class="header-anchor" href="#å…¨å­—æ®µæ’åº-vs-rowid-æ’åº" aria-hidden="true">#</a> å…¨å­—æ®µæ’åº VS rowid æ’åº</h4><ul><li><strong>å†…å­˜ä¼˜å…ˆ</strong>ï¼š <ul><li>å¦‚æœå†…å­˜è¶³å¤Ÿå¤§ï¼ŒMySQL ä¼˜å…ˆä½¿ç”¨å…¨å­—æ®µæ’åºï¼Œä»¥å‡å°‘ç£ç›˜è®¿é—®ã€‚</li><li>åªæœ‰åœ¨å†…å­˜ä¸è¶³æ—¶ï¼Œæ‰ä¼šä½¿ç”¨ <code>rowid</code> æ’åºã€‚</li></ul></li><li><strong>è®¾è®¡æ€æƒ³</strong>ï¼š<strong>å¦‚æœå†…å­˜å¤Ÿï¼Œå°±è¦å¤šåˆ©ç”¨å†…å­˜ï¼Œå°½é‡å‡å°‘ç£ç›˜è®¿é—®ã€‚</strong></li></ul><p>å¹¶ä¸æ˜¯æ‰€æœ‰çš„ order by è¯­å¥ï¼Œéƒ½éœ€è¦æ’åºæ“ä½œçš„ã€‚MySQL ä¹‹æ‰€ä»¥éœ€è¦ç”Ÿæˆä¸´æ—¶è¡¨ï¼Œå¹¶ä¸”åœ¨ä¸´æ—¶è¡¨ä¸Šåšæ’åºæ“ä½œï¼Œ<strong>å…¶åŸå› æ˜¯åŸæ¥çš„æ•°æ®éƒ½æ˜¯æ— åºçš„</strong>ã€‚å¦‚æœæŸ¥è¯¢çš„å­—æ®µå’Œæ’åºå­—æ®µå¯ä»¥é€šè¿‡è”åˆç´¢å¼•è¦†ç›–ï¼ŒMySQL å¯ä»¥ç›´æ¥åˆ©ç”¨ç´¢å¼•çš„æœ‰åºæ€§ï¼Œé¿å…æ’åºæ“ä½œã€‚</p><h3 id="ã€å›°éš¾ã€‘å¦‚æœ-select-from-ä¸€ä¸ªæœ‰åƒä¸‡çº§æ•°æ®çš„è¡¨-å†…å­˜ä¼šé£™å‡ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#ã€å›°éš¾ã€‘å¦‚æœ-select-from-ä¸€ä¸ªæœ‰åƒä¸‡çº§æ•°æ®çš„è¡¨-å†…å­˜ä¼šé£™å‡ä¹ˆ" aria-hidden="true">#</a> ã€å›°éš¾ã€‘å¦‚æœ select * from ä¸€ä¸ªæœ‰åƒä¸‡çº§æ•°æ®çš„è¡¨ï¼Œå†…å­˜ä¼šé£™å‡ä¹ˆï¼Ÿ</h3><p><strong>é€šå¸¸ä¸ä¼šå¯¼è‡´ MySQL æœåŠ¡å™¨å†…å­˜é£™å‡ï¼Œä½†å¦‚æœå®¢æˆ·ç«¯å¤„ç†ä¸å½“ï¼Œå®¢æˆ·ç«¯çš„å†…å­˜å¯èƒ½ä¼šé£™å‡ã€‚</strong></p><ul><li>æœåŠ¡ç«¯ï¼š<code>SELECT * FROM huge_table</code> æ—¶ï¼ŒMySQL çš„ <strong>InnoDB å­˜å‚¨å¼•æ“</strong> å¹¶ä¸ä¼šå°è¯•å°†å…¨éƒ¨åƒä¸‡æ¡è®°å½•ä¸€æ¬¡æ€§åŠ è½½åˆ°å†…å­˜ä¸­ã€‚MySQL æœåŠ¡ç«¯ä½¿ç”¨å›ºå®šå¤§å°çš„ Buffer Pool æŒ‰éœ€è¯»å–æ•°æ®é¡µï¼Œå¹¶æµå¼åœ°å°†ç»“æœå‘é€ç»™å®¢æˆ·ç«¯ã€‚</li><li>å®¢æˆ·ç«¯ï¼šå¦‚æœå®¢æˆ·ç«¯å°è¯•ä¸€æ¬¡æ€§æ‹‰å–å…¨éƒ¨æ•°æ®ï¼Œå°±ä¼šå‡ºç°å†…å­˜é£™å‡çš„æƒ…å†µã€‚</li></ul><p><strong>å®¢æˆ·ç«¯æœ€ä½³å®è·µ</strong></p><p>èªæ˜çš„å®¢æˆ·ç«¯ä¼šä½¿ç”¨â€œæµå¼æŸ¥è¯¢â€æˆ–â€œæ¸¸æ ‡â€çš„æ–¹å¼æ¥å¤„ç†å¤§æ•°æ®é›†ã€‚</p><ul><li><strong>æœåŠ¡å™¨ç«¯æ¸¸æ ‡ï¼ˆServer-Side Cursorï¼‰</strong>ï¼šMySQL æä¾›äº†è¿™ç§æ–¹å¼ï¼ˆè™½ç„¶åè®®ä¸Šæ”¯æŒï¼Œä½†å¹¶éæ‰€æœ‰é©±åŠ¨éƒ½é»˜è®¤å¼€å¯ï¼‰ã€‚</li><li><strong>å®¢æˆ·ç«¯æµå¼è¯»å–ï¼ˆClient-Side Streamingï¼‰</strong>ï¼šå³ä½¿æ²¡æœ‰çœŸæ­£çš„æœåŠ¡å™¨ç«¯æ¸¸æ ‡ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ä»¥æµçš„æ–¹å¼å¤„ç†ç»“æœé›†ã€‚å®ƒä»ç½‘ç»œè¿æ¥ä¸­è¯»å–ä¸€æ‰¹æ•°æ®ï¼ˆä¾‹å¦‚ 1000 è¡Œï¼‰ï¼Œå¤„ç†å®Œè¿™æ‰¹æ•°æ®åï¼Œå†è¯»å–ä¸‹ä¸€æ‰¹ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§è¯»å–æ‰€æœ‰ã€‚ <ul><li><strong>Python (PyMySQL/MySQLdb)</strong>: åˆ›å»ºæ¸¸æ ‡æ—¶ä½¿ç”¨ <code>SSCursor</code>ï¼ˆ<code>cursorclass = pymysql.cursors.SSCursor</code>ï¼‰ã€‚</li><li><strong>Java (JDBC)</strong>: åœ¨åˆ›å»º <code>Statement</code> å¯¹è±¡æ—¶è®¾ç½® <code>fetchSize</code> ä¸º <code>Integer.MIN_VALUE</code>ï¼ˆæˆ–æ ¹æ®é©±åŠ¨æ–‡æ¡£è®¾ç½®ï¼‰æ¥å¯ç”¨æµå¼è¯»å–ã€‚</li></ul></li></ul><p>ä½¿ç”¨æµå¼å¤„ç†åï¼Œå®¢æˆ·ç«¯çš„å†…å­˜å ç”¨å°†ä¿æŒåœ¨ä¸€ä¸ª<strong>å¾ˆå°ä¸”æ’å®š</strong>çš„æ°´å¹³ï¼ˆåªç›¸å½“äºå•æ‰¹å¤„ç†æ•°æ®çš„å¤§å°ï¼‰ï¼Œè€Œä¸ä¼šéšç€ç»“æœé›†çš„å¤§å°è€Œå¢é•¿ã€‚</p><h2 id="mysql-ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#mysql-ä¼˜åŒ–" aria-hidden="true">#</a> MySQL ä¼˜åŒ–</h2><h3 id="ã€ç®€å•ã€‘å¦‚ä½•å‘ç°æ…¢-sql" tabindex="-1"><a class="header-anchor" href="#ã€ç®€å•ã€‘å¦‚ä½•å‘ç°æ…¢-sql" aria-hidden="true">#</a> ã€ç®€å•ã€‘å¦‚ä½•å‘ç°æ…¢ SQLï¼Ÿ</h3><p>æ…¢ SQL çš„ç›‘æ§ä¸»è¦é€šè¿‡ä¸¤ä¸ªé€”å¾„ï¼š</p><ul><li><strong>æ…¢æŸ¥è¯¢æ—¥å¿—</strong>ï¼šå¼€å¯ MySQL çš„æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå†é€šè¿‡ä¸€äº›å·¥å…·æ¯”å¦‚ mysqldumpslow å»åˆ†æå¯¹åº”çš„æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå½“ç„¶ç°åœ¨ä¸€èˆ¬çš„äº‘å‚å•†éƒ½æä¾›äº†å¯è§†åŒ–çš„å¹³å°ã€‚</li><li><strong>æœåŠ¡ç›‘æ§</strong>ï¼šå¯ä»¥åœ¨ä¸šåŠ¡çš„åŸºå»ºä¸­åŠ å…¥å¯¹æ…¢ SQL çš„ç›‘æ§ï¼Œå¸¸è§çš„æ–¹æ¡ˆæœ‰å­—èŠ‚ç æ’æ¡©ã€è¿æ¥æ± æ‰©å±•ã€ORM æ¡†æ¶è¿‡ç¨‹ï¼Œå¯¹æœåŠ¡è¿è¡Œä¸­çš„æ…¢ SQL è¿›è¡Œç›‘æ§å’Œå‘Šè­¦ã€‚</li></ul><h3 id="ã€ç®€å•ã€‘ä»€ä¹ˆæ˜¯æ‰§è¡Œè®¡åˆ’" tabindex="-1"><a class="header-anchor" href="#ã€ç®€å•ã€‘ä»€ä¹ˆæ˜¯æ‰§è¡Œè®¡åˆ’" aria-hidden="true">#</a> ã€ç®€å•ã€‘ä»€ä¹ˆæ˜¯æ‰§è¡Œè®¡åˆ’ï¼Ÿ</h3><p><strong>â€œæ‰§è¡Œè®¡åˆ’â€æ˜¯å¯¹ SQL æŸ¥è¯¢è¯­å¥åœ¨æ•°æ®åº“ä¸­æ‰§è¡Œè¿‡ç¨‹çš„æè¿°</strong>ã€‚ å¦‚æœè¦åˆ†ææŸæ¡ SQL çš„æ€§èƒ½é—®é¢˜ï¼Œé€šå¸¸éœ€è¦å…ˆæŸ¥çœ‹ SQL çš„æ‰§è¡Œè®¡åˆ’ï¼Œæ’æŸ¥æ¯ä¸€æ­¥ SQL æ‰§è¡Œæ˜¯å¦å­˜åœ¨é—®é¢˜ã€‚</p><p>å¾ˆå¤šæ•°æ®åº“éƒ½æ”¯æŒæ‰§è¡Œè®¡åˆ’ï¼ŒMySQL ä¹Ÿä¸ä¾‹å¤–ã€‚åœ¨ MySQL ä¸­ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ <code>EXPLAIN</code> å‘½ä»¤æŸ¥çœ‹ä¼˜åŒ–å™¨é’ˆå¯¹æŒ‡å®š SQL ç”Ÿæˆçš„é€»è¾‘æ‰§è¡Œè®¡åˆ’ã€‚</p><p>ã€ç¤ºä¾‹ã€‘MySQL æ‰§è¡Œè®¡åˆ’ç¤ºä¾‹</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> user_info <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">2</span>
<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span> <span class="token number">1.</span> <span class="token keyword">row</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>
           id: <span class="token number">1</span>
  select_type: <span class="token keyword">SIMPLE</span>
        <span class="token keyword">table</span>: user_info
   partitions: <span class="token boolean">NULL</span>
         <span class="token keyword">type</span>: const
possible_keys: <span class="token keyword">PRIMARY</span>
          <span class="token keyword">key</span>: <span class="token keyword">PRIMARY</span>
      key_len: <span class="token number">8</span>
          ref: const
         <span class="token keyword">rows</span>: <span class="token number">1</span>
     filtered: <span class="token number">100.00</span>
        Extra: <span class="token boolean">NULL</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span><span class="token punctuation">,</span> <span class="token number">1</span> warning <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œè®¡åˆ’è¿”å›ç»“æœå‚æ•°è¯´æ˜ï¼š</p><ul><li><code>id</code> - SELECT æŸ¥è¯¢çš„æ ‡è¯†ç¬¦ã€‚æ¯ä¸ª <code>SELECT</code> éƒ½ä¼šè‡ªåŠ¨åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ã€‚</li><li><code>select_type</code> - <code>SELECT</code> æŸ¥è¯¢çš„ç±»å‹ã€‚ <ul><li><code>SIMPLE</code> - è¡¨ç¤ºæ­¤æŸ¥è¯¢ä¸åŒ…å« <code>UNION</code> æŸ¥è¯¢æˆ–å­æŸ¥è¯¢ã€‚</li><li><code>PRIMARY</code> - è¡¨ç¤ºæ­¤æŸ¥è¯¢æ˜¯æœ€å¤–å±‚çš„æŸ¥è¯¢ã€‚</li><li><code>UNION</code> - è¡¨ç¤ºæ­¤æŸ¥è¯¢æ˜¯ <code>UNION</code> çš„ç¬¬äºŒæˆ–éšåçš„æŸ¥è¯¢ã€‚</li><li><code>DEPENDENT UNION</code> - <code>UNION</code> ä¸­çš„ç¬¬äºŒä¸ªæˆ–åé¢çš„æŸ¥è¯¢è¯­å¥ï¼Œå–å†³äºå¤–é¢çš„æŸ¥è¯¢ã€‚</li><li><code>UNION RESULT</code> - <code>UNION</code> çš„ç»“æœã€‚</li><li><code>SUBQUERY</code> - å­æŸ¥è¯¢ä¸­çš„ç¬¬ä¸€ä¸ª <code>SELECT</code>ã€‚</li><li><code>DEPENDENT SUBQUERY</code> - å­æŸ¥è¯¢ä¸­çš„ç¬¬ä¸€ä¸ª <code>SELECT</code>, å–å†³äºå¤–é¢çš„æŸ¥è¯¢ã€‚å³å­æŸ¥è¯¢ä¾èµ–äºå¤–å±‚æŸ¥è¯¢çš„ç»“æœã€‚</li></ul></li><li><code>table</code> - æŸ¥è¯¢çš„æ˜¯å“ªä¸ªè¡¨ï¼Œå¦‚æœç»™è¡¨èµ·åˆ«åäº†ï¼Œåˆ™æ˜¾ç¤ºåˆ«åã€‚</li><li><code>partitions</code> - åŒ¹é…çš„åˆ†åŒºã€‚</li><li><code>type</code> - è¡¨ç¤ºä»è¡¨ä¸­æŸ¥è¯¢åˆ°è¡Œæ‰€æ‰§è¡Œçš„æ–¹å¼ï¼ŒæŸ¥è¯¢æ–¹å¼æ˜¯ SQL ä¼˜åŒ–ä¸­ä¸€ä¸ªå¾ˆé‡è¦çš„æŒ‡æ ‡ã€‚æ‰§è¡Œæ•ˆç‡ç”±é«˜åˆ°ä½ä¾æ¬¡ä¸ºï¼š <ul><li><code>system</code>/<code>const</code> - è¡¨ä¸­åªæœ‰ä¸€è¡Œæ•°æ®åŒ¹é…ã€‚æ­¤æ—¶æ ¹æ®ç´¢å¼•æŸ¥è¯¢ä¸€æ¬¡å°±èƒ½æ‰¾åˆ°å¯¹åº”çš„æ•°æ®ã€‚å¦‚æœæ˜¯ B+ æ ‘ç´¢å¼•ï¼Œæˆ‘ä»¬çŸ¥é“æ­¤æ—¶ç´¢å¼•æ„é€ æˆäº†å¤šä¸ªå±‚çº§çš„æ ‘ï¼Œå½“æŸ¥è¯¢çš„ç´¢å¼•åœ¨æ ‘çš„åº•å±‚æ—¶ï¼ŒæŸ¥è¯¢æ•ˆç‡å°±è¶Šä½ã€‚<code>const</code> è¡¨ç¤ºæ­¤æ—¶ç´¢å¼•åœ¨ç¬¬ä¸€å±‚ï¼Œåªéœ€è®¿é—®ä¸€å±‚ä¾¿èƒ½å¾—åˆ°æ•°æ®ã€‚</li><li><code>eq_ref</code> - ä½¿ç”¨å”¯ä¸€ç´¢å¼•æ‰«æã€‚å¸¸è§äºå¤šè¡¨è¿æ¥ä¸­ä½¿ç”¨ä¸»é”®å’Œå”¯ä¸€ç´¢å¼•ä½œä¸ºå…³è”æ¡ä»¶ã€‚</li><li><code>ref</code> - éå”¯ä¸€ç´¢å¼•æ‰«æã€‚è¿˜å¯è§äºå”¯ä¸€ç´¢å¼•æœ€å·¦åŸåˆ™åŒ¹é…æ‰«æã€‚</li><li><code>range</code> - ç´¢å¼•èŒƒå›´æ‰«æã€‚æ¯”å¦‚ <code>&lt;</code>ï¼Œ<code>&gt;</code>ï¼Œ<code>between</code> ç­‰æ“ä½œã€‚</li><li><code>index</code> - ç´¢å¼•å…¨è¡¨æ‰«æã€‚æ­¤æ—¶éå†æ•´ä¸ªç´¢å¼•æ ‘ã€‚</li><li><code>ALL</code> - è¡¨ç¤ºå…¨è¡¨æ‰«æã€‚éœ€è¦éå†å…¨è¡¨æ¥æ‰¾åˆ°å¯¹åº”çš„è¡Œã€‚</li></ul></li><li><code>possible_keys</code> - æ­¤æ¬¡æŸ¥è¯¢ä¸­å¯èƒ½é€‰ç”¨çš„ç´¢å¼•ã€‚</li><li><code>key</code> - æ­¤æ¬¡æŸ¥è¯¢ä¸­å®é™…ä½¿ç”¨çš„ç´¢å¼•ã€‚å¦‚æœè¿™ä¸€é¡¹ä¸º <code>NULL</code>ï¼Œè¯´æ˜æ²¡æœ‰ä½¿ç”¨ç´¢å¼•ã€‚</li><li><code>ref</code> - å“ªä¸ªå­—æ®µæˆ–å¸¸æ•°ä¸ key ä¸€èµ·è¢«ä½¿ç”¨ã€‚</li><li><code>rows</code> - æ˜¾ç¤ºæ­¤æŸ¥è¯¢ä¸€å…±æ‰«æäº†å¤šå°‘è¡Œï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªä¼°è®¡å€¼ã€‚</li><li><code>filtered</code> - è¡¨ç¤ºæ­¤æŸ¥è¯¢æ¡ä»¶æ‰€è¿‡æ»¤çš„æ•°æ®çš„ç™¾åˆ†æ¯”ã€‚</li><li><code>extra</code> - é¢å¤–çš„ä¿¡æ¯ã€‚ <ul><li><code>Using index</code> - ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼Œæ— éœ€å›è¡¨ã€‚</li><li><code>Using where</code> - æœåŠ¡å™¨åœ¨å­˜å‚¨å¼•æ“æ£€ç´¢åè¿‡æ»¤ã€‚</li><li><code>Using temporary</code> - ä½¿ç”¨ä¸´æ—¶è¡¨ã€‚MySQL åœ¨å¯¹æŸ¥è¯¢ç»“æœæ’åºæ—¶ä½¿ç”¨ä¸´æ—¶è¡¨ï¼Œå¸¸è§äºæ’åº <code>ORDER BY</code> å’Œåˆ†ç»„æŸ¥è¯¢ <code>GROUP BY</code>ã€‚æ•ˆç‡ä½ï¼Œè¦é¿å…è¿™ç§é—®é¢˜çš„å‡ºç°ã€‚</li><li><code>Using filesort</code> - é¢å¤–æ’åºã€‚æ— æ³•åˆ©ç”¨ç´¢å¼•å®Œæˆæ’åºæ—¶ï¼Œå°±ä¸å¾—ä¸å°†æŸ¥è¯¢åŒ¹é…æ•°æ®è¿›è¡Œæ’åºï¼Œç”šè‡³å¯èƒ½ä¼šé€šè¿‡æ–‡ä»¶è¿›è¡Œæ’åºï¼Œæ•ˆç‡å¾ˆä½ã€‚</li><li><code>Using join buffer</code> - ä½¿ç”¨è¿æ¥ç¼“å†²</li></ul></li></ul>`,60),G={href:"https://segmentfault.com/a/1190000008131735",target:"_blank",rel:"noopener noreferrer"},W=o(`<h3 id="ã€ç®€å•ã€‘å¦‚ä½•åˆ†ææ‰§è¡Œè®¡åˆ’" tabindex="-1"><a class="header-anchor" href="#ã€ç®€å•ã€‘å¦‚ä½•åˆ†ææ‰§è¡Œè®¡åˆ’" aria-hidden="true">#</a> ã€ç®€å•ã€‘å¦‚ä½•åˆ†ææ‰§è¡Œè®¡åˆ’ï¼Ÿ</h3><p><strong>æ‰§è¡Œè®¡åˆ’å…³é”®å­—æ®µ</strong></p><ul><li><strong><code>type</code></strong> - æŒ‰æ€§èƒ½ä»é«˜åˆ°ä½æ’åºï¼š<code>system &gt; const &gt; eq_ref &gt; ref &gt; range &gt; index &gt; ALL</code>ã€‚ç›®æ ‡åº”å°½å¯èƒ½é¿å… <code>ALL</code>ï¼ˆå…¨è¡¨æ‰«æï¼‰ã€‚</li><li><strong><code>possible_keys</code></strong> - å¯èƒ½ä½¿ç”¨çš„ç´¢å¼•ã€‚</li><li><strong><code>key</code></strong> - å®é™…ä½¿ç”¨çš„ç´¢å¼•ã€‚</li><li><strong><code>rows</code></strong> - é¢„ä¼°éœ€è¦æ£€æŸ¥çš„è¡Œæ•°ï¼Œå€¼è¶Šå°è¶Šå¥½ã€‚</li><li><strong><code>Extra</code></strong> - åŒ…å«é‡è¦è¡¥å……ä¿¡æ¯ã€‚</li></ul><p><strong>æ‰§è¡Œè®¡åˆ’åˆ†ææ­¥éª¤</strong>ï¼š</p><ol><li>æŸ¥çœ‹ <code>type</code> - ç¡®ä¿è®¿é—®ç±»å‹ä¸º <code>const</code> ã€ <code>eq_ref</code> ã€ <code>ref</code> æˆ– <code>range</code> ï¼Œé¿å… <code>ALL</code> ã€‚</li><li>æŸ¥çœ‹ <code>key</code> - ç¡®è®¤æ˜¯å¦ä½¿ç”¨äº†åˆé€‚çš„ç´¢å¼•ã€‚è‹¥ <code>key</code> ä¸º <code>NULL</code> è¡¨ç¤ºæœªä½¿ç”¨ç´¢å¼•ï¼Œéœ€ä¼˜åŒ–ã€‚</li><li>æŸ¥çœ‹ <code>rows</code> - æ‰«æçš„è¡Œæ•°è¶Šå°‘è¶Šå¥½ã€‚</li><li>æŸ¥çœ‹ <code>Extra</code> - é¿å… <code>Using temporary</code>ï¼ˆä½¿ç”¨ä¸´æ—¶è¡¨ï¼‰ å’Œ <code>Using filesort</code> ï¼ˆé¢å¤–æ’åºï¼‰ã€‚</li></ol><p>å¯¹åº”ä¼˜åŒ–ï¼š</p><ul><li>å¦‚æœ <code>type</code> ä¸º <code>ALL</code>ï¼Œè€ƒè™‘ä¸º <code>WHERE</code> æ¡ä»¶åˆ—æ·»åŠ ç´¢å¼•ã€‚</li><li>å¦‚æœ <code>Extra</code> åŒ…å« <code>Using filesort</code> ï¼Œä¼˜åŒ– <code>ORDER BY</code> æˆ– <code>GROUP BY</code> ã€‚</li><li>å¦‚æœ <code>rows</code> è¿‡å¤§ï¼Œæ£€æŸ¥ç´¢å¼•æ˜¯å¦æœ‰æ•ˆã€‚</li></ul><h3 id="ã€ä¸­ç­‰ã€‘å¦‚ä½•ä¼˜åŒ–-sql" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘å¦‚ä½•ä¼˜åŒ–-sql" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘å¦‚ä½•ä¼˜åŒ– SQLï¼Ÿ</h3><h4 id="é¿å…ä¸å¿…è¦çš„åˆ—" tabindex="-1"><a class="header-anchor" href="#é¿å…ä¸å¿…è¦çš„åˆ—" aria-hidden="true">#</a> é¿å…ä¸å¿…è¦çš„åˆ—</h4><p>è¿™ä¸ªæ˜¯è€ç”Ÿå¸¸è°ˆï¼Œä½†è¿˜æ˜¯ç»å¸¸ä¼šå‡ºçš„æƒ…å†µï¼ŒSQL æŸ¥è¯¢çš„æ—¶å€™ï¼Œåº”è¯¥åªæŸ¥è¯¢éœ€è¦çš„åˆ—ï¼Œè€Œä¸è¦åŒ…å«é¢å¤–çš„åˆ—ï¼Œåƒ<code>slect *</code> è¿™ç§å†™æ³•åº”è¯¥å°½é‡é¿å…ã€‚</p><h4 id="åˆ†é¡µä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#åˆ†é¡µä¼˜åŒ–" aria-hidden="true">#</a> åˆ†é¡µä¼˜åŒ–</h4><p>åœ¨æ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œåˆ†é¡µæ¯”è¾ƒæ·±çš„æƒ…å†µä¸‹ï¼Œéœ€è¦è€ƒè™‘åˆ†é¡µçš„ä¼˜åŒ–ã€‚</p><p>ä¾‹å¦‚ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">table</span> <span class="token keyword">where</span> <span class="token keyword">type</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">and</span> <span class="token keyword">level</span> <span class="token operator">=</span> <span class="token number">9</span> <span class="token keyword">order</span> <span class="token keyword">by</span> id <span class="token keyword">asc</span> <span class="token keyword">limit</span> <span class="token number">190289</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¼˜åŒ–æ–¹æ¡ˆï¼š</p><ul><li><strong>å»¶è¿Ÿå…³è”</strong></li></ul><p>å…ˆé€šè¿‡ where æ¡ä»¶æå–å‡ºä¸»é”®ï¼Œåœ¨å°†è¯¥è¡¨ä¸åŸæ•°æ®è¡¨å…³è”ï¼Œé€šè¿‡ä¸»é”® id æå–æ•°æ®è¡Œï¼Œè€Œä¸æ˜¯é€šè¿‡åŸæ¥çš„äºŒçº§ç´¢å¼•æå–æ•°æ®è¡Œ</p><p>ä¾‹å¦‚ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> a<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">table</span> a<span class="token punctuation">,</span>
 <span class="token punctuation">(</span><span class="token keyword">select</span> id <span class="token keyword">from</span> <span class="token keyword">table</span> <span class="token keyword">where</span> <span class="token keyword">type</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">and</span> <span class="token keyword">level</span> <span class="token operator">=</span> <span class="token number">9</span> <span class="token keyword">order</span> <span class="token keyword">by</span> id <span class="token keyword">asc</span> <span class="token keyword">limit</span> <span class="token number">190289</span><span class="token punctuation">,</span><span class="token number">10</span> <span class="token punctuation">)</span> b
 <span class="token keyword">where</span> a<span class="token punctuation">.</span>id <span class="token operator">=</span> b<span class="token punctuation">.</span>id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>ä¹¦ç­¾æ–¹å¼</strong></li></ul><p>ä¹¦ç­¾æ–¹å¼å°±æ˜¯æ‰¾åˆ° limit ç¬¬ä¸€ä¸ªå‚æ•°å¯¹åº”çš„ä¸»é”®å€¼ï¼Œæ ¹æ®è¿™ä¸ªä¸»é”®å€¼å†å»è¿‡æ»¤å¹¶ limit</p><p>ä¾‹å¦‚ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>  <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">table</span> <span class="token keyword">where</span> id <span class="token operator">&gt;</span>
  <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">table</span> <span class="token keyword">where</span> <span class="token keyword">type</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">and</span> <span class="token keyword">level</span> <span class="token operator">=</span> <span class="token number">9</span> <span class="token keyword">order</span> <span class="token keyword">by</span> id <span class="token keyword">asc</span> <span class="token keyword">limit</span> <span class="token number">190</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç´¢å¼•ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•ä¼˜åŒ–" aria-hidden="true">#</a> ç´¢å¼•ä¼˜åŒ–</h4><p>åˆç†åœ°è®¾è®¡å’Œä½¿ç”¨ç´¢å¼•ï¼Œæ˜¯ä¼˜åŒ–æ…¢ SQL çš„åˆ©å™¨ã€‚</p><p><strong>åˆ©ç”¨è¦†ç›–ç´¢å¼•</strong></p><p>InnoDB ä½¿ç”¨éä¸»é”®ç´¢å¼•æŸ¥è¯¢æ•°æ®æ—¶ä¼šå›è¡¨ï¼Œä½†æ˜¯å¦‚æœç´¢å¼•çš„å¶èŠ‚ç‚¹ä¸­å·²ç»åŒ…å«è¦æŸ¥è¯¢çš„å­—æ®µï¼Œé‚£å®ƒæ²¡æœ‰å¿…è¦å†å›è¡¨æŸ¥è¯¢äº†ï¼Œè¿™å°±å«è¦†ç›–ç´¢å¼•</p><p>ä¾‹å¦‚å¯¹äºå¦‚ä¸‹æŸ¥è¯¢ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> name <span class="token keyword">from</span> test <span class="token keyword">where</span> city<span class="token operator">=</span><span class="token string">&#39;ä¸Šæµ·&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æˆ‘ä»¬å°†è¢«æŸ¥è¯¢çš„å­—æ®µå»ºç«‹åˆ°è”åˆç´¢å¼•ä¸­ï¼Œè¿™æ ·æŸ¥è¯¢ç»“æœå°±å¯ä»¥ç›´æ¥ä»ç´¢å¼•ä¸­è·å–</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> test <span class="token keyword">add</span> <span class="token keyword">index</span> idx_city_name <span class="token punctuation">(</span>city<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>ä½ç‰ˆæœ¬é¿å…ä½¿ç”¨ or æŸ¥è¯¢</strong></p><p>åœ¨ MySQL 5.0 ä¹‹å‰çš„ç‰ˆæœ¬è¦å°½é‡é¿å…ä½¿ç”¨ or æŸ¥è¯¢ï¼Œå¯ä»¥ä½¿ç”¨ union æˆ–è€…å­æŸ¥è¯¢æ¥æ›¿ä»£ï¼Œå› ä¸ºæ—©æœŸçš„ MySQL ç‰ˆæœ¬ä½¿ç”¨ or æŸ¥è¯¢å¯èƒ½ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆï¼Œé«˜ç‰ˆæœ¬å¼•å…¥äº†ç´¢å¼•åˆå¹¶ï¼Œè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p><p><strong>é¿å…ä½¿ç”¨ != æˆ–è€… &lt;&gt; æ“ä½œç¬¦</strong></p><p>SQL ä¸­ï¼Œä¸ç­‰äºæ“ä½œç¬¦ä¼šå¯¼è‡´æŸ¥è¯¢å¼•æ“æ”¾å¼ƒæŸ¥è¯¢ç´¢å¼•ï¼Œå¼•èµ·å…¨è¡¨æ‰«æï¼Œå³ä½¿æ¯”è¾ƒçš„å­—æ®µä¸Šæœ‰ç´¢å¼•</p><p>è§£å†³æ–¹æ³•ï¼šé€šè¿‡æŠŠä¸ç­‰äºæ“ä½œç¬¦æ”¹æˆ orï¼Œå¯ä»¥ä½¿ç”¨ç´¢å¼•ï¼Œé¿å…å…¨è¡¨æ‰«æ</p><p>ä¾‹å¦‚ï¼ŒæŠŠ<code>column&lt;&gt;â€™aaaâ€™ï¼Œæ”¹æˆ column&gt;â€™aaaâ€™ or column&lt;â€™aaaâ€™</code>ï¼Œå°±å¯ä»¥ä½¿ç”¨ç´¢å¼•äº†</p><p><strong>é€‚å½“ä½¿ç”¨å‰ç¼€ç´¢å¼•</strong></p><p>é€‚å½“åœ°ä½¿ç”¨å‰ç¼€æ‰€äº‘ï¼Œå¯ä»¥é™ä½ç´¢å¼•çš„ç©ºé—´å ç”¨ï¼Œæé«˜ç´¢å¼•çš„æŸ¥è¯¢æ•ˆç‡ã€‚</p><p>æ¯”å¦‚ï¼Œé‚®ç®±çš„åç¼€éƒ½æ˜¯å›ºå®šçš„â€œ<code>@xxx.com</code>â€ï¼Œé‚£ä¹ˆç±»ä¼¼è¿™ç§åé¢å‡ ä½ä¸ºå›ºå®šå€¼çš„å­—æ®µå°±éå¸¸é€‚åˆå®šä¹‰ä¸ºå‰ç¼€ç´¢å¼•</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> test <span class="token keyword">add</span> <span class="token keyword">index</span> index2<span class="token punctuation">(</span>email<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>PS: éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå‰ç¼€ç´¢å¼•ä¹Ÿå­˜åœ¨ç¼ºç‚¹ï¼ŒMySQL æ— æ³•åˆ©ç”¨å‰ç¼€ç´¢å¼•åš order by å’Œ group by æ“ä½œï¼Œä¹Ÿæ— æ³•ä½œä¸ºè¦†ç›–ç´¢å¼•</p><p><strong>é¿å…åˆ—ä¸Šå‡½æ•°è¿ç®—</strong></p><p>è¦é¿å…åœ¨åˆ—å­—æ®µä¸Šè¿›è¡Œç®—æœ¯è¿ç®—æˆ–å…¶ä»–è¡¨è¾¾å¼è¿ç®—ï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´å­˜å‚¨å¼•æ“æ— æ³•æ­£ç¡®ä½¿ç”¨ç´¢å¼•ï¼Œä»è€Œå½±å“äº†æŸ¥è¯¢çš„æ•ˆç‡</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test <span class="token keyword">where</span> <span class="token keyword">month</span><span class="token punctuation">(</span>updateTime<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ­£ç¡®ä½¿ç”¨è”åˆç´¢å¼•</strong></p><p>ä½¿ç”¨è”åˆç´¢å¼•çš„æ—¶å€™ï¼Œæ³¨æ„æœ€å·¦åŒ¹é…åŸåˆ™ã€‚</p><h4 id="join-ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#join-ä¼˜åŒ–" aria-hidden="true">#</a> JOIN ä¼˜åŒ–</h4><p><strong>ä¼˜åŒ–å­æŸ¥è¯¢</strong></p><p>å°½é‡ä½¿ç”¨ Join è¯­å¥æ¥æ›¿ä»£å­æŸ¥è¯¢ï¼Œå› ä¸ºå­æŸ¥è¯¢æ˜¯åµŒå¥—æŸ¥è¯¢ï¼Œè€ŒåµŒå¥—æŸ¥è¯¢ä¼šæ–°åˆ›å»ºä¸€å¼ ä¸´æ—¶è¡¨ï¼Œè€Œä¸´æ—¶è¡¨çš„åˆ›å»ºä¸é”€æ¯ä¼šå ç”¨ä¸€å®šçš„ç³»ç»Ÿèµ„æºä»¥åŠèŠ±è´¹ä¸€å®šçš„æ—¶é—´ï¼ŒåŒæ—¶å¯¹äºè¿”å›ç»“æœé›†æ¯”è¾ƒå¤§çš„å­æŸ¥è¯¢ï¼Œå…¶å¯¹æŸ¥è¯¢æ€§èƒ½çš„å½±å“æ›´å¤§</p><p><strong>å°è¡¨é©±åŠ¨å¤§è¡¨</strong></p><p>å…³è”æŸ¥è¯¢çš„æ—¶å€™è¦æ‹¿å°è¡¨å»é©±åŠ¨å¤§è¡¨ï¼Œå› ä¸ºå…³è”çš„æ—¶å€™ï¼ŒMySQL å†…éƒ¨ä¼šéå†é©±åŠ¨è¡¨ï¼Œå†å»è¿æ¥è¢«é©±åŠ¨è¡¨ã€‚</p><p>æ¯”å¦‚ left joinï¼Œå·¦è¡¨å°±æ˜¯é©±åŠ¨è¡¨ï¼ŒA è¡¨å°äº B è¡¨ï¼Œå»ºç«‹è¿æ¥çš„æ¬¡æ•°å°±å°‘ï¼ŒæŸ¥è¯¢é€Ÿåº¦å°±è¢«åŠ å¿«äº†ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code> <span class="token keyword">select</span> name <span class="token keyword">from</span> A <span class="token keyword">left</span> <span class="token keyword">join</span> B <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>é€‚å½“å¢åŠ å†—ä½™å­—æ®µ</strong></p><p>å¢åŠ å†—ä½™å­—æ®µå¯ä»¥å‡å°‘å¤§é‡çš„è¿è¡¨æŸ¥è¯¢ï¼Œå› ä¸ºå¤šå¼ è¡¨çš„è¿è¡¨æŸ¥è¯¢æ€§èƒ½å¾ˆä½ï¼Œæ‰€æœ‰å¯ä»¥é€‚å½“çš„å¢åŠ å†—ä½™å­—æ®µï¼Œä»¥å‡å°‘å¤šå¼ è¡¨çš„å…³è”æŸ¥è¯¢ï¼Œè¿™æ˜¯ä»¥ç©ºé—´æ¢æ—¶é—´çš„ä¼˜åŒ–ç­–ç•¥</p><p><strong>é¿å…ä½¿ç”¨ JOIN å…³è”å¤ªå¤šçš„è¡¨</strong></p><p>ã€Šé˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œã€‹è§„å®šä¸è¦ join è¶…è¿‡ä¸‰å¼ è¡¨ï¼Œç¬¬ä¸€ join å¤ªå¤šé™ä½æŸ¥è¯¢çš„é€Ÿåº¦ï¼Œç¬¬äºŒ join çš„ buffer ä¼šå ç”¨æ›´å¤šçš„å†…å­˜ã€‚</p><p>å¦‚æœä¸å¯é¿å…è¦ join å¤šå¼ è¡¨ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨æ•°æ®å¼‚æ„çš„æ–¹å¼å¼‚æ„åˆ° ES ä¸­æŸ¥è¯¢ã€‚</p><h4 id="æ’åºä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#æ’åºä¼˜åŒ–" aria-hidden="true">#</a> æ’åºä¼˜åŒ–</h4><p><strong>åˆ©ç”¨ç´¢å¼•æ‰«æåšæ’åº</strong></p><p>MySQL æœ‰ä¸¤ç§æ–¹å¼ç”Ÿæˆæœ‰åºç»“æœï¼šå…¶ä¸€æ˜¯å¯¹ç»“æœé›†è¿›è¡Œæ’åºçš„æ“ä½œï¼Œå…¶äºŒæ˜¯æŒ‰ç…§ç´¢å¼•é¡ºåºæ‰«æå¾—å‡ºçš„ç»“æœè‡ªç„¶æ˜¯æœ‰åºçš„</p><p>ä½†æ˜¯å¦‚æœç´¢å¼•ä¸èƒ½è¦†ç›–æŸ¥è¯¢æ‰€éœ€åˆ—ï¼Œå°±ä¸å¾—ä¸æ¯æ‰«æä¸€æ¡è®°å½•å›è¡¨æŸ¥è¯¢ä¸€æ¬¡ï¼Œè¿™ä¸ªè¯»æ“ä½œæ˜¯éšæœº IOï¼Œé€šå¸¸ä¼šæ¯”é¡ºåºå…¨è¡¨æ‰«æè¿˜æ…¢</p><p>å› æ­¤ï¼Œåœ¨è®¾è®¡ç´¢å¼•æ—¶ï¼Œå°½å¯èƒ½ä½¿ç”¨åŒä¸€ä¸ªç´¢å¼•æ—¢æ»¡è¶³æ’åºåˆç”¨äºæŸ¥æ‰¾è¡Œ</p><p>ä¾‹å¦‚ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">--å»ºç«‹ç´¢å¼•ï¼ˆdate,staff_id,customer_idï¼‰</span>
<span class="token keyword">select</span> staff_id<span class="token punctuation">,</span> customer_id <span class="token keyword">from</span> test <span class="token keyword">where</span> <span class="token keyword">date</span> <span class="token operator">=</span> <span class="token string">&#39;2010-01-01&#39;</span> <span class="token keyword">order</span> <span class="token keyword">by</span> staff_id<span class="token punctuation">,</span>customer_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>åªæœ‰å½“ç´¢å¼•çš„åˆ—é¡ºåºå’Œ ORDER BY å­å¥çš„é¡ºåºå®Œå…¨ä¸€è‡´ï¼Œå¹¶ä¸”æ‰€æœ‰åˆ—çš„æ’åºæ–¹å‘éƒ½ä¸€æ ·æ—¶ï¼Œæ‰èƒ½å¤Ÿä½¿ç”¨ç´¢å¼•æ¥å¯¹ç»“æœåšæ’åº</p><p><strong>æ¡ä»¶ä¸‹æ¨</strong></p><p>MySQL å¤„ç† union çš„ç­–ç•¥æ˜¯å…ˆåˆ›å»ºä¸´æ—¶è¡¨ï¼Œç„¶åå°†å„ä¸ªæŸ¥è¯¢ç»“æœå¡«å……åˆ°ä¸´æ—¶è¡¨ä¸­æœ€åå†æ¥åšæŸ¥è¯¢ï¼Œå¾ˆå¤šä¼˜åŒ–ç­–ç•¥åœ¨ union æŸ¥è¯¢ä¸­éƒ½ä¼šå¤±æ•ˆï¼Œå› ä¸ºå®ƒæ— æ³•åˆ©ç”¨ç´¢å¼•</p><p>æœ€å¥½æ‰‹å·¥å°† whereã€limit ç­‰å­å¥ä¸‹æ¨åˆ° union çš„å„ä¸ªå­æŸ¥è¯¢ä¸­ï¼Œä»¥ä¾¿ä¼˜åŒ–å™¨å¯ä»¥å……åˆ†åˆ©ç”¨è¿™äº›æ¡ä»¶è¿›è¡Œä¼˜åŒ–</p><p>æ­¤å¤–ï¼Œé™¤éç¡®å®éœ€è¦æœåŠ¡å™¨å»é‡ï¼Œä¸€å®šè¦ä½¿ç”¨ union allï¼Œå¦‚æœä¸åŠ  all å…³é”®å­—ï¼ŒMySQL ä¼šç»™ä¸´æ—¶è¡¨åŠ ä¸Š distinct é€‰é¡¹ï¼Œè¿™ä¼šå¯¼è‡´å¯¹æ•´ä¸ªä¸´æ—¶è¡¨åšå”¯ä¸€æ€§æ£€æŸ¥ï¼Œä»£ä»·å¾ˆé«˜ã€‚</p><h3 id="ã€ä¸­ç­‰ã€‘mysql-ä¸­å¦‚ä½•è§£å†³æ·±åˆ†é¡µé—®é¢˜" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘mysql-ä¸­å¦‚ä½•è§£å†³æ·±åˆ†é¡µé—®é¢˜" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘MySQL ä¸­å¦‚ä½•è§£å†³æ·±åˆ†é¡µé—®é¢˜ï¼Ÿ</h3><p>æ·±åˆ†é¡µ (Deep Pagination) æ˜¯æŒ‡å½“æ•°æ®é‡å¾ˆå¤§æ—¶ï¼ŒæŸ¥è¯¢é åçš„åˆ†é¡µæ•°æ®ï¼ˆæ¯”å¦‚ç¬¬ 1000 é¡µï¼‰æ€§èƒ½æ€¥å‰§ä¸‹é™çš„é—®é¢˜ã€‚</p><p>è§£å†³æ–¹æ¡ˆæœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><p>ï¼ˆ1ï¼‰<strong>ä½¿ç”¨ç´¢å¼•è¦†ç›–+å»¶è¿Ÿå…³è”</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- åŸå§‹æ·±åˆ†é¡µæŸ¥è¯¢ï¼ˆæ€§èƒ½å·®ï¼‰</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> large_table <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> id <span class="token keyword">LIMIT</span> <span class="token number">100000</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token comment">-- ä¼˜åŒ–åçš„æŸ¥è¯¢</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> large_table
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> id <span class="token keyword">FROM</span> large_table
    <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> id
    <span class="token keyword">LIMIT</span> <span class="token number">100000</span><span class="token punctuation">,</span> <span class="token number">10</span>
<span class="token punctuation">)</span> <span class="token keyword">AS</span> tmp <span class="token keyword">USING</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ï¼ˆ2ï¼‰<strong>ä½¿ç”¨æ¸¸æ ‡åˆ†é¡µ</strong>ï¼ˆè®°å½•ä¸Šä¸€é¡µæœ€åä¸€æ¡è®°å½•ï¼‰</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- ç¬¬ä¸€é¡µ</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> large_table <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> id <span class="token keyword">LIMIT</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token comment">-- è·å–ä¸Šä¸€é¡µæœ€åä¸€æ¡è®°å½•çš„ id=12345</span>
<span class="token comment">-- ä¸‹ä¸€é¡µæŸ¥è¯¢</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> large_table
<span class="token keyword">WHERE</span> id <span class="token operator">&gt;</span> <span class="token number">12345</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> id
<span class="token keyword">LIMIT</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ï¼ˆ3ï¼‰<strong>ä½¿ç”¨å­æŸ¥è¯¢ä¼˜åŒ–</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> large_table
<span class="token keyword">WHERE</span> id <span class="token operator">&gt;=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> id <span class="token keyword">FROM</span> large_table <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> id <span class="token keyword">LIMIT</span> <span class="token number">100000</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> id
<span class="token keyword">LIMIT</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ã€ä¸­ç­‰ã€‘å“ªç§-count-æ€§èƒ½æœ€å¥½" tabindex="-1"><a class="header-anchor" href="#ã€ä¸­ç­‰ã€‘å“ªç§-count-æ€§èƒ½æœ€å¥½" aria-hidden="true">#</a> ã€ä¸­ç­‰ã€‘å“ªç§ COUNT æ€§èƒ½æœ€å¥½ï¼Ÿ</h3><p>å…ˆè¯´ç»“è®ºï¼š<strong>æŒ‰ç…§æ•ˆç‡æ’åºçš„è¯ï¼Œ<code>COUNTï¼ˆå­—æ®µï¼‰</code> &lt; <code>COUNTï¼ˆä¸»é”® id)</code> &lt; <code>COUNT(1)</code> â‰ˆ <code>COUNT(*)</code></strong>ã€‚<strong>æ¨èé‡‡ç”¨ <code>COUNT(*)</code></strong> ã€‚</p><p><strong>å¯¹äº <code>COUNTï¼ˆä¸»é”® id)</code> æ¥è¯´</strong>ï¼ŒInnoDB å¼•æ“ä¼šéå†æ•´å¼ è¡¨ï¼ŒæŠŠæ¯ä¸€è¡Œçš„ id å€¼éƒ½å–å‡ºæ¥ï¼Œè¿”å›ç»™ server å±‚ã€‚server å±‚æ‹¿åˆ° id åï¼Œåˆ¤æ–­æ˜¯ä¸å¯èƒ½ä¸ºç©ºçš„ï¼Œå°±æŒ‰è¡Œç´¯åŠ ã€‚</p><p><strong>å¯¹äº <code>COUNT(1)</code> æ¥è¯´</strong>ï¼ŒInnoDB å¼•æ“éå†æ•´å¼ è¡¨ï¼Œä½†ä¸å–å€¼ã€‚server å±‚å¯¹äºè¿”å›çš„æ¯ä¸€è¡Œï¼Œæ”¾ä¸€ä¸ªæ•°å­—â€œ1â€è¿›å»ï¼Œåˆ¤æ–­æ˜¯ä¸å¯èƒ½ä¸ºç©ºçš„ï¼ŒæŒ‰è¡Œç´¯åŠ ã€‚</p><p>å•çœ‹è¿™ä¸¤ä¸ªç”¨æ³•çš„å·®åˆ«çš„è¯ï¼Œä½ èƒ½å¯¹æ¯”å‡ºæ¥ï¼Œ<code>COUNT(1)</code> æ‰§è¡Œå¾—è¦æ¯” <code>COUNTï¼ˆä¸»é”® id)</code> å¿«ã€‚å› ä¸ºä»å¼•æ“è¿”å› id ä¼šæ¶‰åŠåˆ°è§£ææ•°æ®è¡Œï¼Œä»¥åŠæ‹·è´å­—æ®µå€¼çš„æ“ä½œã€‚</p><p><strong>å¯¹äº <code>COUNTï¼ˆå­—æ®µï¼‰</code> æ¥è¯´</strong>ï¼š</p><ul><li>å¦‚æœè¿™ä¸ªâ€œå­—æ®µâ€æ˜¯å®šä¹‰ä¸º <code>not null</code> çš„è¯ï¼Œä¸€è¡Œè¡Œåœ°ä»è®°å½•é‡Œé¢è¯»å‡ºè¿™ä¸ªå­—æ®µï¼Œåˆ¤æ–­ä¸èƒ½ä¸º <code>null</code>ï¼ŒæŒ‰è¡Œç´¯åŠ ï¼›</li><li>å¦‚æœè¿™ä¸ªâ€œå­—æ®µâ€å®šä¹‰å…è®¸ä¸º <code>null</code>ï¼Œé‚£ä¹ˆæ‰§è¡Œçš„æ—¶å€™ï¼Œåˆ¤æ–­åˆ°æœ‰å¯èƒ½æ˜¯ <code>null</code>ï¼Œè¿˜è¦æŠŠå€¼å–å‡ºæ¥å†åˆ¤æ–­ä¸€ä¸‹ï¼Œä¸æ˜¯ <code>null</code> æ‰ç´¯åŠ ã€‚</li></ul><p><strong>ä½†æ˜¯ <code>COUNT(*)</code> æ˜¯ä¾‹å¤–</strong>ï¼Œå¹¶ä¸ä¼šæŠŠå…¨éƒ¨å­—æ®µå–å‡ºæ¥ï¼Œè€Œæ˜¯ä¸“é—¨åšäº†ä¼˜åŒ–ï¼Œä¸å–å€¼ã€‚<code>COUNT(*)</code> è‚¯å®šä¸æ˜¯ <code>null</code>ï¼ŒæŒ‰è¡Œç´¯åŠ ã€‚</p><blockquote><p>InnoDB å’Œ MyISAM çš„ <code>count(*)</code> å®ç°æ–¹å¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p></blockquote><p>ä¸åŒçš„ MySQL å¼•æ“ä¸­ï¼Œ<code>COUNT(*)</code> æœ‰ä¸åŒçš„å®ç°æ–¹å¼ï¼š</p><ul><li>MyISAM å¼•æ“æŠŠä¸€ä¸ªè¡¨çš„æ€»è¡Œæ•°å­˜åœ¨äº†ç£ç›˜ä¸Šï¼Œå› æ­¤æ‰§è¡Œ <code>COUNT(*)</code> çš„æ—¶å€™ä¼šç›´æ¥è¿”å›è¿™ä¸ªæ•°ï¼Œæ•ˆç‡å¾ˆé«˜ï¼›</li><li>è€Œ InnoDB å¼•æ“å°±éº»çƒ¦äº†ï¼Œå®ƒæ‰§è¡Œ <code>COUNT(*)</code> çš„æ—¶å€™ï¼Œéœ€è¦æŠŠæ•°æ®ä¸€è¡Œä¸€è¡Œåœ°ä»å¼•æ“é‡Œé¢è¯»å‡ºæ¥ï¼Œç„¶åç´¯ç§¯è®¡æ•°ã€‚</li></ul><blockquote><p>ä¸ºä»€ä¹ˆ InnoDB ä¸è·Ÿ MyISAM ä¸€æ ·ï¼Œä¹Ÿç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨ï¼Ÿ</p></blockquote><p>å› ä¸ºå³ä½¿æ˜¯åœ¨åŒä¸€ä¸ªæ—¶åˆ»çš„å¤šä¸ªæŸ¥è¯¢ï¼Œç”±äºå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰çš„åŸå› ï¼ŒInnoDB è¡¨â€œåº”è¯¥è¿”å›å¤šå°‘è¡Œâ€ä¹Ÿæ˜¯ä¸ç¡®å®šçš„ã€‚</p><p>InnoDB æ˜¯ç´¢å¼•ç»„ç»‡è¡¨ï¼Œä¸»é”®ç´¢å¼•æ ‘çš„å¶å­èŠ‚ç‚¹æ˜¯æ•°æ®ï¼Œè€Œæ™®é€šç´¢å¼•æ ‘çš„å¶å­èŠ‚ç‚¹æ˜¯ä¸»é”®å€¼ã€‚æ‰€ä»¥ï¼Œæ™®é€šç´¢å¼•æ ‘æ¯”ä¸»é”®ç´¢å¼•æ ‘å°å¾ˆå¤šã€‚å¯¹äº <code>COUNT(*)</code> è¿™æ ·çš„æ“ä½œï¼Œéå†å“ªä¸ªç´¢å¼•æ ‘å¾—åˆ°çš„ç»“æœé€»è¾‘ä¸Šéƒ½æ˜¯ä¸€æ ·çš„ã€‚å› æ­¤ï¼ŒMySQL ä¼˜åŒ–å™¨ä¼šæ‰¾åˆ°æœ€å°çš„é‚£æ£µæ ‘æ¥éå†ã€‚</p><ul><li>MyISAM è¡¨è™½ç„¶ <code>COUNT(*)</code> å¾ˆå¿«ï¼Œä½†æ˜¯ä¸æ”¯æŒäº‹åŠ¡ï¼›</li><li><code>show table status</code> å‘½ä»¤è™½ç„¶è¿”å›å¾ˆå¿«ï¼Œä½†æ˜¯ä¸å‡†ç¡®ï¼›</li><li>InnoDB è¡¨ç›´æ¥ <code>COUNT(*)</code> ä¼šéå†å…¨è¡¨ï¼Œè™½ç„¶ç»“æœå‡†ç¡®ï¼Œä½†ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚</li></ul><blockquote><p>å¦‚ä½•ä¼˜åŒ–æŸ¥è¯¢è®¡æ•°ï¼Ÿ</p></blockquote><ul><li>å¯ä»¥ä½¿ç”¨ Redis ä¿å­˜è®¡æ•°ï¼Œä½†å­˜åœ¨æ•°æ®ä¸¢å¤±å’Œé€»è¾‘ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</li><li>å¯ä»¥ä½¿ç”¨æ•°æ®åº“å…¶ä»–è¡¨ä¿å­˜è®¡æ•°ï¼Œåˆ©ç”¨äº‹åŠ¡çš„åŸå­æ€§å’Œéš”ç¦»æ€§ï¼Œå¯ä»¥é¿å…æ•°æ®ä¸¢å¤±å’Œé€»è¾‘ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</li></ul><h2 id="å‚è€ƒèµ„æ–™" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒèµ„æ–™" aria-hidden="true">#</a> å‚è€ƒèµ„æ–™</h2>`,98),K={href:"https://book.douban.com/subject/23008813/",target:"_blank",rel:"noopener noreferrer"},Z={href:"https://time.geekbang.org/column/intro/139",target:"_blank",rel:"noopener noreferrer"},$={href:"https://xiaolincoding.com/mysql/",target:"_blank",rel:"noopener noreferrer"};function nn(sn,an){const e=p("ExternalLinkIcon"),i=p("Tabs");return d(),u("div",null,[k,n("blockquote",null,[h,n("ul",null,[n("li",null,[n("a",m,[s("ã€ŠSQL å¿…çŸ¥å¿…ä¼šã€‹"),a(e)]),s(" - SQL çš„åŸºæœ¬æ¦‚å¿µå’Œè¯­æ³•ã€å…¥é—¨ã€‘")]),n("li",null,[n("a",b,[s("ã€ŠMySQL å¿…çŸ¥å¿…ä¼šã€‹"),a(e)]),s(" - MySQL çš„åŸºæœ¬æ¦‚å¿µå’Œè¯­æ³•ã€å…¥é—¨ã€‘")])])]),y,a(i,{id:"247",data:[{id:"INSERT IGNORE INTO"},{id:"REPLACE INTO"},{id:"INSERT ... ON DUPLICATE KEY UPDATE"}],"tab-id":"é¿å…é‡å¤æ’å…¥æ•°æ®"},{title0:t(({value:l,isActive:r})=>[s("INSERT IGNORE INTO")]),title1:t(({value:l,isActive:r})=>[s("REPLACE INTO")]),title2:t(({value:l,isActive:r})=>[s("INSERT ... ON DUPLICATE KEY UPDATE")]),tab0:t(({value:l,isActive:r})=>[v,f,w]),tab1:t(({value:l,isActive:r})=>[L,I,S]),tab2:t(({value:l,isActive:r})=>[E,M,N]),_:1},8,["data"]),T,n("blockquote",null,[n("p",null,[s("æ‰©å±•é˜…è¯»ï¼š"),n("a",x,[s("https://www.cnblogs.com/eiffelzero/p/18608160"),a(e)])])]),n("p",null,[n("a",_,[s("ã€Šé˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œã€‹"),a(e)]),s(" ä¸­å¼ºåˆ¶è¦æ±‚è¶…è¿‡ä¸‰ä¸ªè¡¨ç¦æ­¢ joinã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ")]),q,n("blockquote",null,[A,n("ul",null,[n("li",null,[n("a",O,[s("MySQL å®˜æ–¹æ–‡æ¡£ä¹‹æ•°æ®ç±»å‹"),a(e)])]),n("li",null,[n("a",R,[s("MySQL å¦‚ä½•é€‰æ‹© float, double, decimal"),a(e)])])])]),Q,n("blockquote",null,[n("p",null,[s("æ‰©å±•é˜…è¯»ï¼š"),n("a",C,[s("MySQL å¦‚ä½•é€‰æ‹© float, double, decimal"),a(e)])])]),D,n("blockquote",null,[B,n("ul",null,[n("li",null,[n("a",U,[s("MySQL å®˜æ–¹æ–‡æ¡£ä¹‹ InnoDB å­˜å‚¨å¼•æ“"),a(e)])]),n("li",null,[n("a",P,[s("MySQL å®˜æ–¹æ–‡æ¡£ä¹‹å¯é€‰çš„å­˜å‚¨å¼•æ“"),a(e)])])])]),F,n("blockquote",null,[n("p",null,[s("åˆ†å¸ƒå¼ ID çš„è§£å†³æ–¹æ¡ˆè¯¦è§ï¼š"),n("a",J,[s("åˆ†å¸ƒå¼ ID"),a(e)])])]),H,Y,n("blockquote",null,[n("p",null,[s("åˆ†å¸ƒå¼äº‹åŠ¡çš„è§£å†³æ–¹æ¡ˆè¯¦è§ï¼š"),n("a",j,[s("åˆ†å¸ƒå¼äº‹åŠ¡"),a(e)])])]),z,n("blockquote",null,[n("p",null,[s("æ‰©å±•é˜…è¯»ï¼š"),n("a",V,[s("SQL çš„ä¹¦å†™é¡ºåºå’Œæ‰§è¡Œé¡ºåº"),a(e)])])]),X,n("blockquote",null,[n("p",null,[s("æ›´å¤šå†…å®¹è¯·å‚è€ƒï¼š"),n("a",G,[s("MySQL æ€§èƒ½ä¼˜åŒ–ç¥å™¨ Explain ä½¿ç”¨åˆ†æ"),a(e)])])]),W,n("ul",null,[n("li",null,[n("a",K,[s("ã€Šé«˜æ€§èƒ½ MySQLã€‹"),a(e)])]),n("li",null,[n("a",Z,[s("æå®¢æ—¶é—´æ•™ç¨‹ - MySQL å®æˆ˜ 45 è®²"),a(e)])]),n("li",null,[n("a",$,[s("å›¾è§£ MySQL ä»‹ç»"),a(e)])])])])}const tn=c(g,[["render",nn],["__file","index.html.vue"]]);export{tn as default};
