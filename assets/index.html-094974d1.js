import{_ as l}from"./plugin-vue_export-helper-c27b6911.js";import{r as i,o as c,c as o,a as n,b as a,d as s,e as t}from"./app-1c9286fd.js";const d={},r=t(`<h1 id="linux-典型运维应用" tabindex="-1"><a class="header-anchor" href="#linux-典型运维应用" aria-hidden="true">#</a> Linux 典型运维应用</h1><blockquote><p>💡 如果没有特殊说明，本文的案例都是针对 Centos 发行版本。</p></blockquote><h2 id="网络操作" tabindex="-1"><a class="header-anchor" href="#网络操作" aria-hidden="true">#</a> 网络操作</h2><h3 id="无法访问外网域名" tabindex="-1"><a class="header-anchor" href="#无法访问外网域名" aria-hidden="true">#</a> 无法访问外网域名</h3><p>（1）在 hosts 中添加本机实际 IP 和本机实际域名的映射</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;192.168.0.1 hostname&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/hosts
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果不知道本机域名，使用 <code>hostname</code> 命令查一下；如果不知道本机实际 IP，使用 <code>ifconfig</code> 查一下。</p><p>（2）配置信赖的 DNS 服务器</p><p>执行 <code>vi /etc/resolv.conf</code> ，添加以下内容：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>nameserver <span class="token number">114.114</span>.114.114
nameserver <span class="token number">8.8</span>.8.8
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,10),p=n("p",null,"114.114.114.114 是国内老牌 DNS",-1),u=n("p",null,"8.8.8.8 是 Google DNS",-1),v={href:"https://www.zhihu.com/question/32229915",target:"_blank",rel:"noopener noreferrer"},m={href:"http://www.baidu.com",target:"_blank",rel:"noopener noreferrer"},h=t(`<h3 id="配置网卡" tabindex="-1"><a class="header-anchor" href="#配置网卡" aria-hidden="true">#</a> 配置网卡</h3><p>使用 root 权限编辑 <code>/etc/sysconfig/network-scripts/ifcfg-eno16777736X</code> 文件</p><p>参考以下进行配置：</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">TYPE</span><span class="token punctuation">=</span><span class="token value attr-value">Ethernet                        # 网络类型：Ethernet以太网</span>
<span class="token key attr-name">BOOTPROTO</span><span class="token punctuation">=</span><span class="token value attr-value">none                       # 引导协议：自动获取、static静态、none不指定</span>
<span class="token key attr-name">DEFROUTE</span><span class="token punctuation">=</span><span class="token value attr-value">yes                         # 启动默认路由</span>
<span class="token key attr-name">IPV4_FAILURE_FATAL</span><span class="token punctuation">=</span><span class="token value attr-value">no                # 不启用IPV4错误检测功能</span>
<span class="token key attr-name">IPV6INIT</span><span class="token punctuation">=</span><span class="token value attr-value">yes                         # 启用IPV6协议</span>
<span class="token key attr-name">IPV6_AUTOCONF</span><span class="token punctuation">=</span><span class="token value attr-value">yes                    # 自动配置IPV6地址</span>
<span class="token key attr-name">IPV6_DEFROUTE</span><span class="token punctuation">=</span><span class="token value attr-value">yes                    # 启用IPV6默认路由</span>
<span class="token key attr-name">IPV6_FAILURE_FATAL</span><span class="token punctuation">=</span><span class="token value attr-value">no                # 不启用IPV6错误检测功能</span>
<span class="token key attr-name">IPV6_PEERDNS</span><span class="token punctuation">=</span><span class="token value attr-value">yes</span>
<span class="token key attr-name">IPV6_PEERROUTES</span><span class="token punctuation">=</span><span class="token value attr-value">yes</span>
<span class="token key attr-name">IPV6_PRIVACY</span><span class="token punctuation">=</span><span class="token value attr-value">&quot;no&quot;</span>

<span class="token key attr-name">NAME</span><span class="token punctuation">=</span><span class="token value attr-value">eno16777736                     # 网卡设备的别名（需要和文件名同名）</span>
<span class="token key attr-name">UUID</span><span class="token punctuation">=</span><span class="token value attr-value">90528772-9967-46da-b401-f82b64b4acbc  # 网卡设备的UUID唯一标识号</span>
<span class="token key attr-name">DEVICE</span><span class="token punctuation">=</span><span class="token value attr-value">eno16777736                   # 网卡的设备名称</span>
<span class="token key attr-name">ONBOOT</span><span class="token punctuation">=</span><span class="token value attr-value">yes                           # 开机自动激活网卡</span>
<span class="token key attr-name">IPADDR</span><span class="token punctuation">=</span><span class="token value attr-value">192.168.1.199                 # 网卡的固定IP地址</span>
<span class="token key attr-name">PREFIX</span><span class="token punctuation">=</span><span class="token value attr-value">24                            # 子网掩码</span>
<span class="token key attr-name">GATEWAY</span><span class="token punctuation">=</span><span class="token value attr-value">192.168.1.1                  # 默认网关IP地址</span>
<span class="token key attr-name">DNS1</span><span class="token punctuation">=</span><span class="token value attr-value">8.8.8.8                         # DNS域名解析服务器的IP地址</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>修改完后，执行 <code>systemctl restart network.service</code> 重启网卡服务。</p><h2 id="自动化脚本" tabindex="-1"><a class="header-anchor" href="#自动化脚本" aria-hidden="true">#</a> 自动化脚本</h2><h3 id="linux-开机自启动脚本" tabindex="-1"><a class="header-anchor" href="#linux-开机自启动脚本" aria-hidden="true">#</a> Linux 开机自启动脚本</h3><p>（1）在 <code>/etc/rc.local</code> 文件中添加命令</p><p>如果不想将脚本粘来粘去，或创建链接，可以在 <code>/etc/rc.local</code> 文件中添加启动命令</p><ol><li>先修改好脚本，使其所有模块都能在任意目录启动时正常执行;</li><li>再在 <code>/etc/rc.local</code> 的末尾添加一行以绝对路径启动脚本的行;</li></ol><p>例：</p><p>执行 <code>vim /etc/rc.local</code> 命令，输入以下内容：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/sh</span>
<span class="token comment">#</span>
<span class="token comment"># This script will be executed *after* all the other init scripts.</span>
<span class="token comment"># You can put your own initialization stuff in here if you don&#39;t</span>
<span class="token comment"># want to do the full Sys V style init stuff.</span>

<span class="token function">touch</span> /var/lock/subsys/local
/opt/pjt_test/test.pl
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（2）在 <code>/etc/rc.d/init.d</code> 目录下添加自启动脚本</p><p>Linux 在 <code>/etc/rc.d/init.d</code> 下有很多的文件，每个文件都是可以看到内容的，其实都是一些 shell 脚本或者可执行二进制文件。</p><p>Linux 开机的时候，会加载运行 <code>/etc/rc.d/init.d</code> 目录下的程序，因此我们可以把想要自动运行的脚本放到这个目录下即可。系统服务的启动就是通过这种方式实现的。</p><p>（3）运行级别设置</p><p>简单的说，运行级就是操作系统当前正在运行的功能级别。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>不同的运行级定义如下:
<span class="token comment"># 0 - 停机（千万不能把initdefault 设置为0 ）</span>
<span class="token comment"># 1 - 单用户模式       　　进入方法#init s = init 1</span>
<span class="token comment"># 2 - 多用户，没有 NFS</span>
<span class="token comment"># 3 - 完全多用户模式(标准的运行级)</span>
<span class="token comment"># 4 - 没有用到</span>
<span class="token comment"># 5 - X11 多用户图形模式（xwindow)</span>
<span class="token comment"># 6 - 重新启动 （千万不要把initdefault 设置为6 ）</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这些级别在 <code>/etc/inittab</code> 文件里指定，这个文件是 init 程序寻找的主要文件，最先运行的服务是放在/etc/rc.d 目录下的文件。</p><p>在 <code>/etc</code> 目录下面有这么几个目录值得注意：rcS.d rc0.d rc1.d ... rc6.d (0，1... 6 代表启动级别 0 代表停止，1 代表单用户模式，2-5 代表多用户模式，6 代表重启) 它们的作用就相当于 redhat 下的 rc.d ，你可以把脚本放到 rcS.d，然后修改文件名，给它一个启动序号，如: S88mysql</p><p>不过，最好的办法是放到相应的启动级别下面。具体作法:</p><p>（1）先把脚本 mysql 放到 /etc/init.d 目录下</p><p>（2）查看当前系统的启动级别</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ runlevel
N <span class="token number">3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>（3）设定启动级别</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#  98 为启动序号</span>
<span class="token comment">#  2 是系统的运行级别，可自己调整，注意不要忘了结尾的句点</span>
$ update-rc.d MySQL start <span class="token number">98</span> <span class="token number">2</span> <span class="token builtin class-name">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>现在我们到 /etc/rc2.d 下，就多了一个 S98mysql 这样的符号链接。</p><p>（4）重启系统，验证设置是否有效。</p><p>（5）移除符号链接</p><p>当你需要移除这个符号连接时，方法有三种：</p><ol><li><p>直接到 <code>/etc/rc2.d</code> 下删掉相应的链接，当然不是最好的方法；</p></li><li><p>推荐做法：<code>update-rc.d -f s10 remove</code></p></li><li><p>如果 update-rc.d 命令你不熟悉，还可以试试看 rcconf 这个命令，也很方便。</p></li></ol>`,32),k=n("p",null,"👉 参考：",-1),b={href:"https://blog.csdn.net/linuxshine/article/details/50717272",target:"_blank",rel:"noopener noreferrer"},_={href:"https://www.cnblogs.com/ssooking/p/6094740.html",target:"_blank",rel:"noopener noreferrer"},f=t(`<h3 id="定时执行脚本" tabindex="-1"><a class="header-anchor" href="#定时执行脚本" aria-hidden="true">#</a> 定时执行脚本</h3><h2 id="配置" tabindex="-1"><a class="header-anchor" href="#配置" aria-hidden="true">#</a> 配置</h2><h3 id="设置-linux-启动模式" tabindex="-1"><a class="header-anchor" href="#设置-linux-启动模式" aria-hidden="true">#</a> 设置 Linux 启动模式</h3><ol><li>停机(记得不要把 initdefault 配置为 0，因为这样会使 Linux 不能启动)</li><li>单用户模式，就像 Win9X 下的安全模式</li><li>多用户，但是没有 NFS</li><li>完全多用户模式，准则的运行级</li><li>通常不用，在一些特殊情况下可以用它来做一些事情</li><li>X11，即进到 X-Window 系统</li><li>重新启动 (记得不要把 initdefault 配置为 6，因为这样会使 Linux 不断地重新启动)</li></ol><p>设置方法：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;s/id:5:initdefault:/id:3:initdefault:/&#39;</span> /etc/inittab
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="参考资料" tabindex="-1"><a class="header-anchor" href="#参考资料" aria-hidden="true">#</a> 参考资料</h2>`,7),g={href:"https://www.cnblogs.com/moxiaoan/p/5683743.html",target:"_blank",rel:"noopener noreferrer"},x={href:"https://blog.csdn.net/z_yong_cool/article/details/79288397",target:"_blank",rel:"noopener noreferrer"};function y(I,P){const e=i("ExternalLinkIcon");return c(),o("div",null,[r,n("blockquote",null,[p,u,n("p",null,[a("👉 参考："),n("a",v,[a("公共 DNS 哪家强"),s(e)])])]),n("p",null,[a("（3）测试一下能否 ping 通 "),n("a",m,[a("www.baidu.com"),s(e)])]),h,n("blockquote",null,[k,n("ul",null,[n("li",null,[n("a",b,[a("linux 添加开机自启动脚本示例详解"),s(e)])]),n("li",null,[n("a",_,[a("linux 设置开机自启动"),s(e)])])])]),f,n("ul",null,[n("li",null,[n("a",g,[a("CentOS7 使用 firewalld 打开关闭防火墙与端口"),s(e)])]),n("li",null,[n("a",x,[a("linux 定时执行脚本"),s(e)])])])])}const V=l(d,[["render",y],["__file","index.html.vue"]]);export{V as default};
